

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Analysis of CMIP6, ERA5, and CloudSat &#8212; globalsnow</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'CMIP6_ERA5_CloudSat/plt_seasonal_mean';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Example with CMIP6 models (100 - 500 km)" href="../cmip/CMIP6_hr_1985-2014.html" />
    <link rel="prev" title="Example with ERA5 high-resolution (~0.25deg) monthly means" href="../ERA5/ERA5_1985-2014.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Global Snow project website
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../ERA5/ERA5_1985-2014.html">Example with ERA5 high-resolution (~0.25deg) monthly means</a></li>






<li class="toctree-l1 current active"><a class="current reference internal" href="#">Analysis of CMIP6, ERA5, and CloudSat</a></li>








<li class="toctree-l1"><a class="reference internal" href="../cmip/CMIP6_hr_1985-2014.html">Example with CMIP6 models (100 - 500 km)</a></li>








<li class="toctree-l1 has-children"><a class="reference internal" href="../cloudsat.html">Cloudsat</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../CloudSat/get_pressure_grid.html">Example to get CloudSat mean pressure level profile</a></li>



<li class="toctree-l2"><a class="reference internal" href="../CloudSat/read_2C_snow.html">Regrid CloudSat data to horizontal grid</a></li>



</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis/issues/new?title=Issue%20on%20page%20%2FCMIP6_ERA5_CloudSat/plt_seasonal_mean.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/CMIP6_ERA5_CloudSat/plt_seasonal_mean.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Analysis of CMIP6, ERA5, and CloudSat</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Analysis of CMIP6, ERA5, and CloudSat</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-id-introduction-a">1. Introduction <a id="introduction"></a></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">2. Data Wrangling <a id="data_wrangling"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#organize-my-data">Organize my data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">Import python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-variables">Open variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-difference-between-era5-and-cmip6-model-mean">Plot the difference between ERA5 and CMIP6 model mean</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-difference-between-era5-and-the-model-with-positive-negative-bias">Plot difference between ERA5 and the model with positive/negative bias</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max">MAX</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min">MIN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-model">Individual model</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-seasonal-mean-zonally">Plot the seasonal mean zonally</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-global-mean-of-cmip6-and-era5-literature-values">Plot global mean of CMIP6 and ERA5, literature values</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#south-of-30-deg">South of 30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#north-of-30-deg">North of 30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-30n-s">Global, 30N/S</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-iwp-vs-snowfall-for-when-snowfall-occurs-rightarrow-snowfall-0">Plot IWP vs. snowfall for when snowfall occurs <span class="math notranslate nohighlight">\(\rightarrow\)</span> snowfall&gt;0</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">South of -30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">North of 30 deg</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-linear-regression-and-create-dataset-from-latitudes">Calculate linear regression and create dataset from latitudes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-with-regression-values">Table with regression values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-iwp-snowfall-scatter-with-regression-lines">Plot IWP-snowfall scatter with regression lines</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-era5-cmip6-model-mean">Difference ERA5 - CMIP6 model mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis">Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-details">Statistical details</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="analysis-of-cmip6-era5-and-cloudsat">
<h1>Analysis of CMIP6, ERA5, and CloudSat<a class="headerlink" href="#analysis-of-cmip6-era5-and-cloudsat" title="Permalink to this heading">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this heading">#</a></h1>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#data_wrangling">2. Data Wrangling</a></li>
<li><a href="#exploratory">3. Exploratory Data Analysis</a></li>
<li><a href="#conclusion">4. Conclusion</a></li>
<li><a href="#references">5. References</a></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-a-id-introduction-a">
<h1>1. Introduction <a id='introduction'></a><a class="headerlink" href="#introduction-a-id-introduction-a" title="Permalink to this heading">#</a></h1>
<p><strong>Questions</strong></p>
<ul class="simple">
<li><p>How is the cloud phase and snowfall</p></li>
</ul>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> .</p>
</div></blockquote>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-a-id-data-wrangling-a">
<h1>2. Data Wrangling <a id='data_wrangling'></a><a class="headerlink" href="#data-wrangling-a-id-data-wrangling-a" title="Permalink to this heading">#</a></h1>
<section id="organize-my-data">
<h2>Organize my data<a class="headerlink" href="#organize-my-data" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p>Define a prefix for my project (you may need to adjust it for your own usage on your infrastructure).</p>
<ul>
<li><p>input folder where all the data used as input to my Jupyter Notebook is stored (and eventually shared)</p></li>
<li><p>output folder where all the results to keep are stored</p></li>
<li><p>tool folder where all the tools</p></li>
</ul>
</li>
</ul>
<p>The ERA5 0.25deg data is located in the folder <code class="docutils literal notranslate"><span class="pre">\scratch\franzihe\</span></code>, CloudSat at …</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>

<span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<span class="n">WORKDIR</span> <span class="o">=</span> <span class="n">abs_path</span><span class="p">[:</span><span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>


<span class="k">if</span> <span class="s2">&quot;mimi&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/scratch/franzihe/&quot;</span>
    <span class="c1"># FIG_DIR = &quot;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/ERA5/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/Figures/CS_ERA5_CMIP6/&quot;</span>
<span class="k">elif</span> <span class="s2">&quot;glefsekaldt&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span> 
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Data/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Documents/Figures/ERA5/&quot;</span>

<span class="n">INPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">OUTPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="n">UTILS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR</span><span class="p">,</span> <span class="s1">&#39;utils&#39;</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UTILS_DIR</span><span class="p">)</span>
<span class="c1"># make figure directory</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">FIG_DIR</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mimi.uio.no
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-python-packages">
<h2>Import python packages<a class="headerlink" href="#import-python-packages" title="Permalink to this heading">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Python</span></code> environment requirements: file <a class="reference download internal" download="" href="../_downloads/06f3f4f78bf14ffb9f9cfdf395203c3c/requirements_globalsnow.txt"><span class="xref download myst">requirements_globalsnow.txt</span></a></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">python</span></code> packages from <a class="reference download internal" download="" href="../_downloads/5eb7796ec8541cded4dcee2282ad687a/imports.py"><span class="xref download myst">imports.py</span></a></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">functions</span></code> from <a class="reference download internal" download="" href="../_downloads/3afa0d66b1ce4f3999c315ad3a2e691d/functions.py"><span class="xref download myst">functions.py</span></a></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># import packages</span>
<span class="kn">from</span> <span class="nn">imports</span> <span class="kn">import</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">intake</span><span class="p">,</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="n">LogNorm</span><span class="p">,</span> <span class="n">pd</span><span class="p">)</span>
<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">display_style</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.core.options.set_options at 0x7f64d1b9bca0&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-variables">
<h2>Open variables<a class="headerlink" href="#open-variables" title="Permalink to this heading">#</a></h2>
<p>Get the data requried for the analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;ERA5/daily_means/model_grid/&#39;</span><span class="p">)</span>
<span class="n">cmip_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;cmip6_hist/daily_means/single_model&#39;</span><span class="p">)</span>
<span class="n">dat_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;CS_ERA5_CMIP6/daily_means/&#39;</span><span class="p">)</span>

<span class="c1"># make output data directory</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dat_out</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">,</span> <span class="s1">&#39;prsn&#39;</span><span class="p">,</span> <span class="s1">&#39;pr&#39;</span><span class="p">,</span> <span class="s1">&#39;lwp&#39;</span><span class="p">,</span> <span class="s1">&#39;clivi&#39;</span><span class="p">,</span> <span class="s1">&#39;areacella&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>At the moment we have downloaded the end of the historical simulations for CMIP6 models. We define start and end year to ensure to only extract the 4-year period between 2007 and 2010.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define a start and end year</p>
<p>We will load all available models into one dictonary, which includes an xarray dataset with <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset(file)</span></code> and select the time range <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/indexing.html">by name</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_models</span> <span class="o">=</span> <span class="p">[</span>
               <span class="s1">&#39;ERA5&#39;</span><span class="p">,</span>
               <span class="s1">&#39;MIROC6&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;CESM2&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;CanESM5&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;AWI-ESM-1-1-LR&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;MPI-ESM1-2-LR&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;UKESM1-0-LL&#39;</span><span class="p">,</span> 
               <span class="s1">&#39;HadGEM3-GC31-LL&#39;</span><span class="p">,</span>
               <span class="s1">&#39;CNRM-CM6-1&#39;</span><span class="p">,</span>
               <span class="s1">&#39;CNRM-ESM2-1&#39;</span><span class="p">,</span>
               <span class="s1">&#39;IPSL-CM6A-LR&#39;</span><span class="p">,</span>
               <span class="s1">&#39;IPSL-CM5A2-INCA&#39;</span>
            <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">cmip_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">list_models</span><span class="p">:</span>
    <span class="c1"># print(model)</span>
    <span class="c1"># read in ERA5 files for each model grid</span>
    <span class="n">era_file_in</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/*ERA5_daily_mean_</span><span class="si">{}</span><span class="s1">*.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_in</span><span class="p">,</span> <span class="n">model</span><span class="p">))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">era_file_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="c1"># print(&quot;This is a pass in ERA&quot;, model)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">era_file_in</span><span class="p">)</span>
        <span class="c1"># remove leap day</span>
        <span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>

    
    <span class="c1"># read in cmip files</span>
    <span class="n">cmip_file_in</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/*</span><span class="si">{}</span><span class="s1">*45*&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cmip_in</span><span class="p">,</span> <span class="n">model</span><span class="p">)))</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmip_file_in</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="c1"># continue</span>
        <span class="k">pass</span>
        <span class="c1"># print(&quot;This is a pass in cmip&quot;, model)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">cmip_file_in</span><span class="p">)</span>
        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">rename_vars</span><span class="p">({</span><span class="s1">&#39;clivi&#39;</span><span class="p">:</span><span class="s1">&#39;iwp&#39;</span><span class="p">})</span>
        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;twp&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;iwp&#39;</span><span class="p">]</span>

        <span class="c1"># convert calender from dtype=object to datetime64</span>
        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">to_ERA5_date</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">],</span> <span class="n">model</span><span class="p">)</span>
        <span class="c1"># remove leap day</span>
        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=~</span><span class="p">((</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span> <span class="o">==</span> <span class="mi">29</span><span class="p">)))</span>
    
       
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MIROC6 2006-01-01T12:00:00.000000000
CESM2 2006-01-01 00:00:00
CanESM5 2006-01-01 12:00:00
AWI-ESM-1-1-LR 2006-01-01T12:00:00.000000000
MPI-ESM1-2-LR 2006-01-01T12:00:00.000000000
CNRM-CM6-1 2006-01-01T12:00:00.000000000
IPSL-CM6A-LR 2006-01-01T12:00:00.000000000
IPSL-CM5A2-INCA 2006-01-01 12:00:00
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">days_season</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                                        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                                        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],</span>
                                        <span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">))</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">],],</span> 
                                <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;season&#39;</span><span class="p">},</span> 
                                <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;season&#39;</span><span class="p">:[</span><span class="s1">&#39;DJF&#39;</span><span class="p">,</span> <span class="s1">&#39;JJA&#39;</span><span class="p">,</span> <span class="s1">&#39;MAM&#39;</span><span class="p">,</span> <span class="s1">&#39;SON&#39;</span><span class="p">]})</span>
        
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">days_season</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;Days per season&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IPSL-CM5A2-INCA [360 368 368 364] Days per season
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_days</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">month</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">):</span>
    <span class="n">_days</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="n">month</span><span class="p">,</span> <span class="n">month</span><span class="p">))</span><span class="o">.</span><span class="n">sizes</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
    <span class="c1"># print(month, )</span>
<span class="n">days_month</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">_days</span><span class="p">),</span>
                          <span class="n">dims</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;month&#39;</span><span class="p">},</span> 
                          <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;month&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)}</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">days_month</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="s2">&quot;Days per months&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>IPSL-CM5A2-INCA [124 112 124 120 124 120 124 124 120 124 120 124] Days per months
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this heading">#</a></h2>
<p>For variables:</p>
<ul class="simple">
<li><p>Snowfall [prsn]</p></li>
<li><p>Total column cloud liquid, supercooled liqid, and rain water [twp]</p></li>
<li><p>Total column cloud ice, snow water [iwp]</p></li>
<li><p>2m-Temperature [tas]</p></li>
</ul>
<ol class="arabic simple">
<li><p>Find where liquid water path is <span class="math notranslate nohighlight">\(\ge\)</span> 5 g m-2</p></li>
<li><p>Find where snowfall is <span class="math notranslate nohighlight">\(\ge\)</span> 0.01mm h-1</p></li>
<li><p>Find where 2m-temperature <span class="math notranslate nohighlight">\(\le\)</span> 0 <span class="math notranslate nohighlight">\(^o\)</span> C</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">th_lcc</span> <span class="o">=</span> <span class="mf">0.005</span>
<span class="n">th_2t</span> <span class="o">=</span> <span class="mf">273.15</span>
<span class="n">th_frac_days</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">th_tp</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">th_sf</span> <span class="o">=</span> <span class="mf">0.01</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_lcc_sf</span><span class="p">(</span><span class="n">ds</span><span class="p">):</span>
    <span class="n">ds_lcc</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="n">th_lcc</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">ds_lcc_2t</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">th_2t</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;pr&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">])</span>
    <span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;kg m-2 h-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mean freezing rain rate&#39;</span><span class="p">}</span>

    <span class="n">th_days_lcc_2t</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span><span class="o">/</span><span class="n">days_season</span>
    <span class="n">ds_lcc_2t_season</span> <span class="o">=</span> <span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds_lcc_2t_season</span> <span class="o">=</span> <span class="n">ds_lcc_2t_season</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_lcc_2t</span><span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">)</span>

    <span class="n">ds_lcc_2t_sf</span> <span class="o">=</span> <span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;pr&#39;</span><span class="p">]</span> <span class="o">&gt;=</span><span class="n">th_tp</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
    <span class="n">ds_lcc_2t_sf</span> <span class="o">=</span> <span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">th_sf</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>

    <span class="n">th_days_sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span><span class="o">/</span><span class="n">days_season</span>
    <span class="n">ds_lcc_2t_sf_season</span> <span class="o">=</span> <span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">ds_lcc_2t_sf_season</span> <span class="o">=</span> <span class="n">ds_lcc_2t_season</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_sf</span><span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">)</span>
    <span class="n">ds_lcc_2t_sf_season</span>
    

    <span class="c1"># Now create daily dataset based on seasonal supercooled liquid containing cloud days above th_sf, and th_frac_days</span>
    <span class="n">_mam</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;MAM&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_jja</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;JJA&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_son</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;SON&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_djf</span> <span class="o">=</span> <span class="p">((</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> 
                    <span class="n">ds_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_lcc_2t</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;DJF&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>

    <span class="n">ds_lcc_2t_days</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">_djf</span><span class="p">,</span> <span class="n">_jja</span><span class="p">,</span> <span class="n">_mam</span><span class="p">,</span> <span class="n">_son</span><span class="p">])</span>
    
    <span class="c1"># Now create daily dataset based on seasonal supercooled liquid containing cloud days above th_sf, and th_frac_days</span>
    <span class="n">_mam</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;MAM&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_jja</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;JJA&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_son</span> <span class="o">=</span> <span class="p">((</span><span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">)))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;SON&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
    <span class="n">_djf</span> <span class="o">=</span> <span class="p">((</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)),</span> 
                    <span class="n">ds_lcc_2t_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">fct</span><span class="o">.</span><span class="n">is_season</span><span class="p">(</span><span class="n">ds_lcc_2t_sf</span><span class="p">[</span><span class="s1">&#39;time.month&#39;</span><span class="p">],</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))],</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">th_days_sf</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="s1">&#39;DJF&#39;</span><span class="p">)</span> <span class="o">&gt;=</span><span class="n">th_frac_days</span><span class="p">))</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>

    <span class="n">ds_lcc_2t_sf_days</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">_djf</span><span class="p">,</span> <span class="n">_jja</span><span class="p">,</span> <span class="n">_mam</span><span class="p">,</span> <span class="n">_son</span><span class="p">])</span>

    <span class="k">return</span><span class="p">(</span><span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span> <span class="n">ds_lcc_2t_sf_days</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_cumm_days</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">days_season</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">days_season</span>
    <span class="n">cumm_days</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">n</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">cumm_days</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="p">,</span> <span class="n">var2</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">out_var</span><span class="p">):</span>
    <span class="n">ratios</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
    
    <span class="n">fseason</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span>
    <span class="n">nseason</span> <span class="o">=</span> <span class="n">var2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span>
    
    <span class="n">fmonth</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span>
    <span class="n">nmonth</span> <span class="o">=</span> <span class="n">var2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">stats</span> <span class="o">==</span> <span class="s1">&#39;count&#39;</span><span class="p">:</span>
        <span class="c1"># per season</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">fseason</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># number of times a super cooled liquid water cloud occured when the liquid water path is larger than 5gm-2, and temperature below 0degC</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">nseason</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># number of times a super cooled liquid water cloud occured when the liquid water path is larger than 5gm-2, and temperature below 0degC</span>
        <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">n</span>
    
        <span class="c1"># per month</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">fmonth</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
        <span class="n">n</span> <span class="o">=</span> <span class="n">nmonth</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> 
        <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">n</span>
    
    
    <span class="k">elif</span> <span class="n">stats</span> <span class="o">==</span> <span class="s1">&#39;mean&#39;</span><span class="p">:</span>
        <span class="c1"># per season</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">fseason</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">nseason</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">n</span>
        
        <span class="c1"># per month</span>
        <span class="n">f</span> <span class="o">=</span> <span class="n">fmonth</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">nmonth</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span><span class="o">/</span><span class="n">n</span>
        
        
    <span class="c1"># weighted average </span>
    <span class="c1"># Grid cells have different area, so when we do the global average, they have to be weigted by the area of each grid cell.</span>
    <span class="n">weights</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">area_grid</span><span class="p">(</span><span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ratios</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season_NH_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season_SH_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season_NH_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season_SH_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month_NH_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month_SH_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month_NH_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month_SH_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratios</span><span class="p">[</span><span class="n">out_var</span><span class="o">+</span><span class="s1">&#39;_month&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">45</span><span class="p">))</span><span class="o">.</span><span class="n">weighted</span><span class="p">(</span><span class="n">weights</span><span class="p">)</span><span class="o">.</span><span class="n">std</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>


    <span class="c1"># ratios[out_var+&#39;mean&#39;] = xr.merge(objects=[NH_mean, SH_mean])</span>
    <span class="c1"># ratios[out_var+&#39;std&#39;] = xr.merge(objects=[NH_std, SH_std])</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_combined_ratios</span><span class="p">(</span><span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span> <span class="n">ds_lcc_2t_sf_days</span><span class="p">):</span>

    <span class="c1">#### relative frequency of liquid containing clouds</span>
    <span class="n">lcc_wo_snow</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">],</span> 
                         <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">],</span> 
                         <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> 
                         <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;lcc_wo_snow&#39;</span><span class="p">)</span>

    <span class="c1">#### relative frequency of snowfall from liquid containing clouds</span>
    <span class="n">lcc_w_snow</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_sf_days</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">],</span> 
                            <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">],</span> 
                            <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> 
                            <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;lcc_w_snow&#39;</span><span class="p">)</span>

    

    <span class="c1">#### relative snowfall (precipitation) efficency</span>
    <span class="n">sf_eff</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">],</span> 
                        <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span> 
                        <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> 
                        <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;sf_eff&#39;</span><span class="p">)</span>
    
    <span class="n">tp_eff</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;pr&#39;</span><span class="p">],</span>
                        <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span>
                        <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
                        <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;tp_eff&#39;</span><span class="p">)</span>
    
    <span class="c1">#### relative frequency of freezing rain</span>
    <span class="n">prfr_pr</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span>
                         <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;pr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span>
                         <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span>
                         <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;prfr_pr&#39;</span><span class="p">)</span>
    
    <span class="c1">#### relative amount of freezing rain in comparison to total precipitation</span>
    <span class="n">prfr_pr_frac</span> <span class="o">=</span> <span class="n">get_ratios_season_month</span><span class="p">(</span><span class="n">var1</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span>
                              <span class="n">var2</span><span class="o">=</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;pr&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;prfr&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span>
                              <span class="n">stats</span><span class="o">=</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span>
                              <span class="n">out_var</span><span class="o">=</span><span class="s1">&#39;prfr_pr_frac&#39;</span><span class="p">)</span>


    <span class="n">ratios</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">objects</span><span class="o">=</span><span class="p">[</span><span class="n">lcc_wo_snow</span><span class="p">,</span> <span class="n">lcc_w_snow</span><span class="p">,</span> 
                                      <span class="n">sf_eff</span><span class="p">,</span> <span class="n">tp_eff</span><span class="p">,</span> 
                                      <span class="n">prfr_pr</span><span class="p">,</span> <span class="n">prfr_pr_frac</span><span class="p">])</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">ratios</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumm_era</span>   <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">ratios_era</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">era_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    
    <span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span><span class="n">ds_lcc_2t_sf_days</span> <span class="o">=</span> <span class="n">find_lcc_sf</span><span class="p">(</span><span class="n">era_dict</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>
    
    <span class="c1"># # create dataset with all acummulations</span>
    <span class="n">cumm_era</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>  
    <span class="c1">#### cummulative days of liquid containing clouds and precipitating liquid containing clouds</span>
    <span class="n">cumm_era</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;lcc_days&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">get_cumm_days</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span> <span class="n">days_season</span><span class="p">)</span>
    <span class="n">cumm_era</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;sf_days&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">get_cumm_days</span><span class="p">(</span><span class="n">ds_lcc_2t_sf_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span> <span class="n">days_season</span><span class="p">)</span>
    
    <span class="n">ratios_era</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_combined_ratios</span><span class="p">(</span><span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span> <span class="n">ds_lcc_2t_sf_days</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cumm_cmip</span>   <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">ratios_cmip</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    
    <span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span><span class="n">ds_lcc_2t_sf_days</span> <span class="o">=</span> <span class="n">find_lcc_sf</span><span class="p">(</span><span class="n">cmip_dict</span><span class="p">[</span><span class="n">model</span><span class="p">])</span>
    
    <span class="c1"># # create dataset with all acummulations</span>
    <span class="n">cumm_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>  
    <span class="c1">#### cummulative days of liquid containing clouds and precipitating liquid containing clouds</span>
    <span class="n">cumm_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;lcc_days&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">get_cumm_days</span><span class="p">(</span><span class="n">ds_lcc_2t_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span> <span class="n">days_season</span><span class="p">)</span>
    <span class="n">cumm_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">][</span><span class="s1">&#39;sf_days&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">get_cumm_days</span><span class="p">(</span><span class="n">ds_lcc_2t_sf_days</span><span class="p">[</span><span class="s1">&#39;twp&#39;</span><span class="p">],</span> <span class="n">days_season</span><span class="p">)</span>
    
    <span class="n">ratios_cmip</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">get_combined_ratios</span><span class="p">(</span><span class="n">ds_lcc</span><span class="p">,</span> <span class="n">ds_lcc_2t_days</span><span class="p">,</span> <span class="n">ds_lcc_2t_sf_days</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_da</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cumm_era</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">cumm_era</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="n">_da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">_coord</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;model&#39;</span><span class="p">})</span>
<span class="n">era_cumm</span> <span class="o">=</span> <span class="n">_ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_da</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ratios_era</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">ratios_era</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">_ds</span> <span class="o">=</span> <span class="p">(</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="n">_da</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">_coord</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;model&#39;</span><span class="p">})</span>
<span class="n">era_ratios</span> <span class="o">=</span> <span class="n">_ds</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span> <span class="o">=</span> <span class="n">era_cumm</span><span class="p">[</span><span class="s1">&#39;lcc_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lcc_days&#x27; (model: 10, season: 4, lat: 389, lon: 1728)&gt;
dask.array&lt;getitem, shape=(10, 4, 389, 1728), dtype=float64, chunksize=(1, 1, 389, 1728), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float64 45.0 45.25 45.5 45.52 45.52 ... 89.25 89.5 89.75 90.0
  * lon      (lon) float64 -180.0 -179.8 -179.5 -179.2 ... 179.2 179.5 179.8
  * season   (season) object &#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;
  * model    (model) object &#x27;ERA5&#x27; &#x27;MIROC6&#x27; ... &#x27;IPSL-CM6A-LR&#x27; &#x27;IPSL-CM5A2-INCA&#x27;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lcc_days'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>model</span>: 10</li><li><span class='xr-has-index'>season</span>: 4</li><li><span class='xr-has-index'>lat</span>: 389</li><li><span class='xr-has-index'>lon</span>: 1728</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a451308f-0c57-45fe-a739-c7ae118ce555' class='xr-array-in' type='checkbox' checked><label for='section-a451308f-0c57-45fe-a739-c7ae118ce555' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 1, 389, 1728), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 205.14 MiB </td>
                        <td> 5.13 MiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (10, 4, 389, 1728) </td>
                        <td> (1, 1, 389, 1728) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 928 Graph Layers </td>
                        <td> 40 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="374" height="107" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="25" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="25" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="2" y1="0" x2="2" y2="25" />
  <line x1="5" y1="0" x2="5" y2="25" />
  <line x1="7" y1="0" x2="7" y2="25" />
  <line x1="10" y1="0" x2="10" y2="25" />
  <line x1="12" y1="0" x2="12" y2="25" />
  <line x1="15" y1="0" x2="15" y2="25" />
  <line x1="17" y1="0" x2="17" y2="25" />
  <line x1="20" y1="0" x2="20" y2="25" />
  <line x1="22" y1="0" x2="22" y2="25" />
  <line x1="25" y1="0" x2="25" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 25.412616514582485,0.0 25.412616514582485,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="12.706308" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >10</text>
  <text x="45.412617" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,45.412617,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="109" y2="14" style="stroke-width:2" />
  <line x1="95" y1="42" x2="109" y2="57" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="95" y2="42" style="stroke-width:2" />
  <line x1="98" y1="3" x2="98" y2="46" />
  <line x1="102" y1="7" x2="102" y2="49" />
  <line x1="106" y1="11" x2="106" y2="53" />
  <line x1="109" y1="14" x2="109" y2="57" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 109.9485979497544,14.948597949754403 109.9485979497544,57.44324281902707 95.0,42.49464486927267" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="95" y1="0" x2="215" y2="0" style="stroke-width:2" />
  <line x1="98" y1="3" x2="218" y2="3" />
  <line x1="102" y1="7" x2="222" y2="7" />
  <line x1="106" y1="11" x2="226" y2="11" />
  <line x1="109" y1="14" x2="229" y2="14" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="95" y1="0" x2="109" y2="14" style="stroke-width:2" />
  <line x1="215" y1="0" x2="229" y2="14" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="95.0,0.0 215.0,0.0 229.9485979497544,14.948597949754403 109.9485979497544,14.948597949754403" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="109" y1="14" x2="229" y2="14" style="stroke-width:2" />
  <line x1="109" y1="57" x2="229" y2="57" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="109" y1="14" x2="109" y2="57" style="stroke-width:2" />
  <line x1="229" y1="14" x2="229" y2="57" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="109.9485979497544,14.948597949754403 229.9485979497544,14.948597949754403 229.9485979497544,57.44324281902707 109.9485979497544,57.44324281902707" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="169.948598" y="77.443243" font-size="1.0rem" font-weight="100" text-anchor="middle" >1728</text>
  <text x="249.948598" y="36.195920" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,249.948598,36.195920)">389</text>
  <text x="92.474299" y="69.968944" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,92.474299,69.968944)">4</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-6aa87526-0026-41e5-aed5-6c9b2d44ed90' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6aa87526-0026-41e5-aed5-6c9b2d44ed90' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.0 45.25 45.5 ... 89.5 89.75 90.0</div><input id='attrs-5d4bc205-a207-4232-9451-4c98adce40cc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5d4bc205-a207-4232-9451-4c98adce40cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb5489af-51f6-420d-a0ca-00243f3e9b88' class='xr-var-data-in' type='checkbox'><label for='data-eb5489af-51f6-420d-a0ca-00243f3e9b88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>stored_direction :</span></dt><dd>decreasing</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>90.0</dd><dt><span>valid_min :</span></dt><dd>-90.0</dd></dl></div><div class='xr-var-data'><pre>array([45.  , 45.25, 45.5 , ..., 89.5 , 89.75, 90.  ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -179.8 ... 179.5 179.8</div><input id='attrs-c2f1750e-d82e-4e8a-b4f3-eaebdc57862f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c2f1750e-d82e-4e8a-b4f3-eaebdc57862f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fecf0f11-13a3-4aaf-885f-128cbbc5597e' class='xr-var-data-in' type='checkbox'><label for='data-fecf0f11-13a3-4aaf-885f-128cbbc5597e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>type :</span></dt><dd>double</dd><dt><span>valid_max :</span></dt><dd>360.0</dd><dt><span>valid_min :</span></dt><dd>-180.0</dd></dl></div><div class='xr-var-data'><pre>array([-180.  , -179.75, -179.5 , ...,  179.25,  179.5 ,  179.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>season</span></div><div class='xr-var-dims'>(season)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;</div><input id='attrs-259db639-4389-4b17-835e-888010eab32e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-259db639-4389-4b17-835e-888010eab32e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ec067392-46ac-49ea-a3f1-082fb3024407' class='xr-var-data-in' type='checkbox'><label for='data-ec067392-46ac-49ea-a3f1-082fb3024407' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>model</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;ERA5&#x27; ... &#x27;IPSL-CM5A2-INCA&#x27;</div><input id='attrs-efe0510f-9ee5-4732-a4b4-f4a4fb65d52e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-efe0510f-9ee5-4732-a4b4-f4a4fb65d52e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b54ccb1-7c6a-41f7-a291-1de72301d35e' class='xr-var-data-in' type='checkbox'><label for='data-9b54ccb1-7c6a-41f7-a291-1de72301d35e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;ERA5&#x27;, &#x27;MIROC6&#x27;, &#x27;CESM2&#x27;, &#x27;CanESM5&#x27;, &#x27;AWI-ESM-1-1-LR&#x27;, &#x27;MPI-ESM1-2-LR&#x27;,
       &#x27;CNRM-CM6-1&#x27;, &#x27;CNRM-ESM2-1&#x27;, &#x27;IPSL-CM6A-LR&#x27;, &#x27;IPSL-CM5A2-INCA&#x27;],
      dtype=object)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8683164d-4f32-48b2-9c10-5eeea8cef6f4' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8683164d-4f32-48b2-9c10-5eeea8cef6f4' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extend</span><span class="o">=</span><span class="kc">None</span>
<span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">.1</span><span class="p">)</span>
<span class="n">plt_title</span> <span class="o">=</span> <span class="s1">&#39;Test&#39;</span>
<span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;bar label&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var1</span> <span class="o">=</span> <span class="n">cumm_era</span><span class="p">[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">][</span><span class="s1">&#39;lcc_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="n">var2</span> <span class="o">=</span> <span class="p">(</span><span class="n">cumm_era</span><span class="p">[</span><span class="s1">&#39;MIROC6&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cumm_cmip</span><span class="p">[</span><span class="s1">&#39;MIROC6&#39;</span><span class="p">])[</span><span class="s1">&#39;lcc_days&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">45</span><span class="p">,</span><span class="mi">90</span><span class="p">))</span>
<span class="n">var2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;lcc_days&#x27; (season: 4, lat: 32, lon: 256)&gt;
dask.array&lt;getitem, shape=(4, 32, 256), dtype=float64, chunksize=(1, 32, 256), chunktype=numpy.ndarray&gt;
Coordinates:
  * lat      (lat) float64 45.52 46.93 48.33 49.73 ... 84.74 86.14 87.54 88.93
  * lon      (lon) float64 -180.0 -178.6 -177.2 -175.8 ... 175.8 177.2 178.6
  * season   (season) object &#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;
    height   float64 2.0</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'lcc_days'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>season</span>: 4</li><li><span class='xr-has-index'>lat</span>: 32</li><li><span class='xr-has-index'>lon</span>: 256</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-46e41ac4-c866-4b1c-bd7c-d571f0f55e97' class='xr-array-in' type='checkbox' checked><label for='section-46e41ac4-c866-4b1c-bd7c-d571f0f55e97' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>dask.array&lt;chunksize=(1, 32, 256), meta=np.ndarray&gt;</span></div><div class='xr-array-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 256.00 kiB </td>
                        <td> 64.00 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (4, 32, 256) </td>
                        <td> (1, 32, 256) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 199 Graph Layers </td>
                        <td> 4 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="196" height="106" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="26" y2="16" style="stroke-width:2" />
  <line x1="10" y1="39" x2="26" y2="56" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="39" style="stroke-width:2" />
  <line x1="14" y1="4" x2="14" y2="43" />
  <line x1="18" y1="8" x2="18" y2="47" />
  <line x1="22" y1="12" x2="22" y2="52" />
  <line x1="26" y1="16" x2="26" y2="56" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 26.279639528180862,16.279639528180862 26.279639528180862,56.07357458300923 10.0,39.793935054828374" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="14" y1="4" x2="134" y2="4" />
  <line x1="18" y1="8" x2="138" y2="8" />
  <line x1="22" y1="12" x2="142" y2="12" />
  <line x1="26" y1="16" x2="146" y2="16" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="26" y2="16" style="stroke-width:2" />
  <line x1="130" y1="0" x2="146" y2="16" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 146.27963952818087,16.279639528180862 26.279639528180862,16.279639528180862" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="26" y1="16" x2="146" y2="16" style="stroke-width:2" />
  <line x1="26" y1="56" x2="146" y2="56" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="26" y1="16" x2="26" y2="56" style="stroke-width:2" />
  <line x1="146" y1="16" x2="146" y2="56" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="26.279639528180862,16.279639528180862 146.27963952818087,16.279639528180862 146.27963952818087,56.07357458300923 26.279639528180862,56.07357458300923" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="86.279640" y="76.073575" font-size="1.0rem" font-weight="100" text-anchor="middle" >256</text>
  <text x="166.279640" y="36.176607" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,166.279640,36.176607)">32</text>
  <text x="8.139820" y="67.933755" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,8.139820,67.933755)">4</text>
</svg>
        </td>
    </tr>
</table></div></div></li><li class='xr-section-item'><input id='section-ce60db96-3edb-4bc6-a1b5-0cfbfb4a4261' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ce60db96-3edb-4bc6-a1b5-0cfbfb4a4261' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>45.52 46.93 48.33 ... 87.54 88.93</div><input id='attrs-58cadd9c-a6ba-4307-aa98-c051bacd5f69' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-58cadd9c-a6ba-4307-aa98-c051bacd5f69' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85a68bd8-7cad-4452-9064-f8e30b3dac60' class='xr-var-data-in' type='checkbox'><label for='data-85a68bd8-7cad-4452-9064-f8e30b3dac60' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lat_bnds</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd></dl></div><div class='xr-var-data'><pre>array([45.52485 , 46.925606, 48.326361, 49.727115, 51.127867, 52.528617,
       53.929366, 55.330112, 56.730857, 58.131598, 59.532337, 60.933072,
       62.333803, 63.73453 , 65.135251, 66.535966, 67.936673, 69.337372,
       70.738059, 72.138732, 73.539389, 74.940023, 76.340629, 77.741196,
       79.14171 , 80.542146, 81.942466, 83.342596, 84.742386, 86.141472,
       87.538705, 88.927735])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -178.6 ... 177.2 178.6</div><input id='attrs-d071afc4-4a7a-416c-a410-436a2542d642' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d071afc4-4a7a-416c-a410-436a2542d642' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7f886f5e-b2dc-4777-a847-fd8ed8f5c982' class='xr-var-data-in' type='checkbox'><label for='data-7f886f5e-b2dc-4777-a847-fd8ed8f5c982' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>bounds :</span></dt><dd>lon_bnds</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd></dl></div><div class='xr-var-data'><pre>array([-180.     , -178.59375, -177.1875 , ...,  175.78125,  177.1875 ,
        178.59375])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>season</span></div><div class='xr-var-dims'>(season)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;</div><input id='attrs-de020604-3394-4c11-8ee5-095fad3b16fc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-de020604-3394-4c11-8ee5-095fad3b16fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e19feac4-7ac6-40b7-9cfa-dcd7272c23d4' class='xr-var-data-in' type='checkbox'><label for='data-e19feac4-7ac6-40b7-9cfa-dcd7272c23d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.0</div><input id='attrs-b93d3d46-3f7e-417d-98f5-21e0d3fa375b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b93d3d46-3f7e-417d-98f5-21e0d3fa375b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d543a038-721d-4410-ad94-b4e01473b9c4' class='xr-var-data-in' type='checkbox'><label for='data-d543a038-721d-4410-ad94-b4e01473b9c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>m</dd><dt><span>axis :</span></dt><dd>Z</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>standard_name :</span></dt><dd>height</dd></dl></div><div class='xr-var-data'><pre>array(2.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-128a7098-2c10-4230-9d78-f4119356b6ba' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-128a7098-2c10-4230-9d78-f4119356b6ba' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">)})</span>

<span class="n">coast</span> <span class="o">=</span> <span class="n">cy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">NaturalEarthFeature</span><span class="p">(</span><span class="n">category</span><span class="o">=</span><span class="s1">&#39;physical&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;110m&#39;</span><span class="p">,</span>
                            <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;coastline&#39;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">var1</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>

    <span class="n">cf1</span> <span class="o">=</span> <span class="n">var1</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">var1</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hawaii_r</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coast</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>   <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s1">&#39;season = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">cbaxes1</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.0125</span><span class="p">,</span> <span class="mf">0.525</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf1</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbaxes1</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>
    
    
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">var1</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    
    <span class="n">cf2</span> <span class="o">=</span> <span class="n">var2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">var2</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">vikO</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">.1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">coast</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
    <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>   <span class="o">=</span> <span class="kc">False</span>
    <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s1">&#39;season = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">cbaxes2</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.0125</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.45</span><span class="p">])</span>
<span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf2</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbaxes2</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>
    
    
<span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">plt_title</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/cf7799d08dab5e857b20ca6d259f41c0d3b6d5bb2c028cdd0991cb829394d6f5.png" src="../_images/cf7799d08dab5e857b20ca6d259f41c0d3b6d5bb2c028cdd0991cb829394d6f5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># import packages</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/eosc-nordic-climate-demonstrator/work/utils&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">imports</span> <span class="kn">import</span> <span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span>  <span class="c1">#stats, </span>
<span class="n">plt</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">fct</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_id</span> <span class="o">=</span> <span class="p">[</span>
               <span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">,</span> <span class="s1">&#39;sf&#39;</span><span class="p">],</span>
               <span class="c1"># [&#39;clivi&#39;, &#39;tciw&#39;]</span>
            <span class="c1">#    [&#39;lwp&#39;, &#39;tclw&#39;],</span>
               <span class="c1"># [&#39;tas&#39;, &#39;2t&#39;]</span>
               <span class="c1"># [&#39;pr&#39;, &#39;tp&#39;]</span>
               <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starty</span> <span class="o">=</span> <span class="mi">1985</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="mi">2014</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_file</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/CMIP6_hist/1deg/*_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">cfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">cmip_file</span><span class="p">)</span>

<span class="n">era_file</span>  <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/ERA5/monthly_means/1deg/*_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">efiles</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">era_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in datasets </span>
<span class="n">cmip</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">cfiles</span><span class="p">)</span>
<span class="n">era</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">efiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_seasonal_mean</span> <span class="o">=</span> <span class="n">cmip</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">era_seasonal_mean</span>  <span class="o">=</span> <span class="n">era</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;prsn&#39;</span><span class="p">:</span>
    <span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;Snowfall (mm$\,$day$^{-1}$)&#39;</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.6</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">.6</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">if</span> <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pr&#39;</span><span class="p">:</span>
    <span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;Total Precipitation (mm$\,$day$^{-1}$)&#39;</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mf">.6</span>
    <span class="n">vmax</span><span class="o">=</span><span class="mf">.6</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span>
<span class="k">if</span>  <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;clivi&#39;</span><span class="p">:</span>
    <span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;Ice Water Path (g$\,$m$^{-2}$)&#39;</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
    <span class="n">vmax</span><span class="o">=</span> <span class="mi">30</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="mi">60</span>
<span class="k">if</span>  <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lwp&#39;</span><span class="p">:</span>
    <span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;Liquid Water Path (g$\,$m$^{-2}$)&#39;</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
    <span class="n">vmax</span><span class="o">=</span> <span class="mi">30</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="mi">60</span>
<span class="k">if</span> <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;tas&#39;</span><span class="p">:</span>
    <span class="n">cbar_label</span> <span class="o">=</span> <span class="s1">&#39;2-m temperature (K)&#39;</span>
    <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="mi">30</span>
    <span class="n">vmax</span><span class="o">=</span> <span class="mi">30</span>
    <span class="n">levels</span> <span class="o">=</span> <span class="mi">60</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-the-difference-between-era5-and-cmip6-model-mean">
<h1>Plot the difference between ERA5 and CMIP6 model mean<a class="headerlink" href="#plot-the-difference-between-era5-and-cmip6-model-mean" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_diff_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">],</span> 
                            <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_model_mean&#39;</span><span class="p">],</span> 
                        <span class="n">cbar_label</span><span class="p">,</span> 
                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ERA5 - CMIP6 model mean (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">))</span>
<span class="c1"># add model names</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
            <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">});</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
                <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">});</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.38</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">)[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
                <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                        <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">});</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3159bdbb8810ca623133a2fc1b69e09c6d0f7f94e7ca4bf8257f34d7376852f4.png" src="../_images/3159bdbb8810ca623133a2fc1b69e09c6d0f7f94e7ca4bf8257f34d7376852f4.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-difference-between-era5-and-the-model-with-positive-negative-bias">
<h1>Plot difference between ERA5 and the model with positive/negative bias<a class="headerlink" href="#plot-difference-between-era5-and-the-model-with-positive-negative-bias" title="Permalink to this heading">#</a></h1>
<p>calculate global mean to find the MAX and MIN</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="max">
<h2>MAX<a class="headerlink" href="#max" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot max</span>
<span class="n">idx_max</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="n">fct</span><span class="o">.</span><span class="n">plt_diff_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">],</span>
                      <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">idx_max</span><span class="p">),</span> 
                        <span class="n">cbar_label</span><span class="p">,</span> 
                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ERA5 - </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_max</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">));</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_max_</span><span class="si">{}</span><span class="s1">_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_max</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/8c658828c7842c7fc63e0ce655e77e31ca7539a2fb6b1f8934e50237abbe9826.png" src="../_images/8c658828c7842c7fc63e0ce655e77e31ca7539a2fb6b1f8934e50237abbe9826.png" />
</div>
</div>
</section>
<section id="min">
<h2>MIN<a class="headerlink" href="#min" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot min</span>
<span class="n">idx_min</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>

<span class="n">fct</span><span class="o">.</span><span class="n">plt_diff_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">],</span> 
                      <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">idx_min</span><span class="p">),</span> 
                        <span class="n">cbar_label</span><span class="p">,</span> 
                        <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ERA5 - </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_min</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">));</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_min_</span><span class="si">{}</span><span class="s1">_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">idx_min</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/52170de7c05fe854ee79a652e607c1d81fd2927430403395c4d509f85aac30ed.png" src="../_images/52170de7c05fe854ee79a652e607c1d81fd2927430403395c4d509f85aac30ed.png" />
</div>
</div>
</section>
<section id="individual-model">
<h2>Individual model<a class="headerlink" href="#individual-model" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot individual model difference</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>

    <span class="n">fct</span><span class="o">.</span><span class="n">plt_diff_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">],</span> 
                        <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> 
                            <span class="n">cbar_label</span><span class="p">,</span> 
                            <span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">levels</span> <span class="o">=</span> <span class="mi">30</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;ERA5 - </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">));</span>

    <span class="c1"># save figure to png</span>
    <span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
    <span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_</span><span class="si">{}</span><span class="s1">_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1c89e6bfe79e5a66accfa61f8388a1764e7297deeda6e58d9bf6b88460c51eec.png" src="../_images/1c89e6bfe79e5a66accfa61f8388a1764e7297deeda6e58d9bf6b88460c51eec.png" />
<img alt="../_images/4a874d80ebb359e246884c1449c448f0dc8dae6438bb284a6689784574de13c6.png" src="../_images/4a874d80ebb359e246884c1449c448f0dc8dae6438bb284a6689784574de13c6.png" />
<img alt="../_images/60cbbfae891bc961061d15843ecf15563e0bf6a4375bcf263e92cc61fed8e5cf.png" src="../_images/60cbbfae891bc961061d15843ecf15563e0bf6a4375bcf263e92cc61fed8e5cf.png" />
<img alt="../_images/2f0b28d5c3d18307ce82177b75832dc8d6b8cd3dbc433db742c6f9c87dc37966.png" src="../_images/2f0b28d5c3d18307ce82177b75832dc8d6b8cd3dbc433db742c6f9c87dc37966.png" />
<img alt="../_images/82dc34c6b6d47a167c536247ecbc43e9896eb5337574124b353bdbe83cbdba14.png" src="../_images/82dc34c6b6d47a167c536247ecbc43e9896eb5337574124b353bdbe83cbdba14.png" />
<img alt="../_images/571b0a3193e6f73d687b854b0bafd605e6f6499410f1931efaa4b465e390d411.png" src="../_images/571b0a3193e6f73d687b854b0bafd605e6f6499410f1931efaa4b465e390d411.png" />
<img alt="../_images/ed63d79c343c901606fcdca909997e224eca549dc10f09bf13a5b3b14def2884.png" src="../_images/ed63d79c343c901606fcdca909997e224eca549dc10f09bf13a5b3b14def2884.png" />
<img alt="../_images/9e08e6256a4851637f8234a45b86c6fdc6de1c99d894ee6ef025a834493b7407.png" src="../_images/9e08e6256a4851637f8234a45b86c6fdc6de1c99d894ee6ef025a834493b7407.png" />
<img alt="../_images/a32d0aa6607e6115d4d0a0529d83c88d937733d68335d2d26b11dee775c06b82.png" src="../_images/a32d0aa6607e6115d4d0a0529d83c88d937733d68335d2d26b11dee775c06b82.png" />
<img alt="../_images/52170de7c05fe854ee79a652e607c1d81fd2927430403395c4d509f85aac30ed.png" src="../_images/52170de7c05fe854ee79a652e607c1d81fd2927430403395c4d509f85aac30ed.png" />
<img alt="../_images/ad9e22930c07fa4301b6f4e5b18c1248347e75d0e073b346781ce6e06804769b.png" src="../_images/ad9e22930c07fa4301b6f4e5b18c1248347e75d0e073b346781ce6e06804769b.png" />
<img alt="../_images/c6d77ee9e3e913c67f875f06c6e274cc3b61dcdab732b440d79eee3be0d5a0ff.png" src="../_images/c6d77ee9e3e913c67f875f06c6e274cc3b61dcdab732b440d79eee3be0d5a0ff.png" />
<img alt="../_images/a74a57636fc087934dc57cab0b03e4562198a96972d8556baa7f330830d11d99.png" src="../_images/a74a57636fc087934dc57cab0b03e4562198a96972d8556baa7f330830d11d99.png" />
<img alt="../_images/2e972959779523402733723480e7409669d5c8accc7424bdc6c8e77daad68a02.png" src="../_images/2e972959779523402733723480e7409669d5c8accc7424bdc6c8e77daad68a02.png" />
<img alt="../_images/0409c1a2abd83ba15fbf25f8b0db0b7152952eaa6227353da99fa6ba1ecb6553.png" src="../_images/0409c1a2abd83ba15fbf25f8b0db0b7152952eaa6227353da99fa6ba1ecb6553.png" />
<img alt="../_images/8c658828c7842c7fc63e0ce655e77e31ca7539a2fb6b1f8934e50237abbe9826.png" src="../_images/8c658828c7842c7fc63e0ce655e77e31ca7539a2fb6b1f8934e50237abbe9826.png" />
<img alt="../_images/6129cf8d9ec44f42982cd476a2a862da2e06f60e5d3b3ccf7c37ff777d9bdbd7.png" src="../_images/6129cf8d9ec44f42982cd476a2a862da2e06f60e5d3b3ccf7c37ff777d9bdbd7.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-the-seasonal-mean-zonally">
<h1>Plot the seasonal mean zonally<a class="headerlink" href="#plot-the-seasonal-mean-zonally" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_std&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fct</span><span class="o">.</span><span class="n">plt_zonal_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;High resolution (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_zonal_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/e0f2c518970129d32e466cddab82cdf70be6dcf6fa90e00a19b993f519fe3005.png" src="../_images/e0f2c518970129d32e466cddab82cdf70be6dcf6fa90e00a19b993f519fe3005.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">axs</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_zonal_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;High resolution (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">era</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ERA5&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span> 
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">era</span><span class="o">.</span><span class="n">lat</span><span class="p">,</span> 
                    <span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_std&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                    <span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_std&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="p">)</span>
    <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_season_zonal_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;CMIP6 mean&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
        <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
        <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
        <span class="n">title</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">,</span>
        <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
        <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_zonal_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/78d96c1b5353dabee53e332eff27439b963fe979b450291723d5ec8341fc6571.png" src="../_images/78d96c1b5353dabee53e332eff27439b963fe979b450291723d5ec8341fc6571.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-global-mean-of-cmip6-and-era5-literature-values">
<h1>Plot global mean of CMIP6 and ERA5, literature values<a class="headerlink" href="#plot-global-mean-of-cmip6-and-era5-literature-values" title="Permalink to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>    
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Global mean (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">],</span> 
                               <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_global_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No handles with labels found to put in legend.
</pre></div>
</div>
<img alt="../_images/c5fa692b58a1d04fbdfd83f79b23b44df3f83ccd0ae6c45ef587422c60043059.png" src="../_images/c5fa692b58a1d04fbdfd83f79b23b44df3f83ccd0ae6c45ef587422c60043059.png" />
</div>
</div>
<section id="south-of-30-deg">
<h2>South of 30 deg<a class="headerlink" href="#south-of-30-deg" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_SH</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span><span class="o">-</span><span class="mi">30</span><span class="p">)</span>

<span class="c1"># lat: -90, -30</span>
<span class="n">_var_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
<span class="n">cmip</span><span class="p">[</span><span class="n">_var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">_var_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="n">_var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#####################################</span>
<span class="c1"># bar plot only south</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>    
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;SH mean: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> 
                               <span class="n">era</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bar_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;//&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>


<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No handles with labels found to put in legend.
</pre></div>
</div>
<img alt="../_images/eeb5847ceaac92181537d85246ae78460a6ddedd74794e43dd516c0871607873.png" src="../_images/eeb5847ceaac92181537d85246ae78460a6ddedd74794e43dd516c0871607873.png" />
</div>
</div>
</section>
<section id="north-of-30-deg">
<h2>North of 30 deg<a class="headerlink" href="#north-of-30-deg" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_NH</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">)</span>

<span class="c1"># lat: 30, 90</span>
<span class="n">_var_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
<span class="n">cmip</span><span class="p">[</span><span class="n">_var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="n">_var_id</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="n">_var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;lon&#39;</span><span class="p">),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#####################################</span>
<span class="c1"># bar plot only North</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>    
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;NH mean: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> 
                          <span class="n">era</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bar_width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;+&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>No handles with labels found to put in legend.
</pre></div>
</div>
<img alt="../_images/b79bbe40c563b3e4eb2aa3adeecee961ea066ca85208305cd4df0813fabeda11.png" src="../_images/b79bbe40c563b3e4eb2aa3adeecee961ea066ca85208305cd4df0813fabeda11.png" />
</div>
</div>
</section>
<section id="global-30n-s">
<h2>Global, 30N/S<a class="headerlink" href="#global-30n-s" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>    
    
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Mean (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">],</span> 
                      <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_global_mean&#39;</span><span class="p">],</span> <span class="n">loc</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span><span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s2">&quot;Global&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> 
                        <span class="n">era</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;+&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;NH: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)),</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_bar_area_mean</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> 
                        <span class="n">era</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">)],</span> <span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">bar_width</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s2">&quot;//&quot;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;SH: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">ylabel</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_global_</span><span class="si">{}</span><span class="s1">NS_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/019d5aea7ee562bc929d0ea0b897804633c517b8638ac3b6da03e8cb68298052.png" src="../_images/019d5aea7ee562bc929d0ea0b897804633c517b8638ac3b6da03e8cb68298052.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="plot-iwp-vs-snowfall-for-when-snowfall-occurs-rightarrow-snowfall-0">
<h1>Plot IWP vs. snowfall for when snowfall occurs <span class="math notranslate nohighlight">\(\rightarrow\)</span> snowfall&gt;0<a class="headerlink" href="#plot-iwp-vs-snowfall-for-when-snowfall-occurs-rightarrow-snowfall-0" title="Permalink to this heading">#</a></h1>
<ul class="simple">
<li><p>is there a relationship?</p></li>
<li><p>if not - what else is going on?</p></li>
<li><p>then invastigate cloud phase processes</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;tciw&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.25</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h2>South of -30 deg<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">iteration_SH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_SH</span><span class="p">:</span>
    <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h2>North of 30 deg<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iteration_NH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="p">)</span>
<span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_NH</span><span class="p">:</span>
    <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_sf&gt;25&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<section id="calculate-linear-regression-and-create-dataset-from-latitudes">
<h3>Calculate linear regression and create dataset from latitudes<a class="headerlink" href="#calculate-linear-regression-and-create-dataset-from-latitudes" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_SH</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="n">era_NH</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="n">era_linreg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">era_SH</span><span class="p">,</span> <span class="n">era_NH</span><span class="p">])</span>

<span class="k">del</span> <span class="n">era_SH</span><span class="p">,</span> <span class="n">era_NH</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_mm_SH</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="n">cmip_mm_NH</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="n">cmip_mm_linreg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">cmip_mm_SH</span><span class="p">,</span> <span class="n">cmip_mm_NH</span><span class="p">])</span>

<span class="k">del</span> <span class="n">cmip_mm_SH</span><span class="p">,</span> <span class="n">cmip_mm_NH</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_SH</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="n">cmip_NH</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">cmip_SH</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
    <span class="n">cmip_NH</span><span class="p">[</span><span class="n">model</span><span class="p">]</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_ds_regression</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>


<span class="n">cmip_linreg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">merge</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip_SH</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> 
                                  <span class="n">dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip_SH</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> 
                                  <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;model&#39;</span><span class="p">}),</span> 
                        <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip_NH</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> 
                                  <span class="n">dim</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">cmip_NH</span><span class="o">.</span><span class="n">keys</span><span class="p">()),</span> 
                                  <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;model&#39;</span><span class="p">})])</span>

<span class="k">del</span> <span class="n">cmip_SH</span><span class="p">,</span> <span class="n">cmip_NH</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="table-with-regression-values">
<h3>Table with regression values<a class="headerlink" href="#table-with-regression-values" title="Permalink to this heading">#</a></h3>
<p>This step is not necessary as I could just use the <code class="docutils literal notranslate"><span class="pre">xarray.to_pandas()</span></code> function. But I want to have the table in the form as I want to use it in the paper, then I can use <code class="docutils literal notranslate"><span class="pre">pandas.to_latex()</span></code>. It can take any table output and make it LaTeX style for easy copy paste.</p>
<p>like so: <code class="docutils literal notranslate"><span class="pre">era_linreg_pd.round(3).to_latex()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_linreg_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">era_linreg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">da_sh</span><span class="p">,</span> <span class="n">idx_sh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">era_linreg</span><span class="p">,</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">da_nh</span><span class="p">,</span> <span class="n">idx_nh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">era_linreg</span><span class="p">,</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">da_sh</span><span class="p">,</span> <span class="n">da_nh</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">era_linreg_pd</span> <span class="o">=</span> <span class="n">era_linreg_pd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">era_linreg_pd</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">idx_sh</span><span class="p">,</span> <span class="n">idx_nh</span><span class="p">])]</span>
    
<span class="n">era_linreg_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># era_linreg_pd.drop(labels=&#39;season&#39;).astype(float).round(3).to_latex()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>[-30,-45]</th>
      <th>[-45,-60]</th>
      <th>[-60,-75]</th>
      <th>[-75,-90]</th>
      <th>[30,45]</th>
      <th>[45,60]</th>
      <th>[60,75]</th>
      <th>[75,90]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>R**2</th>
      <td>-0.208</td>
      <td>-0.039</td>
      <td>0.723</td>
      <td>0.787</td>
      <td>0.285</td>
      <td>0.563</td>
      <td>0.839</td>
      <td>0.958</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.004</td>
      <td>-0.004</td>
      <td>0.059</td>
      <td>0.051</td>
      <td>0.012</td>
      <td>0.044</td>
      <td>0.070</td>
      <td>0.073</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.626</td>
      <td>0.840</td>
      <td>-0.454</td>
      <td>-0.393</td>
      <td>0.403</td>
      <td>-0.367</td>
      <td>-1.004</td>
      <td>-0.977</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>0.103</td>
      <td>0.716</td>
      <td>0.936</td>
      <td>0.880</td>
      <td>-0.007</td>
      <td>0.194</td>
      <td>0.143</td>
      <td>0.499</td>
    </tr>
    <tr>
      <th>a</th>
      <td>0.007</td>
      <td>0.095</td>
      <td>0.070</td>
      <td>0.050</td>
      <td>-0.000</td>
      <td>0.005</td>
      <td>0.006</td>
      <td>0.041</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.331</td>
      <td>-2.561</td>
      <td>-1.070</td>
      <td>-0.617</td>
      <td>0.711</td>
      <td>0.361</td>
      <td>0.435</td>
      <td>-0.084</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>-0.198</td>
      <td>0.400</td>
      <td>0.903</td>
      <td>0.869</td>
      <td>0.193</td>
      <td>0.364</td>
      <td>0.722</td>
      <td>0.897</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.008</td>
      <td>0.050</td>
      <td>0.074</td>
      <td>0.051</td>
      <td>0.009</td>
      <td>0.027</td>
      <td>0.053</td>
      <td>0.071</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.874</td>
      <td>-1.047</td>
      <td>-1.017</td>
      <td>-0.566</td>
      <td>0.450</td>
      <td>0.011</td>
      <td>-0.496</td>
      <td>-0.852</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>-0.203</td>
      <td>0.620</td>
      <td>0.912</td>
      <td>0.857</td>
      <td>0.017</td>
      <td>0.366</td>
      <td>0.587</td>
      <td>0.827</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.009</td>
      <td>0.102</td>
      <td>0.071</td>
      <td>0.046</td>
      <td>0.001</td>
      <td>0.023</td>
      <td>0.043</td>
      <td>0.059</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.833</td>
      <td>-2.792</td>
      <td>-1.027</td>
      <td>-0.474</td>
      <td>0.629</td>
      <td>0.153</td>
      <td>-0.249</td>
      <td>-0.620</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_mm_linreg_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">cmip_mm_linreg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">da_sh</span><span class="p">,</span> <span class="n">idx_sh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">cmip_mm_linreg</span><span class="p">,</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
    <span class="n">da_nh</span><span class="p">,</span> <span class="n">idx_nh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">cmip_mm_linreg</span><span class="p">,</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

    <span class="n">da</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">da_sh</span><span class="p">,</span> <span class="n">da_nh</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">cmip_mm_linreg_pd</span> <span class="o">=</span> <span class="n">cmip_mm_linreg_pd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">cmip_mm_linreg_pd</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">idx_sh</span><span class="p">,</span> <span class="n">idx_nh</span><span class="p">])]</span>
    
<span class="n">cmip_mm_linreg_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># cmip_mm_linreg_pd.drop(labels=&#39;season&#39;).astype(float).round(3).to_latex()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th>[-30,-45]</th>
      <th>[-45,-60]</th>
      <th>[-60,-75]</th>
      <th>[-75,-90]</th>
      <th>[30,45]</th>
      <th>[45,60]</th>
      <th>[60,75]</th>
      <th>[75,90]</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>R**2</th>
      <td>-0.258</td>
      <td>-0.468</td>
      <td>0.617</td>
      <td>0.694</td>
      <td>-0.060</td>
      <td>0.190</td>
      <td>0.668</td>
      <td>0.905</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.001</td>
      <td>-0.004</td>
      <td>0.032</td>
      <td>0.034</td>
      <td>-0.001</td>
      <td>0.005</td>
      <td>0.028</td>
      <td>0.048</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.435</td>
      <td>0.716</td>
      <td>0.132</td>
      <td>-0.054</td>
      <td>0.742</td>
      <td>0.896</td>
      <td>0.214</td>
      <td>-0.219</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>-0.096</td>
      <td>-0.306</td>
      <td>0.919</td>
      <td>0.866</td>
      <td>0.071</td>
      <td>0.079</td>
      <td>0.035</td>
      <td>0.307</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.001</td>
      <td>-0.013</td>
      <td>0.057</td>
      <td>0.044</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.001</td>
      <td>0.009</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.473</td>
      <td>1.693</td>
      <td>-0.321</td>
      <td>-0.207</td>
      <td>0.535</td>
      <td>0.481</td>
      <td>0.545</td>
      <td>0.487</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>-0.232</td>
      <td>-0.372</td>
      <td>0.769</td>
      <td>0.888</td>
      <td>-0.066</td>
      <td>-0.065</td>
      <td>0.551</td>
      <td>0.789</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.001</td>
      <td>-0.007</td>
      <td>0.042</td>
      <td>0.047</td>
      <td>-0.001</td>
      <td>-0.002</td>
      <td>0.022</td>
      <td>0.040</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.458</td>
      <td>1.045</td>
      <td>0.027</td>
      <td>-0.240</td>
      <td>0.739</td>
      <td>0.963</td>
      <td>0.312</td>
      <td>-0.059</td>
    </tr>
    <tr>
      <th>R**2</th>
      <td>-0.047</td>
      <td>-0.448</td>
      <td>0.894</td>
      <td>0.838</td>
      <td>-0.237</td>
      <td>-0.170</td>
      <td>0.291</td>
      <td>0.671</td>
    </tr>
    <tr>
      <th>a</th>
      <td>-0.000</td>
      <td>-0.015</td>
      <td>0.054</td>
      <td>0.041</td>
      <td>-0.002</td>
      <td>-0.003</td>
      <td>0.010</td>
      <td>0.025</td>
    </tr>
    <tr>
      <th>b</th>
      <td>0.415</td>
      <td>1.631</td>
      <td>-0.243</td>
      <td>-0.173</td>
      <td>0.675</td>
      <td>1.037</td>
      <td>0.717</td>
      <td>0.295</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip_linreg</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>    
    <span class="n">cmip_linreg_pd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">season</span> <span class="ow">in</span> <span class="n">cmip_linreg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">)</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
        <span class="n">da_sh</span><span class="p">,</span> <span class="n">idx_sh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">cmip_linreg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="o">-</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">da_nh</span><span class="p">,</span> <span class="n">idx_nh</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">return_pd_dataFrame_corr_coeff</span><span class="p">(</span><span class="n">cmip_linreg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">season</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>

        <span class="n">da</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">da_sh</span><span class="p">,</span> <span class="n">da_nh</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

        <span class="n">cmip_linreg_pd</span> <span class="o">=</span> <span class="n">cmip_linreg_pd</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
    <span class="n">cmip_linreg_pd</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">idx_sh</span><span class="p">,</span> <span class="n">idx_nh</span><span class="p">])]</span>
        
    <span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">cmip_linreg_pd</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>

    <span class="c1"># print(model, cmip_linreg_pd.drop(labels=&#39;season&#39;).astype(float).round(3).to_latex())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>BCC-CSM2-MR      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN    -0.196     0.654     0.945   0.394   0.546   0.757   0.699
a          NaN    -0.008     0.029     0.028   0.013   0.023   0.040   0.033
b          NaN     0.814    -0.229    -0.215   0.277  -0.025  -0.658  -0.537
R**2    -0.039     0.515     0.880     0.950  -0.001   0.406   0.423   0.846
a       -0.001     0.040     0.045     0.029  -0.000   0.010   0.018   0.048
b        0.454    -1.225    -0.599    -0.252   0.600   0.140  -0.011  -0.630
R**2    -0.053     0.343     0.834     0.931   0.286   0.333   0.723   0.732
a       -0.003     0.014     0.043     0.028   0.014   0.013   0.035   0.029
b        0.610    -0.173    -0.641    -0.204   0.263   0.287  -0.410  -0.366
R**2     0.306     0.159     0.826     0.957   0.281   0.446   0.629   0.888
a        0.005     0.011     0.041     0.030   0.011   0.017   0.035   0.049
b        0.330     0.115    -0.451    -0.280   0.306   0.102  -0.475  -0.963
CAMS-CSM1-0      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
CIESM      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
CMCC-CM2-HR4      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN     0.047     0.230     0.446   0.384   0.311   0.655   0.925
a          NaN     0.004     0.024     0.024   0.021   0.021   0.059   0.067
b          NaN     0.477     0.353    -0.208   0.208   0.271  -0.955  -1.208
R**2    -0.105     0.430     0.834     0.769  -0.295   0.141   0.348   0.685
a       -0.003     0.052     0.091     0.043  -0.022   0.006   0.023   0.044
b        0.636    -1.007    -1.909    -0.894   1.130   0.349   0.079  -0.096
R**2     0.168     0.119     0.792     0.801   0.259   0.354   0.543   0.779
a        0.004     0.010     0.083     0.044   0.023   0.019   0.037   0.052
b        0.377     0.304    -1.541    -0.878   0.203   0.170  -0.216  -0.677
R**2    -0.279    -0.020     0.692     0.766   0.275   0.451   0.373   0.616
a       -0.008    -0.002     0.072     0.039   0.018   0.025   0.032   0.037
b        0.851     0.836    -1.215    -0.759   0.283   0.040  -0.021  -0.175
CMCC-CM2-SR5      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.798    -0.305    -0.592    -0.273   0.112   0.114   0.197   0.736
a       -0.079    -0.049    -0.037    -0.004   0.003   0.004   0.012   0.030
b        1.240     1.317     1.690     0.495   0.736   1.044   0.941   0.495
R**2    -0.023    -0.074     0.487     0.719  -0.121  -0.059  -0.019   0.262
a       -0.001    -0.006     0.063     0.153  -0.004  -0.001  -0.001   0.046
b        0.680     1.413     0.884    -0.787   0.950   0.558   0.591   0.394
R**2    -0.049    -0.322     0.481     0.632   0.447  -0.097   0.095   0.689
a       -0.003    -0.024     0.063     0.141   0.012  -0.004   0.006   0.059
b        0.621     1.544     0.874    -0.537   0.531   1.012   0.869   0.352
R**2    -0.317    -0.313     0.407     0.560   0.237  -0.058  -0.195   0.016
a       -0.009    -0.024     0.063     0.105   0.008  -0.002  -0.012   0.000
b        0.685     1.672     0.856    -0.345   0.558   0.937   1.277   1.086
CMCC-ESM2      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
R**2       NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
a          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
b          NaN       NaN       NaN       NaN     NaN     NaN     NaN     NaN
E3SM-1-1      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN    -0.426     0.033     0.693   0.301   0.373   0.658   0.952
a          NaN    -0.021     0.003     0.090   0.011   0.021   0.030   0.049
b          NaN     0.846     0.810    -0.086   0.655   0.922   0.691   0.339
R**2    -0.193    -0.366     0.572     0.653  -0.294  -0.067  -0.146   0.242
a       -0.004    -0.032     0.068     0.207  -0.011  -0.002  -0.006   0.027
b        0.579     1.973     0.968    -0.309   0.776   0.511   0.613   0.503
R**2     0.024    -0.309     0.433     0.816   0.089  -0.042   0.471   0.886
a        0.001    -0.019     0.034     0.238   0.004  -0.002   0.020   0.045
b        0.468     1.255     1.067    -0.397   0.760   1.051   0.675   0.314
R**2    -0.047    -0.431     0.548     0.672   0.116   0.116   0.040   0.790
a       -0.001    -0.023     0.074     0.237   0.003   0.005   0.002   0.023
b        0.442     1.432     0.823    -0.387   0.586   0.902   1.042   0.658
E3SM-1-1-ECA      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2       NaN    -0.510    -0.029     0.752   0.301   0.413   0.686   0.949
a          NaN    -0.026    -0.003     0.090   0.011   0.022   0.035   0.056
b          NaN     0.927     0.880    -0.066   0.674   0.861   0.637   0.311
R**2    -0.287    -0.303     0.567     0.641  -0.258   0.002  -0.107   0.383
a       -0.005    -0.025     0.069     0.204  -0.010   0.000  -0.005   0.045
b        0.566     1.764     0.958    -0.289   0.718   0.516   0.628   0.447
R**2     0.459    -0.319     0.464     0.805   0.091   0.101   0.601   0.901
a        0.005    -0.021     0.037     0.252   0.004   0.005   0.027   0.054
b        0.321     1.304     1.029    -0.460   0.765   0.913   0.608   0.281
R**2     0.136    -0.455     0.546     0.725   0.126   0.139   0.135   0.813
a        0.002    -0.028     0.075     0.266   0.003   0.006   0.005   0.028
b        0.412     1.568     0.823    -0.498   0.565   0.873   0.990   0.597
EC-Earth3-AerChem      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.315    -0.163     0.484     0.918   0.217   0.527   0.876   0.946
a       -0.004    -0.003     0.022     0.049   0.005   0.024   0.047   0.055
b        0.377     0.614    -0.007    -0.609   0.562  -0.071  -0.883  -1.024
R**2     0.165     0.186     0.928     0.934  -0.145   0.133   0.194   0.657
a        0.006     0.010     0.048     0.036  -0.004   0.003   0.005   0.036
b        0.459     0.258    -0.872    -0.506   0.819   0.434   0.409  -0.207
R**2    -0.016     0.050     0.768     0.939   0.119   0.331   0.805   0.856
a       -0.000     0.001     0.042     0.045   0.003   0.015   0.038   0.053
b        0.576     0.450    -0.767    -0.658   0.596   0.238  -0.436  -0.827
R**2    -0.252    -0.035     0.856     0.933   0.035   0.383   0.610   0.847
a       -0.004    -0.002     0.046     0.040   0.001   0.013   0.027   0.042
b        0.796     0.787    -0.717    -0.566   0.618   0.253  -0.131  -0.583
FGOALS-f3-L      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.042    -0.147     0.494     0.610  -0.053   0.168   0.597   0.582
a       -0.000    -0.001     0.009     0.010  -0.000   0.001   0.008   0.008
b        0.361     0.488     0.118     0.064   0.705   0.700   0.150   0.026
R**2    -0.174    -0.328     0.861     0.518  -0.042   0.185   0.150   0.468
a       -0.002    -0.004     0.016     0.009  -0.000   0.001   0.002   0.010
b        0.907     1.220    -0.224     0.001   0.713   0.373   0.395   0.067
R**2    -0.231    -0.343     0.605     0.726   0.122   0.012   0.514   0.550
a       -0.002    -0.003     0.011     0.019   0.001   0.000   0.007   0.008
b        0.850     0.826     0.050    -0.379   0.518   0.704   0.189   0.086
R**2    -0.287    -0.439     0.873     0.571   0.080   0.013   0.412   0.714
a       -0.002    -0.005     0.016     0.010   0.001   0.000   0.006   0.016
b        0.795     1.114    -0.227     0.016   0.561   0.687   0.284  -0.210
GFDL-CM4      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.017    -0.078     0.498     0.911   0.270   0.492   0.863   0.919
a       -0.000    -0.001     0.008     0.025   0.003   0.008   0.024   0.035
b        0.331     0.557     0.438     0.060   0.519   0.567  -0.007  -0.237
R**2     0.189     0.210     0.941     0.897   0.165   0.240   0.036  -0.041
a        0.001     0.007     0.025     0.024   0.002   0.001   0.000  -0.001
b        0.336     0.615     0.068     0.038   0.616   0.328   0.468   0.648
R**2    -0.038     0.146     0.807     0.912   0.133   0.418   0.763   0.908
a       -0.000     0.003     0.020     0.025   0.002   0.006   0.016   0.026
b        0.416     0.485     0.200     0.040   0.565   0.418   0.152  -0.021
R**2     0.087     0.187     0.913     0.899  -0.078   0.180   0.652   0.878
a        0.000     0.008     0.022     0.023  -0.001   0.002   0.010   0.018
b        0.377     0.327     0.149     0.058   0.654   0.706   0.402   0.182
GFDL-ESM4      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.025    -0.014     0.442     0.902   0.210   0.389   0.840   0.925
a       -0.000    -0.000     0.007     0.021   0.002   0.006   0.022   0.040
b        0.369     0.452     0.456     0.097   0.585   0.700   0.063  -0.366
R**2     0.308     0.275     0.932     0.893   0.330   0.168  -0.002  -0.061
a        0.002     0.007     0.023     0.023   0.005   0.000  -0.000  -0.001
b        0.265     0.421     0.078     0.037   0.432   0.354   0.460   0.627
R**2     0.046     0.273     0.765     0.913   0.112   0.121   0.730   0.890
a        0.000     0.005     0.017     0.024   0.002   0.002   0.015   0.027
b        0.386     0.167     0.241     0.043   0.595   0.789   0.261  -0.075
R**2     0.281     0.153     0.860     0.905  -0.068   0.090   0.587   0.890
a        0.002     0.005     0.019     0.021  -0.001   0.001   0.009   0.018
b        0.287     0.412     0.196     0.076   0.688   0.820   0.443   0.153
MPI-ESM1-2-HR      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.460    -0.143     0.451     0.915   0.241   0.275   0.714   0.975
a       -0.001    -0.002     0.012     0.023   0.006   0.009   0.025   0.038
b        0.445     0.590     0.283     0.022   0.426   0.545  -0.033  -0.327
R**2     0.402    -0.023     0.881     0.905  -0.086   0.338   0.107   0.485
a        0.011    -0.001     0.034     0.026  -0.002   0.004   0.002   0.015
b        0.058     0.891    -0.261    -0.044   0.836   0.211   0.422   0.049
R**2     0.108     0.012     0.652     0.920   0.373   0.149   0.647   0.920
a        0.002     0.000     0.023     0.028   0.014   0.005   0.020   0.034
b        0.575     0.541     0.061    -0.067  -0.166   0.664   0.086  -0.274
R**2     0.261    -0.187     0.888     0.906   0.247   0.367   0.498   0.827
a        0.004    -0.010     0.032     0.024   0.005   0.011   0.014   0.025
b        0.359     1.449    -0.166    -0.014   0.354   0.202   0.269  -0.047
MRI-ESM2-0      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.423    -0.345     0.550     0.869   0.436   0.202   0.693   0.950
a       -0.002    -0.040     0.069     0.107   0.032   0.014   0.068   0.128
b        0.340     1.412    -0.020    -0.505   0.183   0.737  -0.066  -0.846
R**2     0.167     0.025     0.899     0.949  -0.376   0.059   0.183   0.601
a        0.012     0.004     0.117     0.085  -0.014   0.002   0.014   0.093
b        0.254     0.877    -0.737    -0.474   0.903   0.479   0.425  -0.068
R**2     0.066    -0.050     0.714     0.946   0.410  -0.019   0.602   0.928
a        0.002    -0.007     0.091     0.100   0.041  -0.001   0.052   0.117
b        0.628     0.879    -0.321    -0.597  -0.108   0.859   0.143  -0.606
R**2    -0.050    -0.385     0.876     0.951   0.318   0.146   0.331   0.801
a       -0.002    -0.062     0.121     0.090   0.021   0.009   0.028   0.074
b        0.551     2.419    -0.766    -0.513   0.313   0.705   0.548  -0.042
NorESM2-MM      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -1.000    -0.367     0.377     0.462   0.119   0.142   0.567   0.880
a       -0.002    -0.039     0.060     0.110   0.005   0.010   0.049   0.150
b        0.296     1.153     0.489    -0.206   0.620   0.942   0.321  -0.757
R**2    -0.062    -0.234     0.758     0.491   0.183   0.094  -0.101   0.414
a       -0.002    -0.027     0.117     0.088   0.009   0.002  -0.005   0.056
b        0.614     1.777    -0.254    -0.477   0.608   0.507   0.667   0.362
R**2     0.370    -0.348     0.639     0.407   0.582   0.003   0.383   0.810
a        0.015    -0.035     0.089     0.089   0.025   0.000   0.027   0.161
b        0.401     1.625     0.353    -0.299   0.109   0.883   0.554  -0.600
R**2     0.035    -0.304     0.717     0.347   0.207   0.108   0.255   0.867
a        0.001    -0.028     0.122     0.058   0.009   0.006   0.018   0.164
b        0.501     1.538    -0.254    -0.151   0.458   0.799   0.807  -0.561
SAM0-UNICON      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2    -0.190    -0.246     0.424     0.243  -0.047   0.013   0.299   0.801
a       -0.055    -0.068     0.172     0.075  -0.002   0.001   0.021   0.136
b        1.040     1.524     0.791     0.266   1.006   1.607   1.235   0.153
R**2    -0.275    -0.169     0.511     0.607  -0.047  -0.123  -0.198   0.377
a       -0.013    -0.022     0.128     0.246  -0.002  -0.007  -0.041   0.345
b        0.853     2.050     1.187    -0.708   0.953   0.772   1.062   0.404
R**2    -0.422    -0.368     0.401     0.460   0.318  -0.230   0.105   0.764
a       -0.027    -0.049     0.102     0.234   0.021  -0.016   0.008   0.232
b        0.935     1.989     1.587    -0.402   0.613   1.454   1.258  -0.089
R**2    -0.147    -0.397     0.547     0.452   0.064  -0.166  -0.098   0.634
a       -0.007    -0.063     0.187     0.185   0.006  -0.012  -0.008   0.216
b        0.666     2.572     0.778    -0.332   0.831   1.439   1.643   0.439
TaiESM1      [-30,-45] [-45,-60] [-60,-75] [-75,-90] [30,45] [45,60] [60,75] [75,90]
R**2     0.545    -0.383     0.121     0.337   0.120   0.100   0.285   0.782
a        0.012    -0.007     0.007     0.031   0.001   0.001   0.007   0.050
b        0.299     0.950     1.164     0.151   0.733   1.151   0.914   0.120
R**2    -0.210    -0.414     0.428     0.730   0.156  -0.031  -0.193   0.352
a       -0.002    -0.010     0.026     0.120   0.005  -0.000  -0.006   0.055
b        0.818     1.959     1.248    -0.683   0.631   0.565   0.735   0.406
R**2    -0.106    -0.496     0.255     0.509   0.137  -0.142   0.110   0.717
a       -0.001    -0.010     0.013     0.095   0.002  -0.002   0.003   0.069
b        0.665     1.529     1.456    -0.557   0.706   1.022   0.904   0.061
R**2    -0.327    -0.524     0.472     0.676   0.142  -0.101  -0.091   0.571
a       -0.004    -0.014     0.029     0.086   0.003  -0.001  -0.002   0.031
b        0.800     1.927     1.120    -0.375   0.602   1.021   1.208   0.544
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-iwp-snowfall-scatter-with-regression-lines">
<h3>Plot IWP-snowfall scatter with regression lines<a class="headerlink" href="#plot-iwp-snowfall-scatter-with-regression-lines" title="Permalink to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for ERA5 SH</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="n">era_linreg</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: ERA5  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/ERA5/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># for ERA5 NH</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">era</span><span class="p">,</span> <span class="n">era_linreg</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: ERA5  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/ERA5/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/976196fa7c9a4c2b1166c65b31854e348758b0fc757e8d282ffecec56e16e155.png" src="../_images/976196fa7c9a4c2b1166c65b31854e348758b0fc757e8d282ffecec56e16e155.png" />
<img alt="../_images/0f1cd9ff664af78d5712d426d6c442d78e980e738e9c98108707678fef94ca85.png" src="../_images/0f1cd9ff664af78d5712d426d6c442d78e980e738e9c98108707678fef94ca85.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for CMIP6 model mean SH</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">cmip_mm_linreg</span><span class="p">,</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: CMIP6 Model Mean  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_model_mean_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">############################################################</span>
<span class="c1"># for CMIP6 model mean NH</span>
<span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">cmip_mm_linreg</span><span class="p">,</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: CMIP6 Model Mean  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_model_mean_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">),</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d293dd3214a124b282375d5b74221450e63b008e02c1a25bc1ef8b1bd66da421.png" src="../_images/d293dd3214a124b282375d5b74221450e63b008e02c1a25bc1ef8b1bd66da421.png" />
<img alt="../_images/6bf8a5f7bf19a24f409fa172f988b008255e67d5b9245346af36e1aba4a0fc4d.png" src="../_images/6bf8a5f7bf19a24f409fa172f988b008255e67d5b9245346af36e1aba4a0fc4d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># for CMIP6 individual model SH</span>
    <span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">cmip_linreg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">iteration_SH</span><span class="p">,</span> <span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: </span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>


    <span class="c1"># save figure to png</span>
    <span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
    <span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">),</span> <span class="n">model</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

    <span class="c1">############################################################</span>
    <span class="c1"># for CMIP6 individual model NH</span>
    <span class="n">fct</span><span class="o">.</span><span class="n">plt_scatter_iwp_sf_seasonal</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">cmip_linreg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="p">),</span> <span class="n">iteration_NH</span><span class="p">,</span> <span class="n">step</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;IWP vs. Snowfall: </span><span class="si">{}</span><span class="s1">  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)),</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">ylim</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">15</span><span class="p">])</span>


    <span class="c1"># save figure to png</span>
    <span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
    <span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;iwp_sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_season_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">),</span> <span class="n">model</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/9c5d72bc2ebf217ac1784f62af1fdd36afd010a621d0b5b8d9043a606c8301e6.png" src="../_images/9c5d72bc2ebf217ac1784f62af1fdd36afd010a621d0b5b8d9043a606c8301e6.png" />
<img alt="../_images/4844c1622834ce8e4ea8e4891b773849ec94a95bde1172ff25e9ea13e33f7930.png" src="../_images/4844c1622834ce8e4ea8e4891b773849ec94a95bde1172ff25e9ea13e33f7930.png" />
<img alt="../_images/4515112e31ad4422d5d2de6f8af17521615a2d0ea439e0c62699f638032d780e.png" src="../_images/4515112e31ad4422d5d2de6f8af17521615a2d0ea439e0c62699f638032d780e.png" />
<img alt="../_images/c1a39924f8aa5c2941961edd514b2ded2032d5f12d435edf56f3f2b100021668.png" src="../_images/c1a39924f8aa5c2941961edd514b2ded2032d5f12d435edf56f3f2b100021668.png" />
<img alt="../_images/332d028f43c57c47c86d9f371c584fbc68acfbe8f9f7665beb0ef0103fdcce40.png" src="../_images/332d028f43c57c47c86d9f371c584fbc68acfbe8f9f7665beb0ef0103fdcce40.png" />
<img alt="../_images/7e37ee74be72b0cbf5426547186cdffe9ae52774b5cfce403be283aef60635d9.png" src="../_images/7e37ee74be72b0cbf5426547186cdffe9ae52774b5cfce403be283aef60635d9.png" />
<img alt="../_images/a3ed019f97ca3a522cad04e13ee278ab235eb73e62b2ddc0e1b1271bb551bb9d.png" src="../_images/a3ed019f97ca3a522cad04e13ee278ab235eb73e62b2ddc0e1b1271bb551bb9d.png" />
<img alt="../_images/da78806e59b5a1e93643d01abbee513a072d785db24e860d61dcda8b22bbc9fa.png" src="../_images/da78806e59b5a1e93643d01abbee513a072d785db24e860d61dcda8b22bbc9fa.png" />
<img alt="../_images/c1a5ac068d5b818103ed15428d5aabdbe9e8265079076f1f038dfe5199ec3440.png" src="../_images/c1a5ac068d5b818103ed15428d5aabdbe9e8265079076f1f038dfe5199ec3440.png" />
<img alt="../_images/65755aca4cacc06ccb0526fb02d9ee791bac280f308d191c860dfa3b31ccdf49.png" src="../_images/65755aca4cacc06ccb0526fb02d9ee791bac280f308d191c860dfa3b31ccdf49.png" />
<img alt="../_images/621ef2c30e55643603f61974cfe5e35b862407003705a6e23885181b398e0bf2.png" src="../_images/621ef2c30e55643603f61974cfe5e35b862407003705a6e23885181b398e0bf2.png" />
<img alt="../_images/46dc003235b50732a8ccb09b6e8e10567cab7e7510aea780355944d6c8577117.png" src="../_images/46dc003235b50732a8ccb09b6e8e10567cab7e7510aea780355944d6c8577117.png" />
<img alt="../_images/807fa7c667e015af68d6cb3b6cb1c0674b8f5c0406495569c987d3156ff9bb9c.png" src="../_images/807fa7c667e015af68d6cb3b6cb1c0674b8f5c0406495569c987d3156ff9bb9c.png" />
<img alt="../_images/a086ed454f7716f02c84695a2077f8f9b1741e9f7b4880097b65d1b5b92bc6ae.png" src="../_images/a086ed454f7716f02c84695a2077f8f9b1741e9f7b4880097b65d1b5b92bc6ae.png" />
<img alt="../_images/b34ef63ac17b8347eb9e6a591f5471d263df5f9bb29ba47de3113ba8bf42ac18.png" src="../_images/b34ef63ac17b8347eb9e6a591f5471d263df5f9bb29ba47de3113ba8bf42ac18.png" />
<img alt="../_images/ca885eaca18c934b113f5385010b78323820d6b5214370c856e663070d38a0e0.png" src="../_images/ca885eaca18c934b113f5385010b78323820d6b5214370c856e663070d38a0e0.png" />
<img alt="../_images/de3f81e5f6524696da8cb09c6a08bd7e6466fb40f7f92242298e6753a53b1a05.png" src="../_images/de3f81e5f6524696da8cb09c6a08bd7e6466fb40f7f92242298e6753a53b1a05.png" />
<img alt="../_images/6cf1c88fbcc2fea3c562bd99fdd4a37dfa002ac576236129af5e55842ddb99f3.png" src="../_images/6cf1c88fbcc2fea3c562bd99fdd4a37dfa002ac576236129af5e55842ddb99f3.png" />
<img alt="../_images/e0f287d02aa77f4b9f09cdaf50fec055b8b5dc140ede6b38538f9379b86ff400.png" src="../_images/e0f287d02aa77f4b9f09cdaf50fec055b8b5dc140ede6b38538f9379b86ff400.png" />
<img alt="../_images/1dc503010ece6a999b4689ff6276054b5b12e953c63709f461bd795cc45b6d3e.png" src="../_images/1dc503010ece6a999b4689ff6276054b5b12e953c63709f461bd795cc45b6d3e.png" />
<img alt="../_images/a3aa9d9d1907cc74fbbe1679b61da093a8862455292b8a5866c267752bbb066b.png" src="../_images/a3aa9d9d1907cc74fbbe1679b61da093a8862455292b8a5866c267752bbb066b.png" />
<img alt="../_images/18f0d17ee78ecf32cf8a3235374538ffa4cd44bc5da0bc1905884c4be7f58552.png" src="../_images/18f0d17ee78ecf32cf8a3235374538ffa4cd44bc5da0bc1905884c4be7f58552.png" />
<img alt="../_images/271600ab63286021dcf344a6da27be42ee4370d7c02ee9126cf2a3d980ada25d.png" src="../_images/271600ab63286021dcf344a6da27be42ee4370d7c02ee9126cf2a3d980ada25d.png" />
<img alt="../_images/9bb26358986f380e1560236ca623d873689a75c83b456959700c339125fb6305.png" src="../_images/9bb26358986f380e1560236ca623d873689a75c83b456959700c339125fb6305.png" />
<img alt="../_images/7efff9ea33a7f151401512f1f91f65045519ab3024097e0913779a1e3d37c01f.png" src="../_images/7efff9ea33a7f151401512f1f91f65045519ab3024097e0913779a1e3d37c01f.png" />
<img alt="../_images/537aac43541ae81c1e9a070a878cbc751ed5cf7d0f7365f0da834d6453e5ca58.png" src="../_images/537aac43541ae81c1e9a070a878cbc751ed5cf7d0f7365f0da834d6453e5ca58.png" />
<img alt="../_images/9f5eb6431ece17682eac7e4f65882a4426e6059ab5d09b8c6a87213b57bbed8a.png" src="../_images/9f5eb6431ece17682eac7e4f65882a4426e6059ab5d09b8c6a87213b57bbed8a.png" />
<img alt="../_images/df18c14d7ad578128e989628717461eea889fe7b623cffb50bf274fc106b5a54.png" src="../_images/df18c14d7ad578128e989628717461eea889fe7b623cffb50bf274fc106b5a54.png" />
<img alt="../_images/76fb2160f569c153f1070c44b9ec8f9d5fba1ac3867d49d5f8c634982888a224.png" src="../_images/76fb2160f569c153f1070c44b9ec8f9d5fba1ac3867d49d5f8c634982888a224.png" />
<img alt="../_images/6c97f25b9341099751c44ad35d9c7b0bcaa1063f6f8f86be1f101f0838c90fb1.png" src="../_images/6c97f25b9341099751c44ad35d9c7b0bcaa1063f6f8f86be1f101f0838c90fb1.png" />
<img alt="../_images/550c7e622272515728e472aa57486fd70312d37429bbeccb33c53bd6e1395195.png" src="../_images/550c7e622272515728e472aa57486fd70312d37429bbeccb33c53bd6e1395195.png" />
<img alt="../_images/3e9c4af1b36f4ce82e81853ad617c8f7b72f8b23a47e18e5f7e3166230069922.png" src="../_images/3e9c4af1b36f4ce82e81853ad617c8f7b72f8b23a47e18e5f7e3166230069922.png" />
<img alt="../_images/3909513ea9749561f1311eb6709f7b3c60a5bd97345fc8c35ed35effa98b46d1.png" src="../_images/3909513ea9749561f1311eb6709f7b3c60a5bd97345fc8c35ed35effa98b46d1.png" />
<img alt="../_images/e78e18fc14c7c393054cf588696c72b5e26f24e84f4a305bf850be1e61424af3.png" src="../_images/e78e18fc14c7c393054cf588696c72b5e26f24e84f4a305bf850be1e61424af3.png" />
</div>
</div>
</section>
</section>
<section id="difference-era5-cmip6-model-mean">
<h2>Difference ERA5 - CMIP6 model mean<a class="headerlink" href="#difference-era5-cmip6-model-mean" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">step</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">diff</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">-</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">-</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">-</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">-</span> <span class="n">cmip</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall: ERA5 - CMIP6 model mean  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                   <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> 
                    <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> 
                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        
        <span class="c1"># _mask = (~np.isnan(diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()) &amp; ~np.isnan(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()))</span>
        <span class="c1"># _x = np.linspace(0,100)</span>
        <span class="c1"># _y = _x*linregress(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask],</span>
        <span class="c1">#                    diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask]).slope + linregress(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask], diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask]).intercept</span>
    
        <span class="c1"># ax.plot(_x, _y, color = c, linewidth = &#39;2&#39;)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall: ERA5 - CMIP6$_{model mean}$ (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path: ERA5 - CMIP5$_{model mean}$ (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;season: </span><span class="si">{}</span><span class="s2">; lat: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">)))</span>
    
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall: ERA5 - CMIP6 model mean  </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">diff</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="n">step</span><span class="p">),</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">diff</span><span class="p">[</span><span class="s1">&#39;iwp_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                    <span class="n">diff</span><span class="p">[</span><span class="s1">&#39;sf_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> 
                    <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> 
                    <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>
        
        <span class="c1"># _mask = (~np.isnan(diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()) &amp; ~np.isnan(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()))</span>
        <span class="c1"># _x = np.linspace(0,100)</span>
        <span class="c1"># _y = _x*linregress(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask],</span>
        <span class="c1">#                    diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask]).slope + linregress(diff[&#39;iwp_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask], diff[&#39;sf_{}_{}&#39;.format(_lat, _lat+step)].sel(season=i).values.flatten()[_mask]).intercept</span>
    
        <span class="c1"># ax.plot(_x, _y, color = c, linewidth = &#39;2&#39;)</span>

    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall: ERA5 - CMIP6$_{model mean}$ (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path: ERA5 - CMIP5$_{model mean}$ (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;season: </span><span class="si">{}</span><span class="s2">; lat: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">)))</span>
    
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">)))),):</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall  (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

        <span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">era_where_snowfall</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;tciw_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;sf_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;clivi_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;prsn_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">k</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="n">k</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;season: </span><span class="si">{}</span><span class="s2">; lat: [30, 90]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

        <span class="c1"># save figure to png</span>
        <span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;prsn_clivi_(30,90)_1deg_1985_2014_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_iwc</span> <span class="o">=</span> <span class="p">(</span><span class="n">cmip_global_mean</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">era_global_mean</span><span class="p">[</span><span class="s1">&#39;tciw&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
<span class="n">idx_sf</span> <span class="o">=</span> <span class="p">(</span><span class="n">cmip_global_mean</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">era_global_mean</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx_sf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall  (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_iwc</span><span class="p">,</span> <span class="n">idx_sf</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">era_where_snowfall</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;tciw_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;sf_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;clivi_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">idx_iwc</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;prsn_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">idx_sf</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_iwc</span><span class="p">,</span> <span class="n">idx_sf</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;season: </span><span class="si">{}</span><span class="s2">; lat: [30, 90]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;prsn_clivi_(30,90)_1deg_1985_2014_min.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lats</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall  (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_iwc</span><span class="p">,</span> <span class="n">idx_sf</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">era_where_snowfall</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;tciw_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;sf_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;clivi_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">idx_iwc</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">cmip_where_snowfall</span><span class="p">[</span><span class="s1">&#39;prsn_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">idx_sf</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="n">lats</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">idx_iwc</span><span class="p">,</span> <span class="n">idx_sf</span><span class="p">),</span> <span class="n">color</span> <span class="o">=</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;season: </span><span class="si">{}</span><span class="s2">; lat: [-90, -30]&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span><span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;prsn_clivi_(-90,-30)_1deg_1985_2014_min.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;tciw_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;tciw_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">era_where_snowfall</span><span class="p">[</span><span class="s1">&#39;sf_season&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">),</span> <span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot scatter zonal mean</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">cfiles</span><span class="p">)</span>
<span class="n">era</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">efiles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_zonal_season</span> <span class="o">=</span> <span class="n">cmip</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_zonal_season</span> <span class="o">=</span> <span class="n">era</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot zonal mean for each CMIP6 model</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                         <span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;IWP vs. Snowfall (zonal, 1985 - 2014)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">prsn_zonal_season</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="c1"># for k, c in zip(cmip.model.values, cm.romaO(range(0, 256, int(256/len(cmip.model.values))))):</span>
    <span class="c1">#     ax.scatter((cmip_zonal_season[&#39;clivi&#39;]*1000).sel(season=i, model=k), (cmip_zonal_season[&#39;prsn&#39;]*86400).sel(season=i, model=k), label=k, color =c )</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">cmip_zonal_season</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">cmip_zonal_season</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">86400</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span> <span class="o">=</span><span class="s1">&#39;CMIP6 mean&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;grey&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">((</span><span class="n">era_zonal_season</span><span class="p">[</span><span class="s1">&#39;tciw&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="p">(</span><span class="n">era_zonal_season</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Snowfall (mm$\,$day$^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Ice Water Path (g$\,$m$^{-2}$)&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;center left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">&#39;small&#39;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6_ERA5_CloudSat/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;prsn_clivi_zonal_1deg_1985_2014.png&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Calculate significance of ERA5-CMIP6 difference, with the help of two-sample t-test.</p>
<section id="hypothesis">
<h3>Hypothesis<a class="headerlink" href="#hypothesis" title="Permalink to this heading">#</a></h3>
<p>When performing t-tests you typically have the following two hypotheses:</p>
<ul class="simple">
<li><p>Null hypotheses: Two group means are equal</p></li>
<li><p>Alternative hypotheses: Two group means are different (two-tailed)</p></li>
</ul>
</section>
<section id="assumptions">
<h3>Assumptions<a class="headerlink" href="#assumptions" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p>Assumption 1: Are the two samples independent?</p>
<ul>
<li><p>yes</p></li>
</ul>
</li>
<li><p>Assumption 2: Are the data from each of the 2 groups following a normal distribution?</p></li>
<li><p>Assumption 3: Do the two samples have the same variances (Homogeneity of Variance)?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_file</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/CMIP6_hist/1deg/</span><span class="si">{}</span><span class="s1">_Amon_1deg_198501_201412.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">era_file</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/ERA5/monthly_means/1deg/</span><span class="si">{}</span><span class="s1">_Amon_1deg_198501_201412.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="n">cmip</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">cmip_file</span><span class="p">)</span>
<span class="n">cmip</span> <span class="o">=</span> <span class="n">cmip</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">era</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">era_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">,</span> <span class="s1">&#39;tciw&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmip_file</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/CMIP6_hist/1deg/*_Amon_1deg_198501_201412.nc&#39;</span>
<span class="n">ff</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">cmip_file</span><span class="p">)</span>
<span class="n">ff</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ds_cmip</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ff</span><span class="p">)):</span>
    <span class="n">_ds_cmip</span><span class="p">[</span><span class="n">ff</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">decode_times</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">_ds_cmip</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">_ds_cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_id</span> <span class="o">=</span> <span class="p">[</span>
               <span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">,</span> <span class="s1">&#39;sf&#39;</span><span class="p">],</span>
               <span class="c1"># [&#39;clivi&#39;, &#39;tciw&#39;]</span>
            <span class="c1">#    [&#39;lwp&#39;, &#39;tclw&#39;],</span>
               <span class="c1"># [&#39;tas&#39;, &#39;2t&#39;]</span>
               <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">),</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ff</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span>  <span class="s1">&#39;prsn&#39;</span><span class="p">:</span>
    <span class="c1"># kg m-2 s-1 to mm/day *86400</span>
    <span class="n">prsn</span> <span class="o">=</span> <span class="n">cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span><span class="o">*</span><span class="mi">86400</span>

    <span class="c1"># m of water equivalent can be converted to kgm^2/day or mm/day by multiplying by 1000.</span>
    <span class="n">sf</span> <span class="o">=</span> <span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">*</span><span class="mi">1000</span>
</pre></div>
</div>
</div>
</div>
<p>If our variable follows a normal distribution, the quantiles of our variable must be perfectly in line with the “theoretical” normal quantiles: a straight line on the QQ Plot tells us we have a normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">prsn</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span> <span class="n">plt</span><span class="p">);</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">sf</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span> <span class="n">plt</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">era</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">]);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sf_stat</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span> <span class="o">=</span> <span class="s1">&#39;DJF&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
<span class="n">prsn_stat</span> <span class="o">=</span> <span class="n">prsn</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span> <span class="o">=</span> <span class="s1">&#39;DJF&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_pandas</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sf_stat</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prsn_stat</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sf_stat</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">sf_stat</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">prsn_stat</span><span class="p">[</span><span class="mf">0.</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">levene</span><span class="p">(</span><span class="n">sf_stat</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">prsn_stat</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;ERA5&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sf</span><span class="p">),</span> <span class="n">sf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">sf</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">],</span> 
        <span class="p">[</span><span class="s1">&#39;CMIP6&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">prsn</span><span class="p">),</span> <span class="n">prsn</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">prsn</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">]]</span>
<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Group&quot;</span><span class="p">,</span> <span class="s2">&quot;Sample Size (n)&quot;</span><span class="p">,</span> <span class="s2">&quot;Average (X-bar)&quot;</span><span class="p">,</span>	<span class="s2">&quot;Standard deviation (s)&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Without doing any testing, we can see that the averages for ERA5 and CMIP6 in our samples are almost the same for snowfall. We start by calculating our test statistic. This difference in our samples estimates the difference between the population means for the two groups. This calculation begins with finding the difference between the two averages:</p>
<p><span class="math notranslate nohighlight">\(M = \overline X - \overline Y\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_mean</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">-</span> <span class="n">prsn</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">diff_mean</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we calculate the pooled standard deviation. This builds a combined estimate of the overall standard deviation. The estimate adjusts for different group sizes. First, we calculate the pooled variance:</p>
<p><span class="math notranslate nohighlight">\(s_p^2 = \displaystyle\frac{(n_1 - 1)* s_1^2 + (n_2 - 1)* s_2^2}{n_1 + n_2 -2} \)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var</span> <span class="o">=</span> <span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sf</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">prsn</span><span class="p">)</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">prsn</span><span class="o">.</span><span class="n">std</span><span class="p">()</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">prsn</span><span class="p">)</span> <span class="o">-</span><span class="mi">2</span><span class="p">)</span>
<span class="n">var</span>
</pre></div>
</div>
</div>
</div>
<p>Next, we take the square root of the pooled variance to get the pooled standard deviation.</p>
<p><span class="math notranslate nohighlight">\(s_p = \sqrt{s_p^2}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">var</span><span class="p">)</span>
<span class="n">std</span>
</pre></div>
</div>
</div>
</div>
<p>We now have all the pieces for our test statistic. We have the difference of the averages, the pooled standard deviation and the sample sizes.  We calculate our test statistic as follows:</p>
<p><span class="math notranslate nohighlight">\(t = \displaystyle\frac{\text{difference of group averages}}{\text{standard error of difference}}\)</span></p>
<p><span class="math notranslate nohighlight">\(t = \displaystyle\frac{M}{s_p * \sqrt{\frac{1}{m} + \frac{1}{n}}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">diff_mean</span><span class="o">/</span><span class="p">(</span><span class="n">std</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sf</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">prsn</span><span class="p">)))</span>
<span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<p>To evaluate the difference between the means in order to make a decision about our datasets, we compare the test statistic to a theoretical value from the t-distribution. This activity involves four steps:</p>
<ol class="arabic simple">
<li><p>We decide on the risk we are willing to take for declaring a significant difference. For the data, we decide that we are willing to take a 95% risk of saying that the unknown population means for ERA5 and CMIP6 are not equal when they really are. In statistics-speak, the significance level, denoted by <span class="math notranslate nohighlight">\(\alpha\)</span>, is set to 0.95. It is a good practice to make this decision before collecting the data and before calculating test statistics.</p></li>
<li><p>We calculate a test statistic. Our test statistic is 0.594 for snowfall.</p></li>
<li><p>We find the theoretical value from the t-distribution based on our null hypothesis which states that the means for ERA5 and CMIP6 are equal. Most statistics books have look-up tables for the t-distribution. You can also find tables online. The most likely situation is that you will use software and will not use printed tables.
To find this value, we need the significance level (<span class="math notranslate nohighlight">\(\alpha\)</span> = 0.95) and the degrees of freedom. The degrees of freedom (df) are based on the sample sizes of the two groups. For the snowfall data, this is:
<span class="math notranslate nohighlight">\(df = n_1 + n_2 - 2 = 718\)</span>
The t value with <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.95 and 718 degrees of freedom is .</p></li>
<li><p>We compare the value of our statistic (0.594) to the t value. Since t &gt; T, we reject the null hypothesis that the snowfall for ERA5 and CMIP6 are equal, and conclude that we have evidence snowfall in the population is different between ERA5 and CMIP6.</p></li>
</ol>
<section id="statistical-details">
<h4>Statistical details<a class="headerlink" href="#statistical-details" title="Permalink to this heading">#</a></h4>
<p>Let’s look at the snowfall data and the two-sample t-test using statistical terms.</p>
<ul class="simple">
<li><p>Our null hypothesis is that the underlying population means are the same. The null hypothesis is written as:
Ho: <span class="math notranslate nohighlight">\(\mu_1=\mu_2\)</span></p></li>
<li><p>The alternative hypothesis is that the means are not equal. This is written as:
Ho: <span class="math notranslate nohighlight">\(\mu_1 \neq \mu_2\)</span></p></li>
<li><p>We calculate the average for each group, and then calculate the difference between the two averages. This is written as:
<span class="math notranslate nohighlight">\(\overline x_1 - \overline x_2\)</span></p></li>
<li><p>We calculate the pooled standard deviation. This assumes that the underlying population variances are equal. The pooled variance formula is written as:
<span class="math notranslate nohighlight">\(s_p^2 = \displaystyle\frac{(n_1 - 1)* s_1^2 + (n_2 - 1)* s_2^2}{n_1 + n_2 -2} \)</span>
The formula shows the sample size for the first group as <span class="math notranslate nohighlight">\(n_1\)</span> and the second group as <span class="math notranslate nohighlight">\(n_2\)</span>. The standard deviations for the two groups are <span class="math notranslate nohighlight">\(s_1\)</span> and <span class="math notranslate nohighlight">\(s_2\)</span>. This estimate allows the two groups to have different numbers of observations. The pooled standard deviation is the square root of the variance and is written as <span class="math notranslate nohighlight">\(s_p\)</span>.</p></li>
</ul>
<p>What if your sample sizes for the two groups are the same? In this situation, the pooled estimate of variance is simply the average of the variances for the two groups:</p>
<p><span class="math notranslate nohighlight">\(s_p^2 = \displaystyle\frac{s_1^2 +  s_2^2}{2} \)</span></p>
<ul class="simple">
<li><p>The test statistic is calculated as:
<span class="math notranslate nohighlight">\(t = \displaystyle\frac{\overline x_1 - \overline x_2}{s_p * \sqrt{\frac{1}{n_1} + \frac{1}{n_2}}}\)</span></p></li>
</ul>
<p>The numerator of the test statistic is the difference between the two group averages. It estimates the difference between the two unknown population means. The denominator is an estimate of the standard error of the difference between the two unknown population means.</p>
<ul class="simple">
<li><p>We then compare the test statistic to a t value with our chosen alpha value and the degrees of freedom for our data. Using the snowfall data as an example, we set <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.95. The degrees of freedom (df) are based on the group sizes and are calculated as:
<span class="math notranslate nohighlight">\(df = n_1 + n_2 - 2 \)</span></p></li>
</ul>
<p>The formula shows the sample size for the first group as <span class="math notranslate nohighlight">\(n_1\)</span> and the second group as <span class="math notranslate nohighlight">\(n_2\)</span>. Statisticians write the t value with <span class="math notranslate nohighlight">\(\alpha\)</span> = 0.95 and 718 degrees of freedom as:
<span class="math notranslate nohighlight">\(t_{0.95,718}\)</span></p>
<p>There are two possible results from our comparison:</p>
<ul class="simple">
<li><p>The test statistic is lower than the t value. You fail to reject the hypothesis of equal means. You conclude that the data support the assumption that the ERA5 and CMIP6 have the same average snowfall.</p></li>
<li><p>The test statistic is higher than the t value. You reject the hypothesis of equal means. You do not conclude that ERA5 and CMIP6 have the same average snowfall</p></li>
</ul>
<p><a class="reference external" href="https://www.jmp.com/en_ch/statistics-knowledge-portal/t-test/two-sample-t-test.html">Taken from the statisitcs knowledge portal</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="c1"># snowfall (ERA5)</span>
<span class="n">_sf</span> <span class="o">=</span> <span class="n">era</span><span class="o">.</span><span class="n">sf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mi">1000</span>

<span class="c1"># snowfall (CMIP6)</span>
<span class="n">_prsn</span> <span class="o">=</span> <span class="n">cmip</span><span class="o">.</span><span class="n">prsn</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">*</span><span class="mi">86400</span>

<span class="n">_stat</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">_sf</span><span class="p">,</span> <span class="n">_prsn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Before the t-test can be conducted, one needs to test the assumptions. First to test for the homogeneity of variances. To do this, I will use Levene’s test for homogeneity of variance. The method to conduct this test is stats.levene().</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">levene</span><span class="p">(</span><span class="n">_sf</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">_prsn</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Next to test the assumption of normality. This can be done visually with a histogram and/or as a q-q plot, and by using the Shapiro-Wilk test which is the stats.shaprio() method. First, I will check them visually.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_sf</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_prsn</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">_sf</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span> <span class="n">plt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">probplot</span><span class="p">(</span><span class="n">_prsn</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">flatten</span><span class="p">(),</span> <span class="n">dist</span><span class="o">=</span><span class="s2">&quot;norm&quot;</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span> <span class="n">plt</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>To be sure, we can test it statistically using the Shapiro-Wilk test for normality which is the stats.shaprio() method. Unfortunately the output is not labeled. The first value is the W test statistic and the second value is the p-value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">_sf</span><span class="p">),</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">_prsn</span><span class="p">))</span> 
</pre></div>
</div>
</div>
</div>
<p>Neither of the tests for normality we significant meaning neither of the variables violates the assumption of normality. We can continue as planned. To conduct the Independent t-test, one needs to use the stats.ttest_ind() method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">_sf</span><span class="p">,</span> <span class="n">_prsn</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;season&#39;</span><span class="p">])</span>
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span>
<span class="n">s_std</span> <span class="o">=</span> <span class="n">diff</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s1">&#39;season&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">mean_diff</span><span class="o">/</span> <span class="p">(</span><span class="n">s_std</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">T</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">.95</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig_map</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">T</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig_map</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Source: Modern Mathematical Statistics with Applications by Devore &amp; Berk</span>
<span class="sd">    Assumptions:</span>
<span class="sd">    - data consists of independently selected pairs (X1,Y1)</span>
<span class="sd">    - Di=Xi-Yi are assumed to be normally distributed.</span>
<span class="sd">    :param da1:</span>
<span class="sd">    :param da2:</span>
<span class="sd">    :param avg_dim:</span>
<span class="sd">    :param ci:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">da1</span> <span class="o">-</span> <span class="n">da2</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">D</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="n">avg_dim</span><span class="p">])</span>
    <span class="n">mean_D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">avg_dim</span><span class="p">)</span>
    <span class="c1"># sample std:</span>
    <span class="c1"># population std= sqrt(sum((xi-mu)^2)/n)</span>
    <span class="c1"># sample std =  sqrt(sum((xi-mu)^2)/(n-1))</span>
    <span class="c1"># sample std = (population std)*(sqrt(n/(n-1))</span>
    <span class="n">s_std</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">avg_dim</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">mean_D</span> <span class="o">/</span> <span class="p">(</span><span class="n">s_std</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="c1"># for small samples (&lt;50) we use t-statistics</span>
    <span class="c1"># n = 9, degree of freedom = 9-1 = 8</span>
    <span class="c1"># for 99% confidence interval, alpha = 1% = 0.01 and alpha/2 = 0.005</span>
    <span class="n">T</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">t</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">((</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ci</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">),</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># 99% CI, t8,0.005</span>
    <span class="n">sig_map</span> <span class="o">=</span> <span class="p">(</span><span class="n">t</span> <span class="o">&gt;</span> <span class="n">T</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">t</span> <span class="o">&lt;</span> <span class="o">-</span><span class="n">T</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">T</span><span class="p">,</span> <span class="n">sig_map</span><span class="p">,</span> <span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_stat</span><span class="o">.</span><span class="n">statistic</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mask_jja</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> 
                         <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> 
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="n">axsm</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span><span class="n">cmip</span><span class="o">.</span><span class="n">lon</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">cmip</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">_t</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">hatch</span><span class="o">=</span><span class="s1">&#39;xxx&#39;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">100000</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.0</span> <span class="p">,</span><span class="n">transform</span> <span class="o">=</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_stat</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">diff</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span><span class="c1">#.where(diff &gt;= 0.95).plot()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">hatch_area</span><span class="p">(</span><span class="n">TF</span><span class="p">,</span><span class="n">ax</span><span class="p">,</span> <span class="n">hatches</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">hatch_lw</span> <span class="o">=</span> <span class="mf">.5</span><span class="p">,</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;hatch.linewidth&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">hatch_lw</span>
    <span class="k">if</span> <span class="n">reverse</span><span class="p">:</span>
        <span class="n">TF</span><span class="o">=~</span><span class="n">TF</span>
    <span class="k">if</span> <span class="n">hatches</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">hatches</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;....&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">TF</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lev&#39;</span><span class="p">}:</span>
        <span class="n">x_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="o">.</span><span class="n">lat</span>
        <span class="n">y_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="o">.</span><span class="n">lev</span>
    <span class="k">elif</span> <span class="nb">set</span><span class="p">(</span><span class="n">TF</span><span class="o">.</span><span class="n">dims</span><span class="p">)</span><span class="o">==</span><span class="p">{</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span><span class="s1">&#39;lon&#39;</span><span class="p">}:</span>
        <span class="n">x_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="o">.</span><span class="n">lon</span>
        <span class="n">y_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="o">.</span><span class="n">lat</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">x_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="p">[</span><span class="n">TF</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">y_coord</span> <span class="o">=</span> <span class="n">TF</span><span class="p">[</span><span class="n">TF</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>

    <span class="c1">#ax.contourf( x_coord,y_coord, TF.where(TF), hatches=hatches, transform=transform, alpha=0, extend=&#39;both&#39;)</span>
    <span class="n">plt_kwgs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hatch</span><span class="o">=</span><span class="n">hatches</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">rasterized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">transform</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt_kwgs</span><span class="p">[</span><span class="s1">&#39;transform&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">transform</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">pcolor</span><span class="p">(</span> <span class="n">x_coord</span><span class="p">,</span><span class="n">y_coord</span><span class="p">,</span> <span class="n">TF</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">TF</span><span class="p">),</span> <span class="o">**</span><span class="n">plt_kwgs</span><span class="p">)</span><span class="c1">#hatch=hatches[0],rasterized=True, transform=transform, alpha=0)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span># T_star_jja: T_star data on lon/lat grid
# make a mask of lon/lat cells following your significance criteria (in my case data_jja (also on the same lon/lat grid) is below 6)
mask_jja = np.ma.masked_less(data_jja, 6.0)# plotting on a polar plot of your data
cs = plt_var_polar(fig, axs[0], lon2d, lat2d, T_star_jja, ‘T_star JJA’, ‘N’, discrete_cmap(16, cm_crameri.oslo), vmin = 238, vmax = 270, n_cmap = 16)# overlay the hatching of the not significant data
cs2 = axs[0].pcolor(lon2d-2.5, lat2d-2.5, mask_jja, hatch=‘xxx’, color = ‘k’, zorder = 100000, alpha=0.0 ,transform = ccrs.PlateCarree())
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./CMIP6_ERA5_CloudSat"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../ERA5/ERA5_1985-2014.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Example with ERA5 high-resolution (~0.25deg) monthly means</p>
      </div>
    </a>
    <a class="right-next"
       href="../cmip/CMIP6_hr_1985-2014.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Example with CMIP6 models (100 - 500 km)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Analysis of CMIP6, ERA5, and CloudSat</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#table-of-contents">Table of Contents</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-a-id-introduction-a">1. Introduction <a id="introduction"></a></a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">2. Data Wrangling <a id="data_wrangling"></a></a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#organize-my-data">Organize my data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#import-python-packages">Import python packages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#open-variables">Open variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistics">Statistics</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-difference-between-era5-and-cmip6-model-mean">Plot the difference between ERA5 and CMIP6 model mean</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-difference-between-era5-and-the-model-with-positive-negative-bias">Plot difference between ERA5 and the model with positive/negative bias</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#max">MAX</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#min">MIN</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#individual-model">Individual model</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-the-seasonal-mean-zonally">Plot the seasonal mean zonally</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-global-mean-of-cmip6-and-era5-literature-values">Plot global mean of CMIP6 and ERA5, literature values</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#south-of-30-deg">South of 30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#north-of-30-deg">North of 30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#global-30n-s">Global, 30N/S</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-iwp-vs-snowfall-for-when-snowfall-occurs-rightarrow-snowfall-0">Plot IWP vs. snowfall for when snowfall occurs <span class="math notranslate nohighlight">\(\rightarrow\)</span> snowfall&gt;0</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">South of -30 deg</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">North of 30 deg</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#calculate-linear-regression-and-create-dataset-from-latitudes">Calculate linear regression and create dataset from latitudes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#table-with-regression-values">Table with regression values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-iwp-snowfall-scatter-with-regression-lines">Plot IWP-snowfall scatter with regression lines</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#difference-era5-cmip6-model-mean">Difference ERA5 - CMIP6 model mean</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hypothesis">Hypothesis</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#assumptions">Assumptions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-details">Statistical details</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Franziska Hellmuth
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2022.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>