
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog &#8212; globalsnow</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cloudsat" href="../cloudsat.html" />
    <link rel="prev" title="Analysis of CMIP6, ERA5, and CloudSat" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">globalsnow</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Global Snow project website
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../ERA5/ERA5_1985-2014.html">
   Example with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html">
   Analysis of CMIP6, ERA5, and CloudSat
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cloudsat.html">
   Cloudsat
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../CloudSat/get_pressure_grid.html">
     Example to get CloudSat mean pressure level profile
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/franzihe/CloudSat_ERA5_CMIP6_analysis/main?urlpath=tree/work/cmip/CMIP6_hr_1985-2014.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis/issues/new?title=Issue%20on%20page%20%2Fcmip/CMIP6_hr_1985-2014.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/cmip/CMIP6_hr_1985-2014.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-cmip6-online-catalog">
     Open CMIP6 online catalog
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#search-corresponding-data">
     Search corresponding data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-found">
     Create dictionary from the list of datasets we found
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calendar">
     Calendar
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#show-attributes-and-individual-identifier">
     Show attributes and individual identifier
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assign-attributes-to-the-variables">
     Assign attributes to the variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolate-from-cmip6-hybrid-sigma-pressure-levels-to-era5-isobaric-pressure-levels">
     Interpolate from CMIP6 hybrid sigma-pressure levels to ERA5 isobaric pressure levels
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-cmip6-data-to-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid CMIP6 data to NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connect-all-models-into-one-dataset-with-new-coordinate-model">
     Connect all models into one Dataset with new coordinate ‘model’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supercooled-liquid-water-fraction">
     Supercooled liquid water fraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistics">
     Statistics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
     Create dictionary from the list of datasets we want to use for the IWC/LWC statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-seasonal-mean-of-all-regridded-models">
     Create seasonal mean of all regridded models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-model-mean-spread-of-seasonal-mean-of-all-regridded-models">
     Create model mean/spread of seasonal mean of all regridded models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-a-id-references-a">
   References
   <a id="references">
   </a>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-cmip6-online-catalog">
     Open CMIP6 online catalog
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#search-corresponding-data">
     Search corresponding data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-found">
     Create dictionary from the list of datasets we found
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calendar">
     Calendar
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#show-attributes-and-individual-identifier">
     Show attributes and individual identifier
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#assign-attributes-to-the-variables">
     Assign attributes to the variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolate-from-cmip6-hybrid-sigma-pressure-levels-to-era5-isobaric-pressure-levels">
     Interpolate from CMIP6 hybrid sigma-pressure levels to ERA5 isobaric pressure levels
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-cmip6-data-to-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid CMIP6 data to NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#connect-all-models-into-one-dataset-with-new-coordinate-model">
     Connect all models into one Dataset with new coordinate ‘model’
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#supercooled-liquid-water-fraction">
     Supercooled liquid water fraction
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#statistics">
     Statistics
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
     Create dictionary from the list of datasets we want to use for the IWC/LWC statistics
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-seasonal-mean-of-all-regridded-models">
     Create seasonal mean of all regridded models
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-model-mean-spread-of-seasonal-mean-of-all-regridded-models">
     Create model mean/spread of seasonal mean of all regridded models
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-a-id-references-a">
   References
   <a id="references">
   </a>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="example-with-high-resolution-cmip6-models-100-km-using-pangeo-catalog">
<h1>Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog<a class="headerlink" href="#example-with-high-resolution-cmip6-models-100-km-using-pangeo-catalog" title="Permalink to this headline">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h1>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#data_wrangling">2. Data Wrangling</a></li>
<li><a href="#exploratory">3. Exploratory Data Analysis</a></li>
<li><a href="#conclusion">4. Conclusion</a></li>
<li><a href="#references">5. References</a></li>
</ul>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-a-id-introduction-a">
<h1>1. Introduction <a id='introduction'></a><a class="headerlink" href="#introduction-a-id-introduction-a" title="Permalink to this headline">#</a></h1>
<p>Cloud feedbacks are a major contributor to the spread of climate sensitivity in global climate models (GCMs) <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019GL085782">Zelinka et al. (2020)</a>. Among the most poorly understood cloud feedbacks is the one associated with the cloud phase, which is expected to be modified with climate change <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1">Bjordal et al. (2020)</a>. Cloud phase bias, in addition, has significant implications for the simulation of radiative properties and glacier and ice sheet mass balances in climate models.</p>
<p>In this context, this work aims to expand our knowledge on how the representation of the cloud phase affects snow formation in GCMs. Better understanding this aspect is necessary to develop climate models further and improve future climate predictions.</p>
<ul class="simple">
<li><p>Retrieve CMIP6 data through <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/">Pangeo</a></p></li>
<li><p>Hybrid sigma-pressure coordinates to isobaric pressure levels of the European Centre for Medium-Range Weather Forecast Re-Analysis 5 (ERA5) with <a class="reference external" href="https://geocat-comp.readthedocs.io/en/latest/index.html">GeoCAT-comb</a></p></li>
<li><p>Regridd the CMIP6 variables to the exact horizontal resolution with <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">xesmf</span></code></a></p></li>
<li><p>Calculate an ensemble mean of all used models</p></li>
<li><p>Calculate and plot the seasonal mean of the ensemble mean</p></li>
</ul>
<p><strong>Questions</strong></p>
<ul class="simple">
<li><p>How is the cloud phase and snowfall varying between 1985 and 2014?</p></li>
</ul>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> We answer questions related to the comparison of CMIP models to ERA5 in another <a class="reference internal" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html"><span class="doc std std-doc">Jupyter Notebook</span></a>.</p>
</div></blockquote>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-a-id-data-wrangling-a">
<h1>2. Data Wrangling <a id='data_wrangling'></a><a class="headerlink" href="#data-wrangling-a-id-data-wrangling-a" title="Permalink to this headline">#</a></h1>
<p>This study will compare surface snowfall, ice, and liquid water content from the Coupled Model Intercomparison Project Phase 6 (<a class="reference external" href="https://esgf-node.llnl.gov/projects/cmip6/">CMIP6</a>) climate models (accessed through <a class="reference external" href="https://pangeo.io/">Pangeo</a>) to the European Centre for Medium-Range Weather Forecast Re-Analysis 5 (<a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5</a>) data from <strong>1985 to 2014</strong>. We conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) in the CMIP6 models and their potential connection between them.</p>
<ul class="simple">
<li><p>Time period: 1985 to 2014</p></li>
<li><p>horizonal resolution: ~100km</p></li>
<li><p>time resolution: monthly atmospheric data (Amon, AERmon)</p></li>
<li><p>Variables:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>shortname</p></th>
<th class="text-align:center head"><p>Long name</p></th>
<th class="text-align:right head"><p>Units</p></th>
<th class="text-align:right head"><p>levels</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>prsn</p></td>
<td class="text-align:center"><p>Snowfall Flux</p></td>
<td class="text-align:right"><p>[kg m-2 s-1]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>clw</p></td>
<td class="text-align:center"><p>Mass Fraction of Cloud Liquid Water</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>ml</p></td>
</tr>
<tr class="row-even"><td><p>cli</p></td>
<td class="text-align:center"><p>Mass Fraction of Cloud Ice</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>ml</p></td>
</tr>
<tr class="row-odd"><td><p>tas</p></td>
<td class="text-align:center"><p>Near-Surface Air Temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-even"><td><p>ta</p></td>
<td class="text-align:center"><p>Air Temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>plev</p></td>
</tr>
<tr class="row-odd"><td><p>clivi</p></td>
<td class="text-align:center"><p>Ice Water Path</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p></p></td>
</tr>
<tr class="row-even"><td><p>lwp</p></td>
<td class="text-align:center"><p>Liquid Water Path</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p></p></td>
</tr>
<tr class="row-odd"><td><p>pr</p></td>
<td class="text-align:center"><p>Precipitation</p></td>
<td class="text-align:right"><p>[kg m-2 s-1]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>CMIP6 models:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Institution</p></th>
<th class="text-align:center head"><p>Model name</p></th>
<th class="text-align:right head"><p>Reference</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://www.rcec.sinica.edu.tw/index_en.php">AS-RCEC</a></p></td>
<td class="text-align:center"><p>TaiESM1</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi.org/10.5194/gmd-13-3887-2020">Lee et al. (2020)</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://bcc.ncc-cma.net/">BCC</a></p></td>
<td class="text-align:center"><p>BCC-CSM2-M</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi.org/10.5194/gmd-12-1573-2019">Wu et al. (2019)</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="http://www.cma.gov.cn/en2014/">CAMS</a></p></td>
<td class="text-align:center"><p>CAMS-CSM1-0</p></td>
<td class="text-align:right"><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://english.iap.cas.cn/">CAS</a></p></td>
<td class="text-align:center"><p>FGOALS-f3-L</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1080/16742834.2020.1778419">Bian et al. (2020)</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://www.cmcc.it/">CMCC</a></p></td>
<td class="text-align:center"><p>CMCC-CM2-SR5</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2018MS001369">Cherchi et al. (2019)</a></p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td class="text-align:center"><p>CMCC-CM2-HR4</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2018MS001369">Cherchi et al. (2019)</a></p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td class="text-align:center"><p>CMCC-ESM2</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://www.cmcc.it/models/cmcc-esm-earth-system-model">CMCC website</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="http://www.ec-earth.org/">EC-Earth-Consortium</a></p></td>
<td class="text-align:center"><p>EC-Earth3-AerChem</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi.org/10.5194/gmd-14-5637-2021">van Noije et al. (2021)</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://e3sm.org/">E3SM-Project</a></p></td>
<td class="text-align:center"><p>E3SM-1-1</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2018MS001603">Golaz et al. (2019)</a>; <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS001766">Burrows et al. (2020)</a> Text S8</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td class="text-align:center"><p>E3SM-1-1-ECA</p></td>
<td class="text-align:right"><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://mpimet.mpg.de/en/homepage">MPI-M</a></p></td>
<td class="text-align:center"><p>MPI-ESM1-2-HR</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2017MS001217">Müller et al. (2018)</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://www.mri-jma.go.jp/index_en.html">MRI</a></p></td>
<td class="text-align:center"><p>MRI-ESM2-0</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi.org/10.2151/jmsj.2019-051">Yukimoto et al. (2019)</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://folk.uib.no/ngfhd/EarthClim/index.htm">NCC</a></p></td>
<td class="text-align:center"><p>NorESM2-MM</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi.org/10.5194/gmd-13-6165-2020">Seland et al. (2020)</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://www.gfdl.noaa.gov/">NOAA-GFDL</a></p></td>
<td class="text-align:center"><p>GFDL-CM4</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS001829">Held et al. (2019)</a></p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td class="text-align:center"><p>GFDL-ESM4</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS002015">Dunne et al. (2020)</a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://en.snu.ac.kr/index.html">SNU</a></p></td>
<td class="text-align:center"><p>SAM0-UNICON</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1175/JCLI-D-18-0796.1">Park et al. (2019)</a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://www.tsinghua.edu.cn/en/">THU</a></p></td>
<td class="text-align:center"><p>CIESM</p></td>
<td class="text-align:right"><p><a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS002036">Lin et al. (2020)</a></p></td>
</tr>
</tbody>
</table>
<section id="organize-my-data">
<h2>Organize my data<a class="headerlink" href="#organize-my-data" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Define a prefix for my project (you may need to adjust it for your own usage on your infrastructure).</p>
<ul>
<li><p>input folder where all the data used as input to my Jupyter Notebook is stored (and eventually shared)</p></li>
<li><p>output folder where all the results to keep are stored</p></li>
<li><p>tool folder where all the tools</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>

<span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<span class="n">WORKDIR</span> <span class="o">=</span> <span class="n">abs_path</span><span class="p">[:</span><span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>


<span class="k">if</span> <span class="s2">&quot;mimi&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/scratch/franzihe/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&quot;</span>
<span class="k">elif</span> <span class="s2">&quot;glefsekaldt&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span> 
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Data/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Documents/Figures/CMIP6/&quot;</span>

<span class="n">INPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">OUTPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="n">UTILS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR</span><span class="p">,</span> <span class="s1">&#39;utils&#39;</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UTILS_DIR</span><span class="p">)</span>
<span class="c1"># make figure directory</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">FIG_DIR</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mimi.uio.no
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-python-packages">
<h2>Import python packages<a class="headerlink" href="#import-python-packages" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Python</span></code> environment requirements: file <span class="xref myst">requirements_globalsnow.txt</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">python</span></code> packages from <span class="xref myst">imports.py</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">functions</span></code> from <span class="xref myst">functions.py</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># import packages</span>
<span class="kn">from</span> <span class="nn">imports</span> <span class="kn">import</span> <span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">intake</span><span class="p">,</span> <span class="n">cftime</span><span class="p">,</span> <span class="n">xe</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">pd</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span><span class="n">ccrs</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">da</span><span class="p">,</span> <span class="n">gc</span><span class="p">)</span>
<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">display_style</span><span class="o">=</span><span class="s2">&quot;html&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.core.options.set_options at 0x7f88637add00&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-cmip6-online-catalog">
<h2>Open CMIP6 online catalog<a class="headerlink" href="#open-cmip6-online-catalog" title="Permalink to this headline">#</a></h2>
<p>… by using <code class="docutils literal notranslate"><span class="pre">intake</span></code> from <a class="reference external" href="https://gallery.pangeo.io/repos/pangeo-data/pangeo-tutorial-gallery/intake.html">pangeo.io</a>, specifically <code class="docutils literal notranslate"><span class="pre">intake-esm</span></code>.</p>
<p>An example on <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html#loading-an-esm-collection">Loading an ESM collection</a> and <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html#searching-for-datasets">searching for datasets</a> can also be found on the <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html">Pangeo / ESGF Cloud Data Working Group documentation</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_url</span> <span class="o">=</span> <span class="s2">&quot;https://storage.googleapis.com/cmip6/pangeo-cmip6.json&quot;</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="n">cat_url</span><span class="p">)</span>
<span class="n">col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><p><strong>pangeo-cmip6 catalog with 7674 dataset(s) from 514818 asset(s)</strong>:</p> <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>activity_id</th>
      <td>18</td>
    </tr>
    <tr>
      <th>institution_id</th>
      <td>36</td>
    </tr>
    <tr>
      <th>source_id</th>
      <td>88</td>
    </tr>
    <tr>
      <th>experiment_id</th>
      <td>170</td>
    </tr>
    <tr>
      <th>member_id</th>
      <td>657</td>
    </tr>
    <tr>
      <th>table_id</th>
      <td>37</td>
    </tr>
    <tr>
      <th>variable_id</th>
      <td>700</td>
    </tr>
    <tr>
      <th>grid_label</th>
      <td>10</td>
    </tr>
    <tr>
      <th>zstore</th>
      <td>514818</td>
    </tr>
    <tr>
      <th>dcpp_init_year</th>
      <td>60</td>
    </tr>
    <tr>
      <th>version</th>
      <td>736</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="search-corresponding-data">
<h2>Search corresponding data<a class="headerlink" href="#search-corresponding-data" title="Permalink to this headline">#</a></h2>
<p>Get the data required for the analysis. Define variables, models, experiment, and time resolution as defined in <a href="#data_wrangling">2. Data Wrangling</a>
.</p>
<ul class="simple">
<li><p>use member_id = ‘r1i1p1f1’.</p></li>
<li><p>using intake-esm’s <code class="docutils literal notranslate"><span class="pre">search()</span></code> function:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">col.search(variable_id,</span> <span class="pre">source_id,</span> <span class="pre">experiment_id,</span> <span class="pre">table_id,</span> <span class="pre">member_id,</span> <span class="pre">institution_id,</span> <span class="pre">grid_label)</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Variables</span>
<span class="n">variable_id</span><span class="o">=</span><span class="p">[</span>
            <span class="c1"># &#39;cli&#39;,</span>
            <span class="s1">&#39;clivi&#39;</span><span class="p">,</span>
            <span class="c1"># &#39;clw&#39;,</span>
            <span class="s1">&#39;lwp&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pr&#39;</span><span class="p">,</span>
            <span class="s1">&#39;prsn&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ta&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;tas&#39;</span>
             <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## Models</span>
<span class="n">list_models</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;NorESM2-MM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;TaiESM1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;EC-Earth3-AerChem&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GFDL-ESM4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SAM0-UNICON&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CAMS-CSM1-0&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CMCC-CM2-HR4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MPI-ESM1-2-HR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;BCC-CSM2-MR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;E3SM-1-1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CMCC-CM2-SR5&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CMCC-ESM2&#39;</span><span class="p">,</span>
    <span class="s1">&#39;FGOALS-f3-L&#39;</span><span class="p">,</span>
    <span class="s1">&#39;E3SM-1-1-ECA&#39;</span><span class="p">,</span>
    <span class="s1">&#39;CIESM&#39;</span><span class="p">,</span>
    <span class="s1">&#39;GFDL-CM4&#39;</span><span class="p">,</span>
    <span class="s1">&#39;MRI-ESM2-0&#39;</span><span class="p">]</span>  
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## experiment</span>
<span class="n">experiment_id</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;historical&#39;</span><span class="p">]</span>

<span class="c1">## time resolution</span>
<span class="n">t_res</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Amon&#39;</span><span class="p">,</span> <span class="s1">&#39;AERmon&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## search for variables, models, ...</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">variable_id</span><span class="o">=</span><span class="n">variable_id</span><span class="p">,</span> <span class="n">source_id</span><span class="o">=</span><span class="n">list_models</span><span class="p">,</span> <span class="n">experiment_id</span><span class="o">=</span><span class="n">experiment_id</span><span class="p">,</span> <span class="n">table_id</span> <span class="o">=</span> <span class="n">t_res</span><span class="p">,</span> <span class="n">member_id</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r1i1p1f1&#39;</span><span class="p">])</span>
<span class="c1"># cat.df</span>
<span class="c1">## show the CMIP6 models found in pandas Dataframe </span>
<span class="n">cat</span><span class="o">.</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;source_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;GFDL-CM4&#39;, &#39;BCC-CSM2-MR&#39;, &#39;MRI-ESM2-0&#39;, &#39;SAM0-UNICON&#39;,
       &#39;CAMS-CSM1-0&#39;, &#39;MPI-ESM1-2-HR&#39;, &#39;GFDL-ESM4&#39;, &#39;FGOALS-f3-L&#39;,
       &#39;NorESM2-MM&#39;, &#39;E3SM-1-1&#39;, &#39;E3SM-1-1-ECA&#39;, &#39;CIESM&#39;, &#39;CMCC-CM2-SR5&#39;,
       &#39;TaiESM1&#39;, &#39;EC-Earth3-AerChem&#39;, &#39;CMCC-CM2-HR4&#39;, &#39;CMCC-ESM2&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-dictionary-from-the-list-of-datasets-we-found">
<h2>Create dictionary from the list of datasets we found<a class="headerlink" href="#create-dictionary-from-the-list-of-datasets-we-found" title="Permalink to this headline">#</a></h2>
<p>Load the found datasets into xarray dataset containers using intake-esm’s <code class="docutils literal notranslate"><span class="pre">to_dataset_dict()</span></code> function, which yields a Python dictionary.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> This step may take several minutes so be patient!</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dset_dict</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span><span class="n">zarr_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_cftime&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;activity_id.institution_id.source_id.experiment_id.table_id.grid_label&#39;
</pre></div>
</div>
<div class="output text_html">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='21' class='' max='21' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [21/21 00:11<00:00]
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># list all merged datasets and show coordinates</span>
<span class="k">for</span> <span class="n">keys</span><span class="p">,</span> <span class="n">ds</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">dims</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CMIP.NCC.NorESM2-MM.historical.AERmon.gn: [&#39;lat&#39;, &#39;bnds&#39;, &#39;lon&#39;, &#39;member_id&#39;, &#39;time&#39;]
CMIP.AS-RCEC.TaiESM1.historical.AERmon.gn: [&#39;lat&#39;, &#39;bnds&#39;, &#39;lon&#39;, &#39;member_id&#39;, &#39;time&#39;]
CMIP.EC-Earth-Consortium.EC-Earth3-AerChem.historical.AERmon.gr: [&#39;lat&#39;, &#39;bnds&#39;, &#39;lon&#39;, &#39;member_id&#39;, &#39;time&#39;]
CMIP.NOAA-GFDL.GFDL-ESM4.historical.AERmon.gr1: [&#39;bnds&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;member_id&#39;, &#39;time&#39;]
CMIP.CAMS.CAMS-CSM1-0.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.SNU.SAM0-UNICON.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.E3SM-Project.E3SM-1-1.historical.Amon.gr: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.CAS.FGOALS-f3-L.historical.Amon.gr: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.E3SM-Project.E3SM-1-1-ECA.historical.Amon.gr: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.CMCC.CMCC-CM2-SR5.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.MRI.MRI-ESM2-0.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.NOAA-GFDL.GFDL-CM4.historical.Amon.gr1: [&#39;bnds&#39;, &#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;plev&#39;]
CMIP.MPI-M.MPI-ESM1-2-HR.historical.Amon.gn: [&#39;time&#39;, &#39;member_id&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.BCC.BCC-CSM2-MR.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.THU.CIESM.historical.Amon.gr: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.CMCC.CMCC-ESM2.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.CMCC.CMCC-CM2-HR4.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.NOAA-GFDL.GFDL-ESM4.historical.Amon.gr1: [&#39;bnds&#39;, &#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;plev&#39;]
CMIP.EC-Earth-Consortium.EC-Earth3-AerChem.historical.Amon.gr: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.AS-RCEC.TaiESM1.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
CMIP.NCC.NorESM2-MM.historical.Amon.gn: [&#39;member_id&#39;, &#39;time&#39;, &#39;lat&#39;, &#39;lon&#39;, &#39;bnds&#39;, &#39;plev&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="calendar">
<h2>Calendar<a class="headerlink" href="#calendar" title="Permalink to this headline">#</a></h2>
<p>Not all models in CMIP6 use the same calendar. Hence we double check the time axis. Later, when we regrid to the same horizontal resolution (<a href="#regrid_hz">Regrid CMIP6 data</a>) we will assign the same calendars for each model.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># metadata of the historical run:</span>
<span class="n">_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">([</span><span class="s2">&quot;calendar&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;branch_time_in_parent&quot;</span><span class="p">,</span> <span class="c1">#&quot;parent_activity_id&quot;, &quot;parent_experiment_id&quot;,	&quot;parent_mip_era&quot;,</span>
                 <span class="s2">&quot;parent_source_id&quot;</span><span class="p">,</span><span class="c1">#&quot;parent_sub_experiment_id&quot;, </span>
                 <span class="s2">&quot;parent_time_units&quot;</span><span class="p">,</span><span class="c1"># &quot;parent_variant_label&quot;</span>
                  <span class="p">])</span>
<span class="n">_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">_d2</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="s1">&#39;index&#39;</span><span class="p">})</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">_names</span> <span class="o">=</span><span class="p">[]</span>
    <span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">to_index</span><span class="p">()</span><span class="o">.</span><span class="n">calendar</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">dset_dict</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        
        <span class="k">if</span> <span class="s1">&#39;parent_time_units&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;branch_time_in_parent&#39;</span> <span class="ow">in</span> <span class="n">k</span> <span class="ow">or</span> <span class="s1">&#39;parent_source_id&#39;</span> <span class="ow">in</span> <span class="n">k</span><span class="p">:</span>
            <span class="n">_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="n">_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
    <span class="n">_d2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">_d2</span><span class="p">,</span>   <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">_data</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">_d2</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_d2</span> <span class="o">=</span> <span class="n">_d2</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
<span class="n">_d2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">_d2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;parent_source_id&#39;</span><span class="p">]</span>
<span class="n">_d2</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;parent_source_id&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>index</th>
      <th>calendar</th>
      <th>branch_time_in_parent</th>
      <th>parent_time_units</th>
    </tr>
    <tr>
      <th>parent_source_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NorESM2-MM</th>
      <td>noleap</td>
      <td>438000.0</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>TaiESM1</th>
      <td>noleap</td>
      <td>171550.0</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>EC-Earth3-AerChem</th>
      <td>proleptic_gregorian</td>
      <td>0.0</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>GFDL-ESM4</th>
      <td>noleap</td>
      <td>36500.0</td>
      <td>days since 0001-1-1</td>
    </tr>
    <tr>
      <th>3025.0</th>
      <td>noleap</td>
      <td>CAMS-CSM1-0</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>99645.0</th>
      <td>noleap</td>
      <td>SAM0-UNICON</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>noleap</td>
      <td>E3SM-1-1</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>12345.0</th>
      <td>noleap</td>
      <td>FGOALS-f3-L</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>noleap</td>
      <td>E3SM-1-1-ECA</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>noleap</td>
      <td>CMCC-CM2-SR5</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>proleptic_gregorian</td>
      <td>MRI-ESM2-0</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>36500.0</th>
      <td>noleap</td>
      <td>GFDL-CM4</td>
      <td>days since 0001-1-1</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>proleptic_gregorian</td>
      <td>MPI-ESM1-2-HR</td>
      <td>days since 1850-1-1 00:00:00</td>
    </tr>
    <tr>
      <th>2289.0</th>
      <td>noleap</td>
      <td>BCC-CSM2-MR</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>182500.0</th>
      <td>noleap</td>
      <td>CIESM</td>
      <td>days since 0001-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>noleap</td>
      <td>CMCC-ESM2</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>noleap</td>
      <td>CMCC-CM2-HR4</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>36500.0</th>
      <td>noleap</td>
      <td>GFDL-ESM4</td>
      <td>days since 0001-1-1</td>
    </tr>
    <tr>
      <th>0.0</th>
      <td>proleptic_gregorian</td>
      <td>EC-Earth3-AerChem</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>171550.0</th>
      <td>noleap</td>
      <td>TaiESM1</td>
      <td>days since 1850-01-01</td>
    </tr>
    <tr>
      <th>438000.0</th>
      <td>noleap</td>
      <td>NorESM2-MM</td>
      <td>days since 0001-01-01</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="show-attributes-and-individual-identifier">
<h2>Show attributes and individual identifier<a class="headerlink" href="#show-attributes-and-individual-identifier" title="Permalink to this headline">#</a></h2>
<p>NorESM2-MM is going to be the reference model for the horizontal grid. The <code class="docutils literal notranslate"><span class="pre">xarray</span></code> datasets inside <code class="docutils literal notranslate"><span class="pre">dset_dict</span></code> can be extracted as any value in a Python dictionary.</p>
<p>The dictonary key for NorESM2-MM is: <strong><a class="reference external" href="http://CMIP.NCC.NorESM2-MM.historical.Amon.gn">CMIP.NCC.NorESM2-MM.historical.Amon.gn</a></strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;lwp&#39;</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;CMIP.NCC.NorESM2-MM.historical.AERmon.gn&#39;</span><span class="p">]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">dset_dict</span><span class="p">[</span><span class="s1">&#39;CMIP.NCC.NorESM2-MM.historical.Amon.gn&#39;</span><span class="p">]</span>
    

<span class="c1">## attributes of the xarray dataset </span>
<span class="n">ds</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">attrs</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;tracking_id&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>({&#39;cell_measures&#39;: &#39;area: areacella&#39;,
  &#39;cell_methods&#39;: &#39;area: time: mean&#39;,
  &#39;comment&#39;: &#39;mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.&#39;,
  &#39;history&#39;: &quot;2019-11-25T21:51:40Z altered by CMOR: Converted units from &#39;kg/m2&#39; to &#39;kg m-2&#39;. 2019-11-25T21:51:40Z altered by CMOR: Converted type from &#39;d&#39; to &#39;f&#39;.&quot;,
  &#39;long_name&#39;: &#39;Ice Water Path&#39;,
  &#39;original_name&#39;: &#39;TGCLDIWP&#39;,
  &#39;original_units&#39;: &#39;kg/m2&#39;,
  &#39;standard_name&#39;: &#39;atmosphere_mass_content_of_cloud_ice&#39;,
  &#39;units&#39;: &#39;kg m-2&#39;},
 &#39;hdl:21.14100/4576a6a4-21eb-401f-ab73-5d1f13c89f42\nhdl:21.14100/a0e47031-94d9-48a4-9a35-e008ec3bef1d\nhdl:21.14100/32e0ed01-ea5d-4b0b-a20e-f91e387ca569\nhdl:21.14100/18ea3cba-6cc9-49a9-b187-1d0be93c8ef5\nhdl:21.14100/bd923348-9aa1-4ad0-9efc-37288b19a933\nhdl:21.14100/95758127-f854-4fb0-b926-3ec4c4d95340\nhdl:21.14100/bf47f517-d03a-4e70-9504-563c825f1782\nhdl:21.14100/1686b8a1-4074-46d5-80ac-1c8a645b1fb4\nhdl:21.14100/f76f66be-aeae-49f0-8c98-2851d67a3de4\nhdl:21.14100/95a4d1c4-ad2d-425b-85f0-22d1ccc4f943\nhdl:21.14100/2c293851-7402-451a-80af-e21cd0eba6c2\nhdl:21.14100/69b4bae2-7e14-4386-b4ae-55f5c8fbcceb\nhdl:21.14100/793f3341-d4f6-465b-b391-cb4db029d09e\nhdl:21.14100/18f93468-a290-4ede-9585-29c4ff55efaa\nhdl:21.14100/128d940b-c6d9-4304-9b3b-40c2a7021d0d\nhdl:21.14100/7ef0b75e-5f11-4da9-a61b-d9b5eb08073f\nhdl:21.14100/7adb44a6-fa3b-4893-9560-c3377f29ee5f\nhdl:21.14100/240f3d7a-faa9-4e7a-aeab-7a842635dcc3\nhdl:21.14100/554fb9db-fdc0-425c-ac68-146cba77f8cb\nhdl:21.14100/7235eb45-2da1-4bb8-bd16-467256066116\nhdl:21.14100/f2188a57-eff0-4ab9-8263-a6654349ee18\nhdl:21.14100/3fdefb99-9db8-44c1-9a51-885f6db62cfa\nhdl:21.14100/f50ff646-df59-4eac-8080-e5da16e5d778\nhdl:21.14100/2fde10fe-1e37-4a93-ac9c-a34b8de5a606\nhdl:21.14100/25d85a61-ac30-49cd-985b-66d121e4d388\nhdl:21.14100/a83c191a-d59b-4079-87f3-8caa874fce06\nhdl:21.14100/23263a30-65b9-4887-b46c-253af00861e6\nhdl:21.14100/cbea6d5b-68dd-4db8-9500-8e2d1bcf11be\nhdl:21.14100/457e8153-b9e8-4e0a-a339-4b0f37c2992d\nhdl:21.14100/28e89d10-aa46-4629-9f96-07eb18d42bcc\nhdl:21.14100/4fe3cdb8-8434-497d-88b3-9eff0eab6264\nhdl:21.14100/4b34d44c-c673-419e-b5bb-cd01c5f382d6\nhdl:21.14100/20b0215a-3e8e-474b-9513-a80f45805ad2\nhdl:21.14100/e484b416-c59c-4ac2-bd9a-9ba2a3047d6a\nhdl:21.14100/befe4a85-4c28-4df7-9efe-0232a75ad2bc\nhdl:21.14100/9be130fb-934e-429b-84f1-77bee253059b\nhdl:21.14100/45a7fb91-c21b-42aa-8b7b-ca4fccee3d82\nhdl:21.14100/550cfa82-7d5f-484d-bcd8-375b6bf9cd28\nhdl:21.14100/809d1eee-9b32-4314-9c47-570edddcde9d\nhdl:21.14100/b5a65d62-f8fc-4b13-8a36-8a6a0fc8f64c\nhdl:21.14100/f1ba6e0d-af4f-419d-a762-d4ca5b3e0fd8\nhdl:21.14100/2492e2d8-23ed-4ddf-9a89-2e48df0d5933\nhdl:21.14100/1bda4adf-11a3-4b39-9a30-808ac443c79e\nhdl:21.14100/f2889793-851e-4ccd-b303-4d03e27ba56b\nhdl:21.14100/49e57aae-a8c0-426d-abd9-ffe68548a7b4\nhdl:21.14100/d2082e93-5bbe-4737-801f-c5d289f2c656\nhdl:21.14100/058f0e3d-126b-402c-8c57-26d915d617c6\nhdl:21.14100/d6659ea1-7c7d-49cb-b399-08d5541b6423\nhdl:21.14100/eda3b060-ad9f-4ea8-834c-850d811cd41d\nhdl:21.14100/d5c82405-0ebc-42bb-82ac-2202181bbd35\nhdl:21.14100/a408357d-ef9b-40a8-9b59-89c3a5d4958e\nhdl:21.14100/164a18b5-95a5-498f-89ad-f3cfa8dbb9ae\nhdl:21.14100/b726dcce-04e7-41ef-8f32-a36cffa516bd\nhdl:21.14100/69786839-c0a1-45de-935b-13a04e382fd7\nhdl:21.14100/9e97d612-10a7-458a-980e-fe4d4cac4bdb\nhdl:21.14100/0d51a98d-e849-48ae-82b4-9b2fb8f8c223\nhdl:21.14100/0966ef7c-613e-4fcc-81f5-c7e0811a8f34\nhdl:21.14100/f4ac8ec2-30a2-4cb4-a7f6-c501e812baf6\nhdl:21.14100/0daf9460-21f8-48a5-930d-cc1f74812994\nhdl:21.14100/bda027e9-7c49-44f5-bb08-52e8b14e612d\nhdl:21.14100/6e3ad453-fcaf-4e39-873b-e19fa777337a\nhdl:21.14100/c803cdd9-03f8-468a-add6-f1dbb3e0821d\nhdl:21.14100/20dfef18-620f-45c7-9d4b-1a6b2e4cb865\nhdl:21.14100/a176839c-d91a-4523-b272-61a65a73fb78\nhdl:21.14100/808c535a-b500-4424-a9bb-5f967c257748\nhdl:21.14100/a04a6234-f33c-4039-b6f7-509966fe357b\nhdl:21.14100/45c7759d-86c5-442f-a211-089103fa5868\nhdl:21.14100/217c9a68-8d35-42e7-a7ed-69035697043f\nhdl:21.14100/c9b183a4-5812-4b4e-af0a-497a68180979&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="assign-attributes-to-the-variables">
<h2>Assign attributes to the variables<a class="headerlink" href="#assign-attributes-to-the-variables" title="Permalink to this headline">#</a></h2>
<p>We will assign the attributes to the variables as in ERA5 to make CMIP6 and ERA5 variables comperable.</p>
<ul class="simple">
<li><p><a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/dd916e3e2eca18cda5d9f81749d0c91c.html"><code class="docutils literal notranslate"><span class="pre">cli</span></code></a> and <a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/86b2b3318a73839edfafa9d46864aadc.html"><code class="docutils literal notranslate"><span class="pre">clw</span></code></a> in <strong>kg kg-1</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g kg-1</strong></p></li>
<li><p><a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/73c496f5669cc122cf1cddfe4df2a27a.html"><code class="docutils literal notranslate"><span class="pre">clivi</span></code></a> and <a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/e6b31a1928879fcd3c92fe7b592f070e.html"><code class="docutils literal notranslate"><span class="pre">lwp</span></code></a> in <strong>kg m-2</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g m-2</strong></p></li>
<li><p><a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/62f26742cf240c1b5169a5cd511196b6.html"><code class="docutils literal notranslate"><span class="pre">pr</span></code></a> and <a class="reference external" href="http://clipc-services.ceda.ac.uk/dreq/u/051919eddec810e292c883205c944ceb.html"><code class="docutils literal notranslate"><span class="pre">prsn</span></code></a> in <strong>kg m-2 s-1</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>86400</strong> to get <strong>mm day-1</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for var_id in variable_id:</span>
<span class="c1">#     for keys in dset_dict.keys():</span>
<span class="c1">#         if var_id == &#39;cli&#39; or var_id == &#39;clw&#39; or var_id == &#39;lwp&#39; or var_id  == &#39;clivi&#39;:</span>
<span class="c1">#             dset_dict[keys][var_id] = dset_dict[keys][var_id]*1000</span>
<span class="c1">#             if var_id == &#39;cli&#39;:</span>
<span class="c1">#                 dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;g kg-1&#39;, &#39;long_name&#39;: &#39;Mass Fraction of Cloud Ice&#39;, &#39;standard_name&#39;: &#39;mass_fraction_of_cloud_ice_in_air&#39;, &#39;comment&#39;: &#39;Includes both large-scale and convective cloud. This is calculated as the mass of cloud ice in the grid cell divided by the mass of air (including the water in all phases) in the grid cell. It includes precipitating hydrometeors ONLY if the precipitating hydrometeors affect the calculation of radiative transfer in model.&#39;, &#39;cell_methods&#39;: &#39;area: time: mean (interval: 5 minutes)&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;,}</span>
<span class="c1">#             if var_id == &#39;clw&#39;:</span>
<span class="c1">#                 dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;g kg-1&#39;, &#39;long_name&#39;: &#39;Mass Fraction of Cloud Liquid Water&#39;, &#39;standard_name&#39;: &#39;mass_fraction_of_cloud_liquid_water_in_air&#39;, &#39;comment&#39;: &#39;Includes both large-scale and convective cloud. Calculate as the mass of cloud liquid water in the grid cell divided by the mass of air (including the water in all phases) in the grid cells. Precipitating hydrometeors are included ONLY if the precipitating hydrometeors affect the calculation of radiative transfer in model.&#39;, &#39;cell_methods&#39;: &#39;area: time: mean&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;}</span>
<span class="c1">#             if var_id == &#39;clivi&#39;:</span>
<span class="c1">#                 dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;g m-2&#39;, &#39;long_name&#39;: &#39;Ice Water Path&#39;, &#39;comment&#39;: &#39;mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.&#39;, &#39;cell_methods&#39;: &#39;area: time: mean&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;} </span>
<span class="c1">#             if var_id == &#39;lwp&#39;:</span>
<span class="c1">#                 dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;g m-2&#39;, &#39;long_name&#39;: &#39;Liquid Water Path&#39;, &#39;comment&#39;: &#39;The total mass of liquid water in cloud per unit area.&#39;, &#39;cell_methods&#39;: &#39;area: time: mean&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;}</span>

<span class="c1">#         if var_id == &#39;pr&#39; or var_id == &#39;prsn&#39;:</span>
<span class="c1">#             try: </span>
<span class="c1">#                 dset_dict[keys][var_id] = dset_dict[keys][var_id]*86400</span>
<span class="c1">#                 if var_id == &#39;pr&#39;:</span>
<span class="c1">#                     dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;mm day-1&#39;, &#39;long_name&#39;: &#39;Precipitation&#39;, &#39;comment&#39;: &#39;includes both liquid and solid phases&#39;,&#39;cell_methods&#39;: &#39;area: time: mean&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;}</span>
<span class="c1">#                 if var_id == &#39;prsn&#39;:</span>
<span class="c1">#                     dset_dict[keys][var_id].attrs = {&#39;units&#39;: &#39;mm day-1&#39;, &#39;long_name&#39;: &#39;Snowfall&#39;, &#39;comment&#39;: &#39;At surface; includes precipitation of all forms of water in the solid phase&#39;, &#39;cell_methods&#39;: &#39;area: time: mean&#39;, &#39;cell_measures&#39;: &#39;area: areacella&#39;}</span>
<span class="c1">#             except KeyError:</span>
<span class="c1">#                 continue</span>
        
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpolate-from-cmip6-hybrid-sigma-pressure-levels-to-era5-isobaric-pressure-levels">
<h2>Interpolate from CMIP6 hybrid sigma-pressure levels to ERA5 isobaric pressure levels<a class="headerlink" href="#interpolate-from-cmip6-hybrid-sigma-pressure-levels-to-era5-isobaric-pressure-levels" title="Permalink to this headline">#</a></h2>
<p>The vertical variables in the CMIP6 models are in hybrid sigma-pressure levels. Hence the vertical variable in the xarray datasets in <code class="docutils literal notranslate"><span class="pre">dset_dict</span></code> will be calculated by using the <a class="reference external" href="https://geocat-comp.readthedocs.io/en/latest/index.html">GeoCAT-comb</a> function to <a class="reference external" href="https://geocat-comp.readthedocs.io/en/latest/user_api/generated/geocat.comp.interpolation.interp_hybrid_to_pressure.html#geocat.comp.interpolation.interp_hybrid_to_pressure">interpolate data from hybrid-sigma levels to isobaric levels</a>.</p>
<p>The GeoCAT-comb function takes the following input:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>:   Multidimensional data array, which holds hybrid-sigma levels and has a lev_dim coordinate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ps</span></code>:     A multi-dimensional array of surface pressures (Pa), same time/space shape as data. Not all variables include the surface pressure, hence we will search the <code class="docutils literal notranslate"><span class="pre">Pangeo.io</span></code> catalog to find the surface pressure associated with the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hyam</span></code>:     One-dimensional arrays containing the hybrid A coefficients. Must have the same dimension size as the lev_dim dimension of data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hybm</span></code>:     One-dimensional arrays containing the hybrid B coefficients. Must have the same dimension size as the lev_dim dimension of data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p0</span></code>:       Scalar numeric value equal to surface reference pressure (Pa). Defaults to 100000 Pa.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">new_levels</span></code>: A one-dimensional array of output pressure levels (Pa). We will use the pressure of <code class="docutils literal notranslate"><span class="pre">air_temperature</span></code> (19 levels).</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ P(i,j,k) = hyam(k) p0 + hybm(k) ps(i,j)\]</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geocat</span>

<span class="n">geocat</span><span class="o">.</span><span class="n">comp</span><span class="o">.</span><span class="n">interpolation</span><span class="o">.</span><span class="n">interp_hybrid_to_pressure</span><span class="p">(</span><span class="n">data</span>      <span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;variable&#39;</span><span class="p">],</span> 
                                                    <span class="n">ps</span>        <span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;ps&#39;</span><span class="p">],</span> 
                                                    <span class="n">hyam</span>      <span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">],</span> 
                                                    <span class="n">hybm</span>      <span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">],</span> 
                                                    <span class="n">p0</span>        <span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;p0&#39;</span><span class="p">],</span> 
                                                    <span class="n">new_levels</span><span class="o">=</span><span class="n">ds</span><span class="p">[</span><span class="s1">&#39;plev&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # load the levels from the ERA5 file and transfer to Pa</span>
<span class="c1"># era_level = (xr.open_dataset(&#39;/scratch/franzihe/input/ERA5/monthly_means/0.25deg/clwc_Amon_ERA5_198501_198912.nc&#39;)[&#39;level&#39;])*100</span>

<span class="c1"># if ((&#39;clw&#39; or &#39;cli&#39; or &#39;ta&#39;) in variable_id) == True:</span>
<span class="c1">#     # if var_id == &#39;clw&#39; or var_id == &#39;cli&#39;:</span>
<span class="c1">#     for keys in dset_dict.keys():</span>
<span class="c1">#         # rename cmip pressure level for atmospheric temperature</span>
<span class="c1">#         dset_dict[keys] = dset_dict[keys].rename({&#39;plev&#39;:&#39;clev&#39;})</span>
<span class="c1">#         # interpolate from hybrid to pressure levels for clw and cli</span>
<span class="c1">#         for var_id in [variable_id[variable_id.index(&#39;clw&#39;)], variable_id[variable_id.index(&#39;cli&#39;)]]:</span>

<span class="c1">#             if (&#39;ps&#39; in list(dset_dict[keys].keys())) == False:     # valid for models which don&#39;t provide ps in the clw or cli dataset</span>
<span class="c1">#                 model = keys.split(&#39;.&#39;)[2]</span>
<span class="c1">#                 ds_ps = col.search(source_id=model, table_id = [&#39;Amon&#39;, ], experiment_id=[&#39;historical&#39;], variable_id=[&#39;ps&#39;,&#39;p0&#39;, ], member_id=[&#39;r1i1p1f1&#39;]).to_dataset_dict(zarr_kwargs={&#39;use_cftime&#39;:True,}, )</span>
<span class="c1">#                 dset_dict[keys].update(ds_ps[keys], )</span>
<span class="c1">#                 dset_dict[keys][&#39;ps&#39;] = dset_dict[keys][&#39;ps&#39;].isel(member_id = 0)</span>
                
                
<span class="c1">#             # Rename datasets with different naming convention for constant A</span>
<span class="c1">#             if (&#39;a&#39; in list(dset_dict[keys].keys())) == False:</span>
<span class="c1">#                 dset_dict[keys] = dset_dict[keys].rename({&#39;ap&#39;:&#39;a&#39;, &#39;ap_bnds&#39;: &#39;a_bnds&#39;})</span>
                    
                    
<span class="c1">#             # Convert the model level to isobaric levels</span>
<span class="c1">#             #### a, b, ps, p0</span>
<span class="c1">#             if (&#39;a&#39; in list(dset_dict[keys].keys())) == True and (&#39;b&#39; in list(dset_dict[keys].keys())) == True and (&#39;p0&#39; in list(dset_dict[keys].keys())) == True and (&#39;ps&#39; in list(dset_dict[keys].keys())) == True:</span>
<span class="c1">#                 dset_dict[keys][&#39;{}_interp&#39;.format(var_id)] = gc.interpolation.interp_hybrid_to_pressure(data=dset_dict[keys][var_id].isel(member_id = 0), </span>
<span class="c1">#                                                                                                                 ps=dset_dict[keys][&#39;ps&#39;],hyam=dset_dict[keys][&#39;a&#39;],</span>
<span class="c1">#                                                                                                                 hybm=dset_dict[keys][&#39;b&#39;],</span>
<span class="c1">#                                                                                                                 p0=dset_dict[keys][&#39;p0&#39;].values, </span>
<span class="c1">#                                                                                                                 new_levels=(era_level).values, )</span>
<span class="c1">#                 # # remove the variables needed for the calculation of the isobaric levels. If this step is not performed, </span>
<span class="c1">#                 # # the horizontal regridding will not be possible.</span>
<span class="c1">#                 # dset_dict[keys] = dset_dict[keys].drop((&#39;a&#39;, &#39;p0&#39;, &#39;b&#39;, &#39;ps&#39;, &#39;a_bnds&#39;, &#39;b_bnds&#39;, var_id))</span>
<span class="c1">#                 dset_dict[keys] = dset_dict[keys].drop((var_id))</span>
<span class="c1">#                 dset_dict[keys] = dset_dict[keys].rename({&#39;{}_interp&#39;.format(var_id):var_id})</span>

<span class="c1">#             #### a, b, ps</span>
<span class="c1">#             elif (&#39;a&#39; in list(dset_dict[keys].keys())) == True and (&#39;b&#39; in list(dset_dict[keys].keys())) == True and (&#39;ps&#39; in list(dset_dict[keys].keys())) == True and (&#39;p0&#39; in list(dset_dict[keys].keys())) == False:</span>
<span class="c1">#                 dset_dict[keys][&#39;{}_interp&#39;.format(var_id)] = gc.interpolation.interp_hybrid_to_pressure(data=dset_dict[keys][var_id].isel(member_id=0), </span>
<span class="c1">#                                                                                                                 ps=dset_dict[keys][&#39;ps&#39;],</span>
<span class="c1">#                                                                                                                 hyam=dset_dict[keys][&#39;a&#39;], </span>
<span class="c1">#                                                                                                                 hybm=dset_dict[keys][&#39;b&#39;],</span>
<span class="c1">#                                                                                                                 p0=100000.0,</span>
<span class="c1">#                                                                                                                 new_levels=(era_level).values, )</span>
<span class="c1">#                 # dset_dict[keys] = dset_dict[keys].drop((&#39;a&#39;, &#39;b&#39;, &#39;ps&#39;, &#39;a_bnds&#39;, &#39;b_bnds&#39;, var_id))</span>
<span class="c1">#                 dset_dict[keys] = dset_dict[keys].drop((var_id))</span>
<span class="c1">#                 dset_dict[keys] = dset_dict[keys].rename({&#39;{}_interp&#39;.format(var_id):var_id})</span>
        
<span class="c1">#         # remove the variables needed for the calculation of the isobaric levels. If this step is not performed, </span>
<span class="c1">#         # the horizontal regridding will not be possible.</span>
<span class="c1">#         if (&#39;p0&#39; in list(dset_dict[keys].keys())) == True:</span>
<span class="c1">#             dset_dict[keys] = dset_dict[keys].drop((&#39;a&#39;, &#39;p0&#39;, &#39;b&#39;, &#39;ps&#39;, &#39;a_bnds&#39;, &#39;b_bnds&#39;,))</span>
<span class="c1">#         elif (&#39;p0&#39; in list(dset_dict[keys].keys())) == False:</span>
<span class="c1">#             dset_dict[keys] = dset_dict[keys].drop((&#39;a&#39;, &#39;b&#39;, &#39;ps&#39;, &#39;a_bnds&#39;, &#39;b_bnds&#39;,))</span>
 
</pre></div>
</div>
</div>
</div>
</section>
<section id="regrid-cmip6-data-to-noresm2-mm-grid-a-id-regrid-hz-a">
<h2>Regrid CMIP6 data to NorESM2-MM grid <a id='regrid_hz'></a><a class="headerlink" href="#regrid-cmip6-data-to-noresm2-mm-grid-a-id-regrid-hz-a" title="Permalink to this headline">#</a></h2>
<p>We want to conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) in the CMIP6 models. At the moment we have all historical data from the CMIP6 models. For this, we will have to extract the 30-year period between 1985 and 2014.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define a start and end year.</p>
<p>The CMIP6 high resolution models have approximately a nominal resolution of 100km. But not all have identical grid spacing. Hence we will make use of the python package <code class="docutils literal notranslate"><span class="pre">xesmf</span></code> and the documentation on <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Compare_algorithms.html#Decreasing-resolution">decreasing resolution</a>, <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Masking.html?highlight=conservative#Limitations-and-warnings">Limitations and warnings</a>.</p>
<p>NorESM2-MM will be the reference grid since we want to compare the models to the ERA5 data. The ERA5 data has a nominal resolution of 0.25deg and has been regridded to the same horizontal resolution as the NorESM2-MM in <a class="reference internal" href="../ERA5/ERA5_1985-2014.html"><span class="doc std std-doc">the ERA5 Jupyter Notebook</span></a>.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define NorESM2-MM as the reference grid <code class="docutils literal notranslate"><span class="pre">ds_out</span></code>.</p>
<p>Create a new Python dictionary (<code class="docutils literal notranslate"><span class="pre">ds_gridded_dict</span></code>) with the regridded CMIP6 <code class="docutils literal notranslate"><span class="pre">xarray</span></code> datasets between 1985 an 2014. Save each regridded model to a <code class="docutils literal notranslate"><span class="pre">netcdf</span></code>, locally.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> This step may take several minutes!</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starty</span> <span class="o">=</span> <span class="mi">1985</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="n">year_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ds_out = dset_dict[&#39;CMIP.NCC.NorESM2-MM.historical.Amon.gn&#39;]</span>
<span class="c1"># ds_in  = dset_dict[model]</span>

<span class="c1"># import xesmf</span>

<span class="c1"># # Regridder data</span>
<span class="c1"># regridder = xesmf.Regridder(ds_in, ds_out, &quot;conservative&quot;)</span>

<span class="c1"># # Apply regridder to data</span>
<span class="c1">#  # the entire dataset can be processed at once</span>
<span class="c1"># ds_in_regrid = regridder(ds_in)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # create dictionary for reggridded data</span>
<span class="c1"># ds_gridded_dict = dict()</span>

<span class="c1"># # Read in the output grid from NorESM</span>
<span class="c1"># if variable_id[0] == &#39;lwp&#39;:</span>
<span class="c1">#     ds_out = dset_dict[&#39;CMIP.NCC.NorESM2-MM.historical.AERmon.gn&#39;].isel(member_id = 0)</span>
<span class="c1"># else:</span>
<span class="c1">#     ds_out = dset_dict[&#39;CMIP.NCC.NorESM2-MM.historical.Amon.gn&#39;].isel(member_id = 0)</span>
<span class="c1"># ds_out = ds_out.sel(time = ds_out.time.dt.year.isin(year_range)).squeeze()</span>


<span class="c1"># counter = 0</span>

<span class="c1"># for keys in dset_dict.keys():</span>
<span class="c1">#     # select only models which have atmospheric monthly values</span>
<span class="c1">#     amon = keys.split(&#39;.&#39;)[-2]</span>
<span class="c1">#     if amon == &#39;Amon&#39; or amon == &#39;AERmon&#39;: </span>
<span class="c1">#         # select model name </span>
<span class="c1">#         model = keys.split(&#39;.&#39;)[2]</span>
        
<span class="c1">#         # select where data should be saved</span>
<span class="c1">#         if len(variable_id) &gt; 1:</span>
<span class="c1">#             filename = &#39;{}_Amon_1deg_{}01_{}12.nc&#39;.format(variable_id, starty, endy)</span>
<span class="c1">#         elif len([variable_id]) == 1:</span>
<span class="c1">#             filename = &#39;{}_Amon_1deg_{}01_{}12.nc&#39;.format(variable_id[0], starty, endy)</span>
<span class="c1">#         # filename = &#39;{}_Amon_1deg_{}01_{}12.nc&#39;.format(variable_id[0], starty, endy)</span>
<span class="c1">#         savepath = &#39;/scratch/franzihe/output/CMIP6_hist/1deg/{}/&#39;.format(model)</span>
<span class="c1">#         nc_out = savepath + filename</span>
<span class="c1">#         files = glob(nc_out)</span>
        
<span class="c1">#         # Input data from CMIP6 model to be regridded</span>
<span class="c1">#         ds_in = dset_dict[keys].isel(member_id = 0)</span>
<span class="c1">#         ds_in = ds_in.sel(time = ds_in.time.dt.year.isin(year_range)).squeeze()</span>
            
<span class="c1">#         # common time grid</span>
<span class="c1">#         ds_in[&#39;time&#39;] = ds_out[&#39;time&#39;]</span>
            

<span class="c1">#         # Regrid data</span>
<span class="c1">#         ds_in_regrid = fct.regrid_data(ds_in, ds_out)</span>


<span class="c1">#         # Shift the longitude from 0--&gt;360 to -180--&gt;180 and sort by longitude and time</span>
<span class="c1">#         ds_in_regrid = ds_in_regrid.assign_coords(lon=(((ds_in_regrid.lon + 180) % 360) - 180)).sortby(&#39;lon&#39;).sortby(&#39;time&#39;)</span>
<span class="c1">#         ds_in_regrid = ds_in_regrid.reset_coords(names=[&#39;time_bnds&#39;, ], drop=True)</span>
            
            
<span class="c1">#         # create dataset with all models</span>
<span class="c1">#         ds_gridded_dict[model] = ds_in_regrid</span>

<span class="c1">#         # if nc_out in files:</span>
<span class="c1">#         #     print(&#39;{} is downloaded&#39;.format(nc_out))</span>
<span class="c1">#         #     counter += 1</span>
<span class="c1">#         #     print(&#39;Have regridded in total: {:} files&#39;.format(str(counter)))</span>
<span class="c1">#         # else:    </span>
<span class="c1">#             # Save to netcdf file</span>
<span class="c1">#         ds_in_regrid.to_netcdf(nc_out)</span>
<span class="c1">#         print(&#39;file written: {}&#39;.format(nc_out))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="connect-all-models-into-one-dataset-with-new-coordinate-model">
<h2>Connect all models into one Dataset with new coordinate ‘model’<a class="headerlink" href="#connect-all-models-into-one-dataset-with-new-coordinate-model" title="Permalink to this headline">#</a></h2>
<p>We will create a <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> with all CMIP6 models, after the interpolation to the same horizonal (and vertical) resolution. This step will make the next steps easier, as we will not need the the full dictonary key and can just use the model name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # not needed if regridding works</span>
<span class="c1"># ds_gridded_dict = dict()</span>
<span class="c1"># for model in list_models:</span>
<span class="c1">#     ds_gridded_dict[model] = xr.open_dataset(&#39;/scratch/franzihe/output/CMIP6_hist/1deg/{}/{}_Amon_1deg_198501_201412.nc&#39;.format(model,variable_id))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # expand the model with nan array where missing variables</span>
<span class="c1"># for model in ds_gridded_dict.keys():</span>
<span class="c1">#     for var in variable_id:</span>
<span class="c1">#         # print(var, model)</span>
<span class="c1">#         if (var in ds_gridded_dict[model].variables) == False:</span>
<span class="c1">#             print(model, var)</span>
<span class="c1">#             if var == &#39;pr&#39; or var == &#39;prsn&#39;:</span>
<span class="c1">#                 ds_gridded_dict[model][var] = xr.DataArray(data=da.full(shape = (ds_gridded_dict[model][&#39;time&#39;].shape[0], </span>
<span class="c1">#                                                                                  ds_gridded_dict[model][&#39;lat&#39;].shape[0], </span>
<span class="c1">#                                                                                  ds_gridded_dict[model][&#39;lon&#39;].shape[0]), </span>
<span class="c1">#                                                             fill_value=np.nan, </span>
<span class="c1">#                                                             chunks=(120, 721, 1440/2)), dims = [ds_gridded_dict[model].time.dims[0], ds_gridded_dict[model].lat.dims[0], ds_gridded_dict[model].lon.dims[0]], coords=[ds_gridded_dict[model].time.values, ds_gridded_dict[model].lat.values, ds_gridded_dict[model].lon.values])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># _ds = list(ds_gridded_dict.values())</span>
<span class="c1"># _coord = list(ds_gridded_dict.keys())</span>
<span class="c1"># ds_cmip = xr.concat(objs=_ds, dim=_coord, coords=&quot;all&quot;).rename({&#39;concat_dim&#39;:&#39;model&#39;})</span>
<span class="c1"># ds_cmip = ds_cmip.drop(&#39;bnds&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cmip</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="s1">&#39;/scratch/franzihe/output/CMIP6_hist/1deg/*.nc&#39;</span><span class="p">)</span>
<span class="n">ds_cmip</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                  (model: 17, time: 360, lat: 192, lon: 288,
                              season: 4)
Coordinates:
  * model                    (model) object &#x27;BCC-CSM2-MR&#x27; ... &#x27;TaiESM1&#x27;
  * time                     (time) object 1985-01-16 12:00:00 ... 2014-12-16...
    member_id                (model) object dask.array&lt;chunksize=(17,), meta=np.ndarray&gt;
  * lon                      (lon) float64 -180.0 -178.8 -177.5 ... 177.5 178.8
  * lat                      (lat) float64 -90.0 -89.06 -88.12 ... 89.06 90.0
  * season                   (season) object &#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;
    height                   (model) float64 dask.array&lt;chunksize=(17,), meta=np.ndarray&gt;
Data variables: (12/16)
    clivi                    (model, time, lat, lon) float64 dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;
    clivi_season_mean        (model, season, lat, lon) float64 dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;
    clivi_season_model_mean  (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
    clivi_season_model_std   (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
    lwp                      (model, time, lat, lon) float64 dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;
    lwp_season_mean          (model, season, lat, lon) float64 dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;
    ...                       ...
    prsn_season_model_mean   (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
    prsn_season_model_std    (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
    tas                      (model, time, lat, lon) float64 dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;
    tas_season_mean          (model, season, lat, lon) float64 dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;
    tas_season_model_mean    (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
    tas_season_model_std     (season, lat, lon) float64 dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;
Attributes: (12/58)
    Conventions:                    CF-1.7 CMIP-6.2
    activity_id:                    CMIP
    branch_method:                  standard
    branch_time_in_child:           0.0
    branch_time_in_parent:          0.0
    cmor_version:                   3.5.0
    ...                             ...
    variable_id:                    clivi
    variant_label:                  r1i1p1f1
    netcdf_tracking_ids:            hdl:21.14100/1a0692a9-17c2-4083-bcd2-bb00...
    version_id:                     v20191211
    intake_esm_varname:             clivi
    intake_esm_dataset_key:         CMIP.E3SM-Project.E3SM-1-1.historical.Amo...</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-17a84f95-2853-4c7c-a3c3-e6bb86806779' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-17a84f95-2853-4c7c-a3c3-e6bb86806779' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>model</span>: 17</li><li><span class='xr-has-index'>time</span>: 360</li><li><span class='xr-has-index'>lat</span>: 192</li><li><span class='xr-has-index'>lon</span>: 288</li><li><span class='xr-has-index'>season</span>: 4</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-f3f7cb7e-2452-4bfa-a670-3db0e5349bf4' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f3f7cb7e-2452-4bfa-a670-3db0e5349bf4' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>model</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;BCC-CSM2-MR&#x27; ... &#x27;TaiESM1&#x27;</div><input id='attrs-a55bf21a-c261-4025-b843-a20b89b6bce6' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a55bf21a-c261-4025-b843-a20b89b6bce6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ac73fb01-d037-4d9a-92eb-491ddb076f7a' class='xr-var-data-in' type='checkbox'><label for='data-ac73fb01-d037-4d9a-92eb-491ddb076f7a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;BCC-CSM2-MR&#x27;, &#x27;CAMS-CSM1-0&#x27;, &#x27;CIESM&#x27;, &#x27;CMCC-CM2-HR4&#x27;, &#x27;CMCC-CM2-SR5&#x27;,
       &#x27;CMCC-ESM2&#x27;, &#x27;E3SM-1-1&#x27;, &#x27;E3SM-1-1-ECA&#x27;, &#x27;EC-Earth3-AerChem&#x27;,
       &#x27;FGOALS-f3-L&#x27;, &#x27;GFDL-CM4&#x27;, &#x27;GFDL-ESM4&#x27;, &#x27;MPI-ESM1-2-HR&#x27;, &#x27;MRI-ESM2-0&#x27;,
       &#x27;NorESM2-MM&#x27;, &#x27;SAM0-UNICON&#x27;, &#x27;TaiESM1&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time</span></div><div class='xr-var-dims'>(time)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>1985-01-16 12:00:00 ... 2014-12-...</div><input id='attrs-e41db24f-f082-4791-80c0-37143a183ec4' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e41db24f-f082-4791-80c0-37143a183ec4' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c20a7f9e-a1b7-4f5d-8343-03c9abec488f' class='xr-var-data-in' type='checkbox'><label for='data-c20a7f9e-a1b7-4f5d-8343-03c9abec488f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>T</dd><dt><span>bounds :</span></dt><dd>time_bnds</dd><dt><span>long_name :</span></dt><dd>time</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array([cftime.DatetimeNoLeap(1985, 1, 16, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1985, 2, 15, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(1985, 3, 16, 12, 0, 0, 0, has_year_zero=True),
       ...,
       cftime.DatetimeNoLeap(2014, 10, 16, 12, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2014, 11, 16, 0, 0, 0, 0, has_year_zero=True),
       cftime.DatetimeNoLeap(2014, 12, 16, 12, 0, 0, 0, has_year_zero=True)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>member_id</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17,), meta=np.ndarray&gt;</div><input id='attrs-3cc2badb-1748-464a-9518-65fd6806788d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3cc2badb-1748-464a-9518-65fd6806788d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e0436fbf-dd9d-40cc-ab0c-e72fca2d2b6f' class='xr-var-data-in' type='checkbox'><label for='data-e0436fbf-dd9d-40cc-ab0c-e72fca2d2b6f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 136 B </td>
                        <td> 136 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17,) </td>
                        <td> (17,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 26 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> object </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="85" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="35" x2="120" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,35.49251375950792 0.0,35.49251375950792" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="55.492514" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="140.000000" y="17.746257" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,17.746257)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lon</span></div><div class='xr-var-dims'>(lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-180.0 -178.8 ... 177.5 178.8</div><input id='attrs-9e375560-3e72-480a-b6f0-773d23680204' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9e375560-3e72-480a-b6f0-773d23680204' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a543a78e-183f-4cf9-b25d-0302fff3914f' class='xr-var-data-in' type='checkbox'><label for='data-a543a78e-183f-4cf9-b25d-0302fff3914f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-180.  , -178.75, -177.5 , ...,  176.25,  177.5 ,  178.75])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lat</span></div><div class='xr-var-dims'>(lat)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-90.0 -89.06 -88.12 ... 89.06 90.0</div><input id='attrs-d28df5ba-a3a0-4bd2-a862-ea999bd3bb7e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d28df5ba-a3a0-4bd2-a862-ea999bd3bb7e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b31d918a-1b5a-4ebf-85b7-7b4cd450e0c0' class='xr-var-data-in' type='checkbox'><label for='data-b31d918a-1b5a-4ebf-85b7-7b4cd450e0c0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-90.      , -89.057592, -88.115183, -87.172775, -86.230366, -85.287958,
       -84.34555 , -83.403141, -82.460733, -81.518325, -80.575916, -79.633508,
       -78.691099, -77.748691, -76.806283, -75.863874, -74.921466, -73.979058,
       -73.036649, -72.094241, -71.151832, -70.209424, -69.267016, -68.324607,
       -67.382199, -66.439791, -65.497382, -64.554974, -63.612565, -62.670157,
       -61.727749, -60.78534 , -59.842932, -58.900524, -57.958115, -57.015707,
       -56.073298, -55.13089 , -54.188482, -53.246073, -52.303665, -51.361257,
       -50.418848, -49.47644 , -48.534031, -47.591623, -46.649215, -45.706806,
       -44.764398, -43.82199 , -42.879581, -41.937173, -40.994764, -40.052356,
       -39.109948, -38.167539, -37.225131, -36.282723, -35.340314, -34.397906,
       -33.455497, -32.513089, -31.570681, -30.628272, -29.685864, -28.743455,
       -27.801047, -26.858639, -25.91623 , -24.973822, -24.031414, -23.089005,
       -22.146597, -21.204188, -20.26178 , -19.319372, -18.376963, -17.434555,
       -16.492147, -15.549738, -14.60733 , -13.664921, -12.722513, -11.780105,
       -10.837696,  -9.895288,  -8.95288 ,  -8.010471,  -7.068063,  -6.125654,
        -5.183246,  -4.240838,  -3.298429,  -2.356021,  -1.413613,  -0.471204,
         0.471204,   1.413613,   2.356021,   3.298429,   4.240838,   5.183246,
         6.125654,   7.068063,   8.010471,   8.95288 ,   9.895288,  10.837696,
        11.780105,  12.722513,  13.664921,  14.60733 ,  15.549738,  16.492147,
        17.434555,  18.376963,  19.319372,  20.26178 ,  21.204188,  22.146597,
        23.089005,  24.031414,  24.973822,  25.91623 ,  26.858639,  27.801047,
        28.743455,  29.685864,  30.628272,  31.570681,  32.513089,  33.455497,
        34.397906,  35.340314,  36.282723,  37.225131,  38.167539,  39.109948,
        40.052356,  40.994764,  41.937173,  42.879581,  43.82199 ,  44.764398,
        45.706806,  46.649215,  47.591623,  48.534031,  49.47644 ,  50.418848,
        51.361257,  52.303665,  53.246073,  54.188482,  55.13089 ,  56.073298,
        57.015707,  57.958115,  58.900524,  59.842932,  60.78534 ,  61.727749,
        62.670157,  63.612565,  64.554974,  65.497382,  66.439791,  67.382199,
        68.324607,  69.267016,  70.209424,  71.151832,  72.094241,  73.036649,
        73.979058,  74.921466,  75.863874,  76.806283,  77.748691,  78.691099,
        79.633508,  80.575916,  81.518325,  82.460733,  83.403141,  84.34555 ,
        85.287958,  86.230366,  87.172775,  88.115183,  89.057592,  90.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>season</span></div><div class='xr-var-dims'>(season)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>&#x27;DJF&#x27; &#x27;JJA&#x27; &#x27;MAM&#x27; &#x27;SON&#x27;</div><input id='attrs-145e904b-727a-47e7-a2a4-72ecd241d30b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-145e904b-727a-47e7-a2a4-72ecd241d30b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e472240d-cd85-40d9-b156-d649be8b4060' class='xr-var-data-in' type='checkbox'><label for='data-e472240d-cd85-40d9-b156-d649be8b4060' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;DJF&#x27;, &#x27;JJA&#x27;, &#x27;MAM&#x27;, &#x27;SON&#x27;], dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>height</span></div><div class='xr-var-dims'>(model)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17,), meta=np.ndarray&gt;</div><input id='attrs-d1d5dd64-114a-473e-b098-14fa413c1882' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d1d5dd64-114a-473e-b098-14fa413c1882' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0a974bdf-c246-492a-9edb-5fd02208efd6' class='xr-var-data-in' type='checkbox'><label for='data-0a974bdf-c246-492a-9edb-5fd02208efd6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Z</dd><dt><span>long_name :</span></dt><dd>height</dd><dt><span>positive :</span></dt><dd>up</dd><dt><span>standard_name :</span></dt><dd>height</dd><dt><span>units :</span></dt><dd>m</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 136 B </td>
                        <td> 136 B </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17,) </td>
                        <td> (17,) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 3 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="85" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="35" x2="120" y2="35" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="35" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="35" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,35.49251375950792 0.0,35.49251375950792" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="55.492514" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="140.000000" y="17.746257" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,17.746257)">1</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-49833c28-80fe-4eb7-9bda-dceb2820dc57' class='xr-section-summary-in' type='checkbox'  ><label for='section-49833c28-80fe-4eb7-9bda-dceb2820dc57' class='xr-section-summary' >Data variables: <span>(16)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>clivi</span></div><div class='xr-var-dims'>(model, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-1e5ab0c1-a06d-46c2-87a7-bfec4e8a4ec0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e5ab0c1-a06d-46c2-87a7-bfec4e8a4ec0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1b77bdc9-93c0-4654-a8e9-d381f05c02dd' class='xr-var-data-in' type='checkbox'><label for='data-1b77bdc9-93c0-4654-a8e9-d381f05c02dd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Ice Water Path</dd><dt><span>comment :</span></dt><dd>mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.52 GiB </td>
                        <td> 2.52 GiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 360, 192, 288) </td>
                        <td> (17, 360, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 3 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="424" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="34" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="34" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="34" y1="0" x2="34" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 34.15081328915008,0.0 34.15081328915008,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.075407" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="54.150813" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,54.150813,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="104" y1="64" x2="174" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="104" y2="64" style="stroke-width:2" />
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 174.58823529411765,70.58823529411765 174.58823529411765,134.58823529411765 104.0,64.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="200" y2="0" style="stroke-width:2" />
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="200" y1="0" x2="270" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 200.0,0.0 270.5882352941177,70.58823529411765 174.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />
  <line x1="174" y1="134" x2="270" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />
  <line x1="270" y1="70" x2="270" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="174.58823529411765,70.58823529411765 270.5882352941177,70.58823529411765 270.5882352941177,134.58823529411765 174.58823529411765,134.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="222.588235" y="154.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="290.588235" y="102.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,290.588235,102.588235)">192</text>
  <text x="129.294118" y="119.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,129.294118,119.294118)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>clivi_season_mean</span></div><div class='xr-var-dims'>(model, season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-c2f55785-8ee1-4861-b132-e249108f0d9c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c2f55785-8ee1-4861-b132-e249108f0d9c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-04649c70-d017-44bc-994a-a19b50f45372' class='xr-var-data-in' type='checkbox'><label for='data-04649c70-d017-44bc-994a-a19b50f45372' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Ice Water Path</dd><dt><span>comment :</span></dt><dd>mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 28.69 MiB </td>
                        <td> 28.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 4, 192, 288) </td>
                        <td> (17, 4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 3 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="395" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="35" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="35" y1="0" x2="35" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 35.51355097190284,0.0 35.51355097190284,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.756775" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="55.513551" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,55.513551,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="105" y1="80" x2="120" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="105" y2="80" style="stroke-width:2" />
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 120.91413880186435,15.914138801864357 120.91413880186435,95.91413880186435 105.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="225" y2="0" style="stroke-width:2" />
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="225" y1="0" x2="240" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 225.0,0.0 240.91413880186437,15.914138801864357 120.91413880186435,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />
  <line x1="120" y1="95" x2="240" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />
  <line x1="240" y1="15" x2="240" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="120.91413880186435,15.914138801864357 240.91413880186434,15.914138801864357 240.91413880186434,95.91413880186435 120.91413880186435,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="180.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="260.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,260.914139,55.914139)">192</text>
  <text x="102.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>clivi_season_model_mean</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-6ad23ce1-8ef0-40f2-9e51-5fe62e86db2f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6ad23ce1-8ef0-40f2-9e51-5fe62e86db2f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4108de8f-ae86-4900-9efb-b9e53183f554' class='xr-var-data-in' type='checkbox'><label for='data-4108de8f-ae86-4900-9efb-b9e53183f554' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Ice Water Path</dd><dt><span>comment :</span></dt><dd>mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>clivi_season_model_std</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-d099e0fe-5f4a-4b0f-98e8-e9319d572f45' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d099e0fe-5f4a-4b0f-98e8-e9319d572f45' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3cf76700-c7f4-402c-a121-b7b903ad120d' class='xr-var-data-in' type='checkbox'><label for='data-3cf76700-c7f4-402c-a121-b7b903ad120d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Ice Water Path</dd><dt><span>comment :</span></dt><dd>mass of ice water in the column divided by the area of the column (not just the area of the cloudy portion of the column). Includes precipitating frozen hydrometeors ONLY if the precipitating hydrometeor affects the calculation of radiative transfer in model.</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lwp</span></div><div class='xr-var-dims'>(model, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-756219bb-ce95-4b76-9e4b-cd724389a99b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-756219bb-ce95-4b76-9e4b-cd724389a99b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b20f88bc-9563-4833-ae3b-bc67016a4019' class='xr-var-data-in' type='checkbox'><label for='data-b20f88bc-9563-4833-ae3b-bc67016a4019' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Precipitation</dd><dt><span>comment :</span></dt><dd>includes both liquid and solid phases</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.52 GiB </td>
                        <td> 2.52 GiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 360, 192, 288) </td>
                        <td> (17, 360, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 16 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="424" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="34" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="34" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="34" y1="0" x2="34" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 34.15081328915008,0.0 34.15081328915008,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.075407" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="54.150813" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,54.150813,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="104" y1="64" x2="174" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="104" y2="64" style="stroke-width:2" />
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 174.58823529411765,70.58823529411765 174.58823529411765,134.58823529411765 104.0,64.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="200" y2="0" style="stroke-width:2" />
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="200" y1="0" x2="270" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 200.0,0.0 270.5882352941177,70.58823529411765 174.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />
  <line x1="174" y1="134" x2="270" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />
  <line x1="270" y1="70" x2="270" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="174.58823529411765,70.58823529411765 270.5882352941177,70.58823529411765 270.5882352941177,134.58823529411765 174.58823529411765,134.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="222.588235" y="154.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="290.588235" y="102.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,290.588235,102.588235)">192</text>
  <text x="129.294118" y="119.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,129.294118,119.294118)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lwp_season_mean</span></div><div class='xr-var-dims'>(model, season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-85d032d1-a0d9-4a1a-bf40-8627acbe2d0d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-85d032d1-a0d9-4a1a-bf40-8627acbe2d0d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c6096d9-8347-429c-af2b-c6a2fff1f1c5' class='xr-var-data-in' type='checkbox'><label for='data-6c6096d9-8347-429c-af2b-c6a2fff1f1c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Precipitation</dd><dt><span>comment :</span></dt><dd>includes both liquid and solid phases</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 28.69 MiB </td>
                        <td> 28.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 4, 192, 288) </td>
                        <td> (17, 4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 16 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="395" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="35" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="35" y1="0" x2="35" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 35.51355097190284,0.0 35.51355097190284,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.756775" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="55.513551" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,55.513551,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="105" y1="80" x2="120" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="105" y2="80" style="stroke-width:2" />
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 120.91413880186435,15.914138801864357 120.91413880186435,95.91413880186435 105.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="225" y2="0" style="stroke-width:2" />
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="225" y1="0" x2="240" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 225.0,0.0 240.91413880186437,15.914138801864357 120.91413880186435,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />
  <line x1="120" y1="95" x2="240" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />
  <line x1="240" y1="15" x2="240" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="120.91413880186435,15.914138801864357 240.91413880186434,15.914138801864357 240.91413880186434,95.91413880186435 120.91413880186435,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="180.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="260.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,260.914139,55.914139)">192</text>
  <text x="102.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lwp_season_model_mean</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-da68871e-369d-4d11-9598-5147fb9168ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-da68871e-369d-4d11-9598-5147fb9168ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eb11f039-8308-427b-bae0-c5eabd8d0799' class='xr-var-data-in' type='checkbox'><label for='data-eb11f039-8308-427b-bae0-c5eabd8d0799' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Precipitation</dd><dt><span>comment :</span></dt><dd>includes both liquid and solid phases</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>lwp_season_model_std</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-7ca3183f-6e22-4e58-ae96-03bc76255b06' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7ca3183f-6e22-4e58-ae96-03bc76255b06' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe9fd249-3b9a-45c0-8668-dd1c5cb50f53' class='xr-var-data-in' type='checkbox'><label for='data-fe9fd249-3b9a-45c0-8668-dd1c5cb50f53' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>g m-2</dd><dt><span>long_name :</span></dt><dd>Precipitation</dd><dt><span>comment :</span></dt><dd>includes both liquid and solid phases</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prsn</span></div><div class='xr-var-dims'>(model, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-a502993c-b2b4-480c-a916-72f04148a2b2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a502993c-b2b4-480c-a916-72f04148a2b2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a54ceda8-efb1-4fc9-9c40-a641c9f36521' class='xr-var-data-in' type='checkbox'><label for='data-a54ceda8-efb1-4fc9-9c40-a641c9f36521' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm day-1</dd><dt><span>long_name :</span></dt><dd>Snowfall</dd><dt><span>comment :</span></dt><dd>At surface; includes precipitation of all forms of water in the solid phase</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.52 GiB </td>
                        <td> 2.52 GiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 360, 192, 288) </td>
                        <td> (17, 360, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 16 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="424" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="34" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="34" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="34" y1="0" x2="34" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 34.15081328915008,0.0 34.15081328915008,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.075407" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="54.150813" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,54.150813,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="104" y1="64" x2="174" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="104" y2="64" style="stroke-width:2" />
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 174.58823529411765,70.58823529411765 174.58823529411765,134.58823529411765 104.0,64.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="200" y2="0" style="stroke-width:2" />
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="200" y1="0" x2="270" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 200.0,0.0 270.5882352941177,70.58823529411765 174.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />
  <line x1="174" y1="134" x2="270" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />
  <line x1="270" y1="70" x2="270" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="174.58823529411765,70.58823529411765 270.5882352941177,70.58823529411765 270.5882352941177,134.58823529411765 174.58823529411765,134.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="222.588235" y="154.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="290.588235" y="102.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,290.588235,102.588235)">192</text>
  <text x="129.294118" y="119.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,129.294118,119.294118)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prsn_season_mean</span></div><div class='xr-var-dims'>(model, season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-8bb13e79-1188-4835-99d7-fac381da2300' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8bb13e79-1188-4835-99d7-fac381da2300' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ef209414-af7c-4451-a1d2-126b92b73793' class='xr-var-data-in' type='checkbox'><label for='data-ef209414-af7c-4451-a1d2-126b92b73793' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm day-1</dd><dt><span>long_name :</span></dt><dd>Snowfall</dd><dt><span>comment :</span></dt><dd>At surface; includes precipitation of all forms of water in the solid phase</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 28.69 MiB </td>
                        <td> 28.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 4, 192, 288) </td>
                        <td> (17, 4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 16 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="395" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="35" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="35" y1="0" x2="35" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 35.51355097190284,0.0 35.51355097190284,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.756775" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="55.513551" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,55.513551,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="105" y1="80" x2="120" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="105" y2="80" style="stroke-width:2" />
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 120.91413880186435,15.914138801864357 120.91413880186435,95.91413880186435 105.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="225" y2="0" style="stroke-width:2" />
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="225" y1="0" x2="240" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 225.0,0.0 240.91413880186437,15.914138801864357 120.91413880186435,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />
  <line x1="120" y1="95" x2="240" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />
  <line x1="240" y1="15" x2="240" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="120.91413880186435,15.914138801864357 240.91413880186434,15.914138801864357 240.91413880186434,95.91413880186435 120.91413880186435,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="180.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="260.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,260.914139,55.914139)">192</text>
  <text x="102.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prsn_season_model_mean</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-961a52a6-2c61-4f70-838f-10caa9b3bba3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-961a52a6-2c61-4f70-838f-10caa9b3bba3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e28ee96a-5d73-4801-9e9a-21ee50bc85af' class='xr-var-data-in' type='checkbox'><label for='data-e28ee96a-5d73-4801-9e9a-21ee50bc85af' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm day-1</dd><dt><span>long_name :</span></dt><dd>Snowfall</dd><dt><span>comment :</span></dt><dd>At surface; includes precipitation of all forms of water in the solid phase</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>prsn_season_model_std</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-59ff4c0d-c57c-4d74-a5d4-a50a19402396' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-59ff4c0d-c57c-4d74-a5d4-a50a19402396' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5087746-c231-4473-b68b-e64056914e70' class='xr-var-data-in' type='checkbox'><label for='data-c5087746-c231-4473-b68b-e64056914e70' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>mm day-1</dd><dt><span>long_name :</span></dt><dd>Snowfall</dd><dt><span>comment :</span></dt><dd>At surface; includes precipitation of all forms of water in the solid phase</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas</span></div><div class='xr-var-dims'>(model, time, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 360, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-ec29f537-fb43-4f5b-bae4-5cc1957ca1b6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ec29f537-fb43-4f5b-bae4-5cc1957ca1b6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7110a2c0-a0fb-4a1f-bb1a-356b53379c20' class='xr-var-data-in' type='checkbox'><label for='data-7110a2c0-a0fb-4a1f-bb1a-356b53379c20' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>original_name :</span></dt><dd>TREFHT</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 2.52 GiB </td>
                        <td> 2.52 GiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 360, 192, 288) </td>
                        <td> (17, 360, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 3 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="424" height="184" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="34" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="34" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="34" y1="0" x2="34" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 34.15081328915008,0.0 34.15081328915008,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.075407" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="54.150813" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,54.150813,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="104" y1="64" x2="174" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="104" y2="64" style="stroke-width:2" />
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 174.58823529411765,70.58823529411765 174.58823529411765,134.58823529411765 104.0,64.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="104" y1="0" x2="200" y2="0" style="stroke-width:2" />
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="104" y1="0" x2="174" y2="70" style="stroke-width:2" />
  <line x1="200" y1="0" x2="270" y2="70" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="104.0,0.0 200.0,0.0 270.5882352941177,70.58823529411765 174.58823529411765,70.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="174" y1="70" x2="270" y2="70" style="stroke-width:2" />
  <line x1="174" y1="134" x2="270" y2="134" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="174" y1="70" x2="174" y2="134" style="stroke-width:2" />
  <line x1="270" y1="70" x2="270" y2="134" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="174.58823529411765,70.58823529411765 270.5882352941177,70.58823529411765 270.5882352941177,134.58823529411765 174.58823529411765,134.58823529411765" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="222.588235" y="154.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="290.588235" y="102.588235" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,290.588235,102.588235)">192</text>
  <text x="129.294118" y="119.294118" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,129.294118,119.294118)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas_season_mean</span></div><div class='xr-var-dims'>(model, season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(17, 4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-2007f7d6-2a37-4202-9edf-14c3e1f78054' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2007f7d6-2a37-4202-9edf-14c3e1f78054' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49754430-66fc-4678-bc92-21c704396ffc' class='xr-var-data-in' type='checkbox'><label for='data-49754430-66fc-4678-bc92-21c704396ffc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>original_name :</span></dt><dd>TREFHT</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 28.69 MiB </td>
                        <td> 28.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (17, 4, 192, 288) </td>
                        <td> (17, 4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 3 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="395" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="35" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="35" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="35" y1="0" x2="35" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 35.51355097190284,0.0 35.51355097190284,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="17.756775" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >17</text>
  <text x="55.513551" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,55.513551,12.706308)">1</text>


  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="105" y1="80" x2="120" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="105" y2="80" style="stroke-width:2" />
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 120.91413880186435,15.914138801864357 120.91413880186435,95.91413880186435 105.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="105" y1="0" x2="225" y2="0" style="stroke-width:2" />
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="105" y1="0" x2="120" y2="15" style="stroke-width:2" />
  <line x1="225" y1="0" x2="240" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="105.0,0.0 225.0,0.0 240.91413880186437,15.914138801864357 120.91413880186435,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="120" y1="15" x2="240" y2="15" style="stroke-width:2" />
  <line x1="120" y1="95" x2="240" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="120" y1="15" x2="120" y2="95" style="stroke-width:2" />
  <line x1="240" y1="15" x2="240" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="120.91413880186435,15.914138801864357 240.91413880186434,15.914138801864357 240.91413880186434,95.91413880186435 120.91413880186435,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="180.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="260.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,260.914139,55.914139)">192</text>
  <text x="102.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,102.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas_season_model_mean</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-dc1afec5-3ee7-4d3b-acfc-c74dd1f20614' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-dc1afec5-3ee7-4d3b-acfc-c74dd1f20614' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d56c22b8-a374-4be2-9cf1-9141eea563dc' class='xr-var-data-in' type='checkbox'><label for='data-d56c22b8-a374-4be2-9cf1-9141eea563dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>original_name :</span></dt><dd>TREFHT</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>tas_season_model_std</span></div><div class='xr-var-dims'>(season, lat, lon)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(4, 192, 288), meta=np.ndarray&gt;</div><input id='attrs-a23608e9-9422-4bf0-af77-acaa4c61a8bc' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a23608e9-9422-4bf0-af77-acaa4c61a8bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c395cbd-8304-49eb-8ffe-f5cb5289bdae' class='xr-var-data-in' type='checkbox'><label for='data-6c395cbd-8304-49eb-8ffe-f5cb5289bdae' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>units :</span></dt><dd>K</dd><dt><span>long_name :</span></dt><dd>Near-Surface Air Temperature</dd><dt><span>standard_name :</span></dt><dd>air_temperature</dd><dt><span>comment :</span></dt><dd>near-surface (usually, 2 meter) air temperature</dd><dt><span>original_name :</span></dt><dd>TREFHT</dd><dt><span>cell_methods :</span></dt><dd>area: time: mean</dd><dt><span>cell_measures :</span></dt><dd>area: areacella</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table>
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 1.69 MiB </td>
                        <td> 1.69 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (4, 192, 288) </td>
                        <td> (4, 192, 288) </td>
                    </tr>
                    <tr>
                        <th> Count </th>
                        <td> 2 Tasks </td>
                        <td> 1 Chunks </td>
                    </tr>
                    <tr>
                    <th> Type </th>
                    <td> float64 </td>
                    <td> numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="145" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="80" x2="25" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="80" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.914138801864357,15.914138801864357 25.914138801864357,95.91413880186435 10.0,80.0" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.91413880186437,15.914138801864357 25.914138801864357,15.914138801864357" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="95" x2="145" y2="95" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="95" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="95" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.914138801864357,15.914138801864357 145.91413880186437,15.914138801864357 145.91413880186437,95.91413880186435 25.914138801864357,95.91413880186435" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.914139" y="115.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" >288</text>
  <text x="165.914139" y="55.914139" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.914139,55.914139)">192</text>
  <text x="7.957069" y="107.957069" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.957069,107.957069)">4</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-388e63bd-0bad-4475-a01f-08da3456beb2' class='xr-section-summary-in' type='checkbox'  ><label for='section-388e63bd-0bad-4475-a01f-08da3456beb2' class='xr-section-summary' >Attributes: <span>(58)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>Conventions :</span></dt><dd>CF-1.7 CMIP-6.2</dd><dt><span>activity_id :</span></dt><dd>CMIP</dd><dt><span>branch_method :</span></dt><dd>standard</dd><dt><span>branch_time_in_child :</span></dt><dd>0.0</dd><dt><span>branch_time_in_parent :</span></dt><dd>0.0</dd><dt><span>cmor_version :</span></dt><dd>3.5.0</dd><dt><span>computational_acknowledgement :</span></dt><dd>The data were produced using resources of the National Energy Research Scientific Computing Center, a DOE Office of Science User Facility supported by the Office of Science of the U.S. Department of Energy under Contract No. DE-AC02-05CH11231.</dd><dt><span>contact :</span></dt><dd>Dave Bader (bader2@llnl.gov)</dd><dt><span>creation_date :</span></dt><dd>2019-12-11T17:36:11Z</dd><dt><span>data_specs_version :</span></dt><dd>01.00.31</dd><dt><span>doe_acknowledgement :</span></dt><dd>This research was supported as part of the Energy Exascale Earth System Model (E3SM) project, funded by the U.S. Department of Energy, Office of Science, Office of Biological and Environmental Research.</dd><dt><span>e3sm_paper_reference :</span></dt><dd>https://doi.org/10.1029/2018MS001603</dd><dt><span>e3sm_source_code_doi :</span></dt><dd>10.11578/E3SM/dc.20180418.36</dd><dt><span>e3sm_source_code_reference :</span></dt><dd>https://github.com/E3SM-Project/E3SM/releases/tag/v1.0.0</dd><dt><span>experiment :</span></dt><dd>all-forcing simulation of the recent past</dd><dt><span>experiment_id :</span></dt><dd>historical</dd><dt><span>external_variables :</span></dt><dd>areacella</dd><dt><span>forcing_index :</span></dt><dd>1</dd><dt><span>frequency :</span></dt><dd>mon</dd><dt><span>further_info_url :</span></dt><dd>https://furtherinfo.es-doc.org/CMIP6.E3SM-Project.E3SM-1-1.historical.none.r1i1p1f1</dd><dt><span>grid :</span></dt><dd>data regridded to a CMIP6 standard 1x1 degree lonxlat grid from the native grid using an area-average preserving method.</dd><dt><span>grid_label :</span></dt><dd>gr</dd><dt><span>history :</span></dt><dd>2019-12-11T17:36:11Z ;rewrote data to be consistent with CMIP for variable clivi found in table Amon.;
Output from 20181217.BDRD_CNPCTC20TR_OIBGC.ne30_oECv3.edison</dd><dt><span>initialization_index :</span></dt><dd>1</dd><dt><span>institution :</span></dt><dd>LLNL (Lawrence Livermore National Laboratory, Livermore, CA 94550, USA); ANL (Argonne National Laboratory, Argonne, IL 60439, USA); BNL (Brookhaven National Laboratory, Upton, NY 11973, USA); LANL (Los Alamos National Laboratory, Los Alamos, NM 87545, USA); LBNL (Lawrence Berkeley National Laboratory, Berkeley, CA 94720, USA); ORNL (Oak Ridge National Laboratory, Oak Ridge, TN 37831, USA); PNNL (Pacific Northwest National Laboratory, Richland, WA 99352, USA); SNL (Sandia National Laboratories, Albuquerque, NM 87185, USA). Mailing address: LLNL Climate Program, c/o David C. Bader, Principal Investigator, L-103, 7000 East Avenue, Livermore, CA 94550, USA</dd><dt><span>institution_id :</span></dt><dd>E3SM-Project</dd><dt><span>license :</span></dt><dd>CMIP6 model data produced by E3SM is licensed under a Creative Commons Attribution ShareAlike 4.0 International License (https://creativecommons.org/licenses). Consult https://pcmdi.llnl.gov/CMIP6/TermsOfUse for terms of use governing CMIP6 output, including citation requirements and proper acknowledgment. Further information about this data, including some limitations, can be found via the further_info_url (recorded as a global attribute in this file) and at https:///pcmdi.llnl.gov/. The data producers and data providers make no warranty, either express or implied, including, but not limited to, warranties of merchantability and fitness for a particular purpose. All liabilities arising from the supply of the information (including any liability arising in negligence) are excluded to the fullest extent permitted by law.</dd><dt><span>mip_era :</span></dt><dd>CMIP6</dd><dt><span>ncclimo_generation_command :</span></dt><dd>ncclimo --var=${var} -7 --dfl_lvl=1 --no_cll_msr --no_frm_trm --no_stg_grd --yr_srt=1 --yr_end=500 --ypf=25 --map=map_ne30np4_to_cmip6_180x360_aave.20181001.nc </dd><dt><span>ncclimo_version :</span></dt><dd>4.8.1-alpha04</dd><dt><span>nominal_resolution :</span></dt><dd>100 km</dd><dt><span>parent_activity_id :</span></dt><dd>CMIP</dd><dt><span>parent_experiment_id :</span></dt><dd>piControl</dd><dt><span>parent_mip_era :</span></dt><dd>CMIP6</dd><dt><span>parent_source_id :</span></dt><dd>E3SM-1-1</dd><dt><span>parent_time_units :</span></dt><dd>days since 0001-01-01</dd><dt><span>parent_variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>physics_index :</span></dt><dd>1</dd><dt><span>product :</span></dt><dd>model-output</dd><dt><span>realization_index :</span></dt><dd>1</dd><dt><span>realm :</span></dt><dd>atmos</dd><dt><span>references :</span></dt><dd>Burrows S.M., M.E. Maltrud, X. Yang, Q. Zhu, N. Jeffery, X. Shi, and D.M. Ricciuto, et al. 2019. &#x27;The DOE E3SM coupled model v1.1 biogeochemistry configuration: overview and evaluation of coupled carbon-climate experiments.&#x27; Journal of Advances in Modeling Earth Systems. In review; http://e3sm.org</dd><dt><span>source :</span></dt><dd>E3SM 1.1 (2019): 
aerosol: MAM4 with resuspension, marine organics, and secondary organics (same grid as atmos)
atmos: EAM (v1.1, cubed sphere spectral-element grid; 5400 elements with p=3; 1 deg average grid spacing; 90 x 90 x 6 longitude/latitude/cubeface; 72 levels; top level 0.1 hPa)
atmosChem: Troposphere specified oxidants for aerosols. Stratosphere linearized interactive ozone (LINOZ v2) (same grid as atmos)
land: ELM (v1.1, same grid as atmos; active biogeochemistry using the Converging Trophic Cascade plant and soil carbon and nutrient mechanisms to represent carbon, nitrogen and phosphorus cycles), MOSART (v1.1, 0.5 degree latitude/longitude grid)
landIce: none
ocean: MPAS-Ocean (v6.0, oEC60to30 unstructured SVTs mesh with 235160 cells and 714274 edges, variable resolution 60 km to 30 km; 60 levels; top grid cell 0-10 m)
ocnBgchem: BEC (Biogeochemical Elemental Cycling model, NPZD-type with C/N/P/Fe/Si/O; same grid as ocean)
seaIce: MPAS-Seaice (v6.0; same grid as ocean)</dd><dt><span>source_id :</span></dt><dd>E3SM-1-1</dd><dt><span>source_type :</span></dt><dd>AOGCM BGC AER</dd><dt><span>status :</span></dt><dd>2020-01-22;created; by gcs.cmip6.ldeo@gmail.com</dd><dt><span>sub_experiment :</span></dt><dd>none</dd><dt><span>sub_experiment_id :</span></dt><dd>none</dd><dt><span>table_id :</span></dt><dd>Amon</dd><dt><span>table_info :</span></dt><dd>Creation Date:(24 July 2019) MD5:c93735846d66458966fc81f390b2d714</dd><dt><span>title :</span></dt><dd>E3SM-1-1 output prepared for CMIP6</dd><dt><span>tracking_id :</span></dt><dd>hdl:21.14100/1a0692a9-17c2-4083-bcd2-bb0080811448
hdl:21.14100/96714d84-e83d-4ab4-ab12-18d281589f77
hdl:21.14100/0f671f58-90b9-4e74-bcd6-f465926c9908
hdl:21.14100/308a566b-f86e-4b85-91e0-cd217691e602
hdl:21.14100/0a3a9799-d565-4282-8461-632118a5910b
hdl:21.14100/ccd8995b-acb4-47b4-9fd9-1a4f3e406fc3
hdl:21.14100/b5efd7e8-3260-4e2e-bdda-ba87c45dc1f2
hdl:21.14100/b3d56662-6bcb-4fb6-b24c-b0798dbdbd45
hdl:21.14100/644ae8da-311c-49b6-a052-3c529b8b8ad7
hdl:21.14100/9fcd7240-3149-4bac-9317-759bd41adba0
hdl:21.14100/39f56639-d540-448b-8120-9071192a51a5
hdl:21.14100/a3b1d79f-a568-4bd0-95fb-01e28a3935d5
hdl:21.14100/ca79808b-e7ed-4a96-b67a-7d65f8274870
hdl:21.14100/ae61a851-b06b-4f35-a179-f632ed9915a2
hdl:21.14100/c5f38be4-e6cb-4018-89e9-0575a0a8b3ed
hdl:21.14100/7555a2c1-7a2c-4bb5-bf74-e5f95858f714
hdl:21.14100/cf29ccf6-1332-4be2-a0c0-505d3ea2c2aa</dd><dt><span>variable_id :</span></dt><dd>clivi</dd><dt><span>variant_label :</span></dt><dd>r1i1p1f1</dd><dt><span>netcdf_tracking_ids :</span></dt><dd>hdl:21.14100/1a0692a9-17c2-4083-bcd2-bb0080811448
hdl:21.14100/96714d84-e83d-4ab4-ab12-18d281589f77
hdl:21.14100/0f671f58-90b9-4e74-bcd6-f465926c9908
hdl:21.14100/308a566b-f86e-4b85-91e0-cd217691e602
hdl:21.14100/0a3a9799-d565-4282-8461-632118a5910b
hdl:21.14100/ccd8995b-acb4-47b4-9fd9-1a4f3e406fc3
hdl:21.14100/b5efd7e8-3260-4e2e-bdda-ba87c45dc1f2
hdl:21.14100/b3d56662-6bcb-4fb6-b24c-b0798dbdbd45
hdl:21.14100/644ae8da-311c-49b6-a052-3c529b8b8ad7
hdl:21.14100/9fcd7240-3149-4bac-9317-759bd41adba0
hdl:21.14100/39f56639-d540-448b-8120-9071192a51a5
hdl:21.14100/a3b1d79f-a568-4bd0-95fb-01e28a3935d5
hdl:21.14100/ca79808b-e7ed-4a96-b67a-7d65f8274870
hdl:21.14100/ae61a851-b06b-4f35-a179-f632ed9915a2
hdl:21.14100/c5f38be4-e6cb-4018-89e9-0575a0a8b3ed
hdl:21.14100/7555a2c1-7a2c-4bb5-bf74-e5f95858f714
hdl:21.14100/cf29ccf6-1332-4be2-a0c0-505d3ea2c2aa</dd><dt><span>version_id :</span></dt><dd>v20191211</dd><dt><span>intake_esm_varname :</span></dt><dd>clivi</dd><dt><span>intake_esm_dataset_key :</span></dt><dd>CMIP.E3SM-Project.E3SM-1-1.historical.Amon.gr</dd></dl></div></li></ul></div></div></div></div>
</div>
</section>
<section id="supercooled-liquid-water-fraction">
<h2>Supercooled liquid water fraction<a class="headerlink" href="#supercooled-liquid-water-fraction" title="Permalink to this headline">#</a></h2>
<div class="math notranslate nohighlight">
\[SLF = \frac{\text{cloud liquid water content}}{\text{cloud liquid water content} + \text{cloud ice water content}}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ds_cmip[&#39;SLF&#39;] = ds_cmip[&#39;clw&#39;]/(ds_cmip[&#39;cli&#39;] + ds_cmip[&#39;clw&#39;])</span>
<span class="c1"># ds_cmip[&#39;SLF&#39;].attrs = {&#39;units&#39;: &#39;&#39;, &#39;long_name&#39;:&#39;Super cooled liquid water fraction&#39;}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # ds_cmip[&#39;SLF&#39;] = fct.set4D_latitude_values_nan(ds_cmip[&#39;SLF&#39;], 45, -45)</span>

<span class="c1"># # find only SLF where snowfall</span>
<span class="c1"># ds_cmip[&#39;SLF_sf&#39;] = ds_cmip[&#39;SLF&#39;].where((ds_cmip[&#39;prsn&#39;] * 3600/86400) &gt;= 0.01)</span>
<span class="c1"># ds_cmip[&#39;SLF_sf&#39;] = ds_cmip[&#39;SLF_sf&#39;].sortby(&#39;latitude&#39;, ascending=True)</span>
<span class="c1"># ds_cmip[&#39;SLF_sf&#39;] = ds_cmip[&#39;SLF_sf&#39;].groupby(&#39;time.season&#39;).mean((&#39;time&#39;, &#39;longitude&#39;), skipna=True)</span>

<span class="c1"># fig, axsm = plt.subplots(2,2, sharex=True, sharey=True, figsize=[15, 7.5])</span>
<span class="c1"># for ax, sea in zip(axsm.flatten(), ds_cmip[&#39;SLF_sf&#39;].season):</span>
<span class="c1">#     cf = ds_cmip[&#39;SLF_sf&#39;].sel(season=sea).plot(ax=ax,x=&#39;latitude&#39;, y=&#39;level&#39;, cmap=cm.tokyo_r, levels=np.arange(0,1.1,0.1), ylim= [1000, 1], yincrease=False, add_colorbar=False)</span>
<span class="c1">#     ax.grid()</span>
<span class="c1">#     ax.set(title=&#39;season = {}&#39;.format(sea.values), ylabel=&#39;Pressure [hPa]&#39;, xlabel=&#39;Latitude&#39;)</span>
    

<span class="c1"># fig.suptitle(&#39;ERA5 ({} - {})&#39;.format(starty, endy), fontweight=&quot;bold&quot;)</span>
<span class="c1"># cbaxes = fig.add_axes([0.1, 0.0, 0.8, 0.025])</span>
<span class="c1"># cbar = plt.colorbar(cf, cax=cbaxes, shrink=0.5, orientation=&#39;horizontal&#39;, label=&#39;Supercooled liquid water fraction&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="statistics">
<h2>Statistics<a class="headerlink" href="#statistics" title="Permalink to this headline">#</a></h2>
<p>For variables:</p>
<ul class="simple">
<li><p>Snowfall [sf]</p></li>
<li><p>Total column cloud liquid, supercooled liqid, and rain water [tclslrw]</p></li>
<li><p>Total column cloud ice, snow water [tcisw]</p></li>
<li><p>2m-Temperature [2t]</p></li>
</ul>
<ol class="simple">
<li><p>Find where liquid water path is <span class="math notranslate nohighlight">\(\ge\)</span> 5 g m-2</p></li>
<li><p>Find where snowfall is <span class="math notranslate nohighlight">\(\ge\)</span> 0.01mm h-1</p></li>
<li><p>Find where 2m-temperature <span class="math notranslate nohighlight">\(\le\)</span> 0 <span class="math notranslate nohighlight">\(^o\)</span> C</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">set4D_latitude_values_nan</span><span class="p">(</span><span class="n">array</span><span class="p">,</span> <span class="n">upper_lat</span><span class="p">,</span> <span class="n">lower_lat</span><span class="p">):</span>
    <span class="n">array</span><span class="p">[:,:,</span><span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span> <span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)),</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">array</span><span class="p">[:,:,</span><span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span> <span class="p">:</span>\
                                           <span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)),</span> <span class="p">:])</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span>
                          <span class="n">fill_value</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">),</span>
             <span class="n">dims</span><span class="o">=</span><span class="p">(</span><span class="n">array</span><span class="p">[:,:,</span><span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span> <span class="p">:</span>\
                             <span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)),</span> <span class="p">:])</span><span class="o">.</span><span class="n">dims</span><span class="p">,</span>
             <span class="n">coords</span><span class="o">=</span><span class="p">(</span><span class="n">array</span><span class="p">[:,:,</span><span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">))</span> <span class="p">:</span>\
                               <span class="nb">int</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&gt;</span><span class="n">lower_lat</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">&lt;</span><span class="n">upper_lat</span><span class="p">))</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">)),</span> <span class="p">:])</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">array</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">set4D_latitude_values_nan</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">],</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">set4D_latitude_values_nan</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">],</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">set4D_latitude_values_nan</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">],</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">)</span>
<span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span>   <span class="o">=</span> <span class="n">set4D_latitude_values_nan</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">],</span> <span class="mi">45</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. find where LWP &gt;=5 gm-2</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">lwp</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">iwp</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;clivi&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;lwp&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># 2. find where snowfall &gt;= 0.01mmh-1</span>
<span class="n">unit_sf</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;prsn&#39;</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="mi">3600</span><span class="o">/</span><span class="mi">86400</span><span class="p">)</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unit_sf</span><span class="o">&gt;</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">lwp</span> <span class="o">=</span> <span class="n">lwp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unit_sf</span><span class="o">&gt;</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">iwp</span> <span class="o">=</span> <span class="n">iwp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unit_sf</span><span class="o">&gt;</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">unit_sf</span><span class="o">&gt;</span><span class="mf">0.01</span><span class="p">)</span>

<span class="c1"># 3. find where 2m-temperature &lt;= 0C</span>
<span class="n">sf</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">273.15</span><span class="p">)</span>
<span class="n">lwp</span> <span class="o">=</span> <span class="n">lwp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">273.15</span><span class="p">)</span>
<span class="n">iwp</span> <span class="o">=</span> <span class="n">iwp</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">273.15</span><span class="p">)</span>
<span class="n">t2</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="s1">&#39;tas&#39;</span><span class="p">]</span><span class="o">&lt;=</span><span class="mf">273.15</span><span class="p">)</span>

<span class="c1"># count occurences per season</span>
<span class="n">sf_count</span> <span class="o">=</span> <span class="n">sf</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">lwp_count</span> <span class="o">=</span> <span class="n">lwp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">iwp_count</span> <span class="o">=</span> <span class="n">iwp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t2_count</span> <span class="o">=</span> <span class="n">t2</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span><span class="n">levels</span><span class="p">,</span><span class="n">cbar_label</span><span class="p">,</span><span class="n">plt_title</span><span class="p">):</span>

    <span class="n">f</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">figsize</span> <span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">NorthPolarStereo</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span><span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">)})</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[:</span><span class="mi">4</span><span class="p">],</span> <span class="n">variable</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s1">&#39;season = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>   <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">variable</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hawaii_r</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">variable</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">SouthPolarStereo</span><span class="p">(</span><span class="n">central_longitude</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">globe</span><span class="o">=</span><span class="kc">None</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_feature</span><span class="p">(</span><span class="n">cy</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">COASTLINE</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_extent</span><span class="p">([</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">45</span><span class="p">],</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">())</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span><span class="s1">&#39;season = </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
        <span class="n">gl</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">gridlines</span><span class="p">(</span><span class="n">draw_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>   <span class="o">=</span> <span class="kc">False</span>
        <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">cf</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hawaii_r</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>

    <span class="n">cbaxes</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.0125</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">])</span>
    <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cf</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbaxes</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">extend</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">cbar_label</span><span class="p">)</span>
    <span class="n">f</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">plt_title</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">);</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">w_pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">h_pad</span><span class="o">=</span><span class="mf">0.</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">sf_count</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">]:</span>

    <span class="c1"># snowfall event occurance</span>
    <span class="n">plt_seasonal_NH_SH</span><span class="p">((</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">))</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="n">cbar_label</span> <span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> frequency (month)&#39;</span><span class="p">,</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) Count of months where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

    <span class="c1"># snowfall divided by ice water path</span>
    <span class="n">sf_iwp</span> <span class="o">=</span> <span class="p">((</span><span class="n">sf</span><span class="o">/</span><span class="p">(</span><span class="n">iwp</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_iwp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0475</span><span class="p">,</span><span class="mf">0.0025</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;precipitation efficency ()&#39;</span><span class="p">,</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Snowfall/IWP (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

    <span class="c1"># snowfall divided by the sum of ice and liquid water path</span>
    <span class="n">sf_iwp_lwp</span> <span class="o">=</span> <span class="p">((</span><span class="n">sf</span><span class="o">/</span><span class="p">(</span><span class="n">lwp</span><span class="o">+</span><span class="n">iwp</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
    <span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_iwp_lwp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0475</span><span class="p">,</span><span class="mf">0.0025</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;precipiation efficency ()&#39;</span><span class="p">,</span> <span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> Snowfall/(IWP + LWP) (</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

    <span class="c1"># liquid water path</span>
    <span class="n">lwp_season</span> <span class="o">=</span> <span class="n">lwp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">lwp_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]),</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) Count of months where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/CMIP6_hr_1985-2014_43_0.png" src="../_images/CMIP6_hr_1985-2014_43_0.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_1.png" src="../_images/CMIP6_hr_1985-2014_43_1.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_2.png" src="../_images/CMIP6_hr_1985-2014_43_2.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_3.png" src="../_images/CMIP6_hr_1985-2014_43_3.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_4.png" src="../_images/CMIP6_hr_1985-2014_43_4.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_5.png" src="../_images/CMIP6_hr_1985-2014_43_5.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_6.png" src="../_images/CMIP6_hr_1985-2014_43_6.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_7.png" src="../_images/CMIP6_hr_1985-2014_43_7.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_8.png" src="../_images/CMIP6_hr_1985-2014_43_8.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_9.png" src="../_images/CMIP6_hr_1985-2014_43_9.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_10.png" src="../_images/CMIP6_hr_1985-2014_43_10.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_11.png" src="../_images/CMIP6_hr_1985-2014_43_11.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_12.png" src="../_images/CMIP6_hr_1985-2014_43_12.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_13.png" src="../_images/CMIP6_hr_1985-2014_43_13.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_14.png" src="../_images/CMIP6_hr_1985-2014_43_14.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_15.png" src="../_images/CMIP6_hr_1985-2014_43_15.png" />
<img alt="../_images/CMIP6_hr_1985-2014_43_16.png" src="../_images/CMIP6_hr_1985-2014_43_16.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> frequency (month)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],),</span> <span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA5 </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) Count of months where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

<span class="n">sf_iwp</span> <span class="o">=</span> <span class="p">((</span><span class="n">sf</span><span class="o">/</span><span class="p">(</span><span class="n">iwp</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_iwp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0475</span><span class="p">,</span><span class="mf">0.0025</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;precipitation efficency ()&#39;</span><span class="p">,</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA5 Snowfall/IWP (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

<span class="n">sf_iwp_lwp</span> <span class="o">=</span> <span class="p">((</span><span class="n">sf</span><span class="o">/</span><span class="p">(</span><span class="n">lwp</span><span class="o">+</span><span class="n">iwp</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_iwp_lwp</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0475</span><span class="p">,</span><span class="mf">0.0025</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;precipiation efficency ()&#39;</span><span class="p">,</span> <span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA Snowfall/(IWP + LWP) (</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">) where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

<span class="n">lwp_season</span> <span class="o">=</span> <span class="n">lwp</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">,</span><span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">lwp_season</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;units&#39;</span><span class="p">]),</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA5 </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) Count of months where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lwp_season</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">uio</span><span class="o">/</span><span class="n">kant</span><span class="o">/</span><span class="n">geo</span><span class="o">-</span><span class="n">metos</span><span class="o">-</span><span class="n">u1</span><span class="o">/</span><span class="n">franzihe</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">Python</span><span class="o">/</span><span class="n">globalsnow</span><span class="o">/</span><span class="n">CloudSat_ERA5_CMIP6_analysis</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">cmip</span><span class="o">/</span><span class="n">CMIP6_hr_1985</span><span class="o">-</span><span class="mf">2014.</span><span class="n">ipynb</span> <span class="n">Cell</span> <span class="mi">44</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=0&#39;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">),</span> <span class="n">levels</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> frequency (month)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],),</span> <span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA5 </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) Count of months where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sf_count</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sf_count</span><span class="o">&gt;</span><span class="mf">0.</span><span class="p">)</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;long_name&#39;</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=2&#39;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">sf_iwp</span> <span class="o">=</span> <span class="p">((</span><span class="n">sf</span><span class="o">/</span><span class="p">(</span><span class="n">iwp</span><span class="p">))</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=3&#39;</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">plt_seasonal_NH_SH</span><span class="p">(</span><span class="n">sf_iwp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0475</span><span class="p">,</span><span class="mf">0.0025</span><span class="p">),</span><span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;precipitation efficency ()&#39;</span><span class="p">,</span><span class="n">plt_title</span><span class="o">=</span><span class="s1">&#39;ERA5 Snowfall/IWP (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">) where sf &gt;= 7.2mm&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span><span class="n">endy</span><span class="p">))</span>

<span class="nn">/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb Cell 44</span> in <span class="ni">plt_seasonal_NH_SH</span><span class="nt">(variable, levels, cbar_label, plt_title)</span>
     <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=9&#39;</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>     <span class="n">gl</span><span class="o">.</span><span class="n">top_labels</span>   <span class="o">=</span> <span class="kc">False</span>
     <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=10&#39;</span><span class="o">&gt;</span><span class="mi">11</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>     <span class="n">gl</span><span class="o">.</span><span class="n">right_labels</span> <span class="o">=</span> <span class="kc">False</span>
<span class="o">---&gt;</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=11&#39;</span><span class="o">&gt;</span><span class="mi">12</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>     <span class="n">variable</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
     <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=12&#39;</span><span class="o">&gt;</span><span class="mi">13</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>                         <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">hawaii_r</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">)</span>
     <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=14&#39;</span><span class="o">&gt;</span><span class="mi">15</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span> <span class="n">variable</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
     <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2Bmimi.uio.no/uio/kant/geo-metos-u1/franzihe/Documents/Python/globalsnow/CloudSat_ERA5_CMIP6_analysis/work/cmip/CMIP6_hr_1985-2014.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=15&#39;</span><span class="o">&gt;</span><span class="mi">16</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>     <span class="n">ax</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/xarray/plot/plot.py:866,</span> in <span class="ni">_PlotMethods.__call__</span><span class="nt">(self, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">865</span> <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">866</span>     <span class="k">return</span> <span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_da</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/xarray/plot/plot.py:332,</span> in <span class="ni">plot</span><span class="nt">(darray, row, col, col_wrap, ax, hue, rtol, subplot_kws, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">328</span>     <span class="n">plotfunc</span> <span class="o">=</span> <span class="n">hist</span>
<span class="g g-Whitespace">    </span><span class="mi">330</span> <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;ax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span>
<span class="ne">--&gt; </span><span class="mi">332</span> <span class="k">return</span> <span class="n">plotfunc</span><span class="p">(</span><span class="n">darray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/xarray/plot/plot.py:557,</span> in <span class="ni">hist</span><span class="nt">(darray, figsize, size, aspect, ax, xincrease, yincrease, xscale, yscale, xticks, yticks, xlim, ylim, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">554</span> <span class="n">no_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ravel</span><span class="p">(</span><span class="n">darray</span><span class="o">.</span><span class="n">to_numpy</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">555</span> <span class="n">no_nan</span> <span class="o">=</span> <span class="n">no_nan</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">notnull</span><span class="p">(</span><span class="n">no_nan</span><span class="p">)]</span>
<span class="ne">--&gt; </span><span class="mi">557</span> <span class="n">primitive</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">no_nan</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">559</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">darray</span><span class="o">.</span><span class="n">_title_for_slice</span><span class="p">())</span>
<span class="g g-Whitespace">    </span><span class="mi">560</span> <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">label_from_attrs</span><span class="p">(</span><span class="n">darray</span><span class="p">))</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/matplotlib/__init__.py:1412,</span> in <span class="ni">_preprocess_data.&lt;locals&gt;.inner</span><span class="nt">(ax, data, *args, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">1409</span> <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1410</span> <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1411</span>     <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1412</span>         <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="nb">map</span><span class="p">(</span><span class="n">sanitize_sequence</span><span class="p">,</span> <span class="n">args</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1414</span>     <span class="n">bound</span> <span class="o">=</span> <span class="n">new_sig</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1415</span>     <span class="n">auto_label</span> <span class="o">=</span> <span class="p">(</span><span class="n">bound</span><span class="o">.</span><span class="n">arguments</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label_namer</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1416</span>                   <span class="ow">or</span> <span class="n">bound</span><span class="o">.</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label_namer</span><span class="p">))</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/matplotlib/axes/_axes.py:6791,</span> in <span class="ni">Axes.hist</span><span class="nt">(self, x, bins, range, density, weights, cumulative, bottom, histtype, align, orientation, rwidth, log, color, label, stacked, **kwargs)</span>
<span class="g g-Whitespace">   </span><span class="mi">6789</span> <span class="k">if</span> <span class="n">patch</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6790</span>     <span class="n">p</span> <span class="o">=</span> <span class="n">patch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="ne">-&gt; </span><span class="mi">6791</span>     <span class="n">p</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">6792</span>     <span class="k">if</span> <span class="n">lbl</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">6793</span>         <span class="n">p</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">lbl</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/geocat/lib/python3.9/site-packages/matplotlib/artist.py:1064,</span> in <span class="ni">Artist.update</span><span class="nt">(self, props)</span>
<span class="g g-Whitespace">   </span><span class="mi">1062</span>             <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;set_</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1063</span>             <span class="k">if</span> <span class="ow">not</span> <span class="n">callable</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
<span class="ne">-&gt; </span><span class="mi">1064</span>                 <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">!r}</span><span class="s2"> object &quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">1065</span>                                      <span class="sa">f</span><span class="s2">&quot;has no property </span><span class="si">{</span><span class="n">k</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1066</span>             <span class="n">ret</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">v</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1067</span> <span class="k">if</span> <span class="n">ret</span><span class="p">:</span>

<span class="ne">AttributeError</span>: &#39;Rectangle&#39; object has no property &#39;add_colorbar&#39;
</pre></div>
</div>
<img alt="../_images/CMIP6_hr_1985-2014_45_1.png" src="../_images/CMIP6_hr_1985-2014_45_1.png" />
</div>
</div>
</section>
<section id="find-mixed-phase-clouds">
<h2>Find mixed-phase clouds<a class="headerlink" href="#find-mixed-phase-clouds" title="Permalink to this headline">#</a></h2>
<p>Calculate the IWC/LWC statistics given by the values. Setting the value to 0.5 will find the level in the atmosphere where IWC and LWC are 50/50. Setting it to a value of 0.7 will find the level where IWC is 70% while LWC is 30%.</p>
<ol class="simple">
<li><p>find the fraction of IWC to LWC
$<span class="math notranslate nohighlight">\(fraction = \frac{IWC}{IWC + LWC}\)</span>$</p></li>
<li><p>find the nearest value to given IWC-fraction</p></li>
<li><p>find atmospheric pressure levels where IWC/LWC fraction occurs</p></li>
<li><p>find the index of the first atmospheric pressure level</p></li>
<li><p>use the index to select variables</p></li>
</ol>
</section>
<section id="create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics">
<h2>Create dictionary from the list of datasets we want to use for the IWC/LWC statistics<a class="headerlink" href="#create-dictionary-from-the-list-of-datasets-we-want-to-use-for-the-iwc-lwc-statistics" title="Permalink to this headline">#</a></h2>
<p>Calculate the IWC/LWC statistics given by the values. Setting the value to 0.5 will find the level in the atmosphere where IWC and LWC are 50/50. Setting it to a value of 0.7 will find the level where IWC is 70% while LWC is 30%.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_ds</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dset_dict2</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
<span class="n">_coord</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dset_dict2</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">ds_cmip_1deg</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">objs</span><span class="o">=</span><span class="n">_ds</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="n">_coord</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;concat_dim&#39;</span><span class="p">:</span><span class="s1">&#39;stat&#39;</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exploratory-data-analysis-a-id-exploratory-a">
<h1>3. Exploratory Data Analysis <a id='exploratory'></a><a class="headerlink" href="#exploratory-data-analysis-a-id-exploratory-a" title="Permalink to this headline">#</a></h1>
<section id="create-seasonal-mean-of-all-regridded-models">
<h2>Create seasonal mean of all regridded models<a class="headerlink" href="#create-seasonal-mean-of-all-regridded-models" title="Permalink to this headline">#</a></h2>
<p>…and plot seasonal mean of each individual model</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">ds_cmip</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">ds_cmip</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">seasonal_mean_std</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract the variable name similar to ERA5 for plotting</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">to_era_variable</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]]</span>

<span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="n">fct</span><span class="o">.</span><span class="n">plt_spatial_seasonal_mean</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">),</span> <span class="n">var</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> MEAN (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-model-mean-spread-of-seasonal-mean-of-all-regridded-models">
<h2>Create model mean/spread of seasonal mean of all regridded models<a class="headerlink" href="#create-model-mean-spread-of-seasonal-mean-of-all-regridded-models" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_std&#39;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="s1">&#39;model&#39;</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_spatial_seasonal_mean</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_mean&#39;</span><span class="p">],</span> <span class="n">var</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;CMIP6 - high resolution (1985 - 2014)&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MEAN - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)]),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
         <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
            <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.38</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
            <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
    

<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_mean_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">,</span> <span class="n">im</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_spatial_seasonal_mean</span><span class="p">(</span><span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_mean&#39;</span><span class="p">],</span> <span class="n">var</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;CMIP6 - high resolution (1985 - 2014)&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">cb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;MEAN - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)]),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>



<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
    <span class="n">sm</span> <span class="o">=</span> <span class="n">ds_cmip</span><span class="p">[</span><span class="n">variable_id</span><span class="p">[</span><span class="n">variable_id</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;prsn&#39;</span><span class="p">)]</span><span class="o">+</span><span class="s1">&#39;_season_model_std&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span> 
                                                                      <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                                                      <span class="n">vmin</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;vmin_std&#39;</span><span class="p">)],</span> 
                                                                      <span class="n">vmax</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;vmax_std&#39;</span><span class="p">)],</span>
                                                                       <span class="n">levels</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
                                                                      <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">lajolla</span><span class="p">,</span>
                                                                      <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    
<span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">1.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
<span class="n">sb</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sm</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="n">fraction</span><span class="o">=</span><span class="mf">0.046</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.04</span><span class="p">)</span>
<span class="n">sb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;STD - </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="n">var</span><span class="p">][</span><span class="n">fct</span><span class="o">.</span><span class="n">plt_dict</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)]),</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.12</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
         <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">5</span><span class="p">:</span><span class="mi">10</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
            <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mf">0.38</span><span class="p">,</span> <span class="n">ds_cmip</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">tolist</span><span class="p">()[</span><span class="mi">10</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> 
            <span class="n">transform</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">bbox</span> <span class="o">=</span><span class="p">{</span><span class="s1">&#39;facecolor&#39;</span><span class="p">:</span><span class="s1">&#39;green&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;alpha&#39;</span><span class="p">:</span><span class="mf">0.6</span><span class="p">,</span>
                    <span class="s1">&#39;pad&#39;</span><span class="p">:</span><span class="mi">5</span><span class="p">})</span>
<span class="c1"># save figure to png</span>
<span class="n">figdir</span> <span class="o">=</span> <span class="s1">&#39;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/CMIP6/&#39;</span>
<span class="n">figname</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_season_mean_std_1deg_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">.png&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figdir</span> <span class="o">+</span> <span class="n">figname</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">transparent</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save to netcdf</span>
<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">variable_id</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">savepath</span> <span class="o">=</span> <span class="s1">&#39;/scratch/franzihe/output/CMIP6_hist/1deg/&#39;</span>
<span class="n">nc_out</span> <span class="o">=</span> <span class="n">savepath</span> <span class="o">+</span> <span class="n">filename</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">nc_out</span><span class="p">)</span>

<span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="c1"># Save to netcdf file</span>
<span class="k">if</span> <span class="n">nc_out</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
<span class="c1">#     print(&#39;{} is downloaded&#39;.format(nc_out))</span>
<span class="c1">#     counter += 1</span>
<span class="c1">#     print(&#39;Have saved in total: {:} files&#39;.format(str(counter)))</span>
<span class="c1"># else:</span>
    <span class="n">ds_cmip</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">nc_out</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file written: .</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">nc_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references-a-id-references-a">
<h1>References <a id='references'></a><a class="headerlink" href="#references-a-id-references-a" title="Permalink to this headline">#</a></h1>
<p>[1] Zelinka, M. D., Myers, T. A., McCoy, D. T., Po-Chedley, S., Caldwell, P. M., Ceppi, P., et al. (2020). Causes of higher climate sensitivity in CMIP6 models. Geophysical Research Letters, 47, e2019GL085782. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019GL085782">https://doi-org.ezproxy.uio.no/10.1029/2019GL085782</a></p>
<p>[2] Bjordal, J., Storelvmo, T., Alterskjær, K. et al. Equilibrium climate sensitivity above 5 °C plausible due to state-dependent cloud feedback. Nat. Geosci. 13, 718–721 (2020). <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1">https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1</a></p>
<p>[3] Wu, T., Lu, Y., Fang, Y., Xin, X., Li, L., Li, W., Jie, W., Zhang, J., Liu, Y., Zhang, L., Zhang, F., Zhang, Y., Wu, F., Li, J., Chu, M., Wang, Z., Shi, X., Liu, X., Wei, M., Huang, A., Zhang, Y., and Liu, X.: The Beijing Climate Center Climate System Model (BCC-CSM): the main progress from CMIP5 to CMIP6 , Geosci. Model Dev., 12, 1573–1600, <a class="reference external" href="https://doi.org/10.5194/gmd-12-1573-2019">https://doi.org/10.5194/gmd-12-1573-2019</a>, 2019.</p>
<p>[4] Lee, W.-L., Wang, Y.-C., Shiu, C.-J., Tsai, I., Tu, C.-Y., Lan, Y.-Y., Chen, J.-P., Pan, H.-L., and Hsu, H.-H.: Taiwan Earth System Model Version 1: description and evaluation of mean state, Geosci. Model Dev., 13, 3887–3904, <a class="reference external" href="https://doi.org/10.5194/gmd-13-3887-2020">https://doi.org/10.5194/gmd-13-3887-2020</a>, 2020.</p>
<p>[5] Bian HE, Yongqiang YU, Qing BAO, Pengfei LIN, Hailong LIU, Jinxiao LI, Lei WANG, Yimin LIU, Guoxiong WU, Kangjun CHEN, Yuyang GUO, Shuwen ZHAO, Xiaoqi ZHANG, Mirong SONG &amp; Jinbo XIE (2020) CAS FGOALS-f3-L model dataset descriptions for CMIP6 DECK experiments, Atmospheric and Oceanic Science Letters, 13:6, 582-588, DOI: 10.1080/16742834.2020.1778419</p>
<p>[6] Cherchi, A., Fogli, P. G., Lovato, T., Peano, D., Iovino, D., Gualdi, S., et al. (2019). Global mean climate and main patterns of variability in the CMCC-CM2 coupled model. Journal of Advances in Modeling Earth Systems, 11, 185– 209. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2018MS001369">https://doi-org.ezproxy.uio.no/10.1029/2018MS001369</a></p>
<p>[7] van Noije, T., Bergman, T., Le Sager, P., O’Donnell, D., Makkonen, R., Gonçalves-Ageitos, M., Döscher, R., Fladrich, U., von Hardenberg, J., Keskinen, J.-P., Korhonen, H., Laakso, A., Myriokefalitakis, S., Ollinaho, P., Pérez García-Pando, C., Reerink, T., Schrödner, R., Wyser, K., and Yang, S.: EC-Earth3-AerChem: a global climate model with interactive aerosols and atmospheric chemistry participating in CMIP6 , Geosci. Model Dev., 14, 5637–5668, <a class="reference external" href="https://doi.org/10.5194/gmd-14-5637-2021">https://doi.org/10.5194/gmd-14-5637-2021</a>, 2021.</p>
<p>[8] Golaz, J.-C., Caldwell, P. M., Van Roekel, L. P., Petersen, M. R., Tang, Q., Wolfe, J. D., et al. (2019). The DOE E3SM coupled model version 1: Overview and evaluation at standard resolution. Journal of Advances in Modeling Earth Systems, 11, 2089– 2129. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2018MS001603">https://doi-org.ezproxy.uio.no/10.1029/2018MS001603</a></p>
<p>[9] Burrows, S. M., Maltrud, M., Yang, X., Zhu, Q., Jeffery, N., Shi, X., et al. (2020). The DOE E3SM v1.1 biogeochemistry configuration: Description and simulated ecosystem-climate responses to historical changes in forcing. Journal of Advances in Modeling Earth Systems, 12, e2019MS001766. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS001766">https://doi-org.ezproxy.uio.no/10.1029/2019MS001766</a></p>
<p>[10] Müller, W. A., Jungclaus, J. H., Mauritsen, T., Baehr, J., Bittner, M., Budich, R., et al. (2018). A higher-resolution version of the Max Planck Institute Earth System Model (MPI-ESM1.2-HR). Journal of Advances in Modeling Earth Systems, 10, 1383– 1413. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2017MS001217">https://doi-org.ezproxy.uio.no/10.1029/2017MS001217</a></p>
<p>[11] Yukimoto, S., H. Kawai, T. Koshiro, N. Oshima, K. Yoshida, S. Urakawa, H. Tsujino, M. Deushi, T. Tanaka, M. Hosaka, S. Yabu, H. Yoshimura, E. Shindo, R. Mizuta, A. Obata, Y. Adachi, and M. Ishii, 2019: The Meteorological Research Institute Earth System Model version 2.0, MRI-ESM2.0: Description and basic evaluation of the physical component. J. Meteor. Soc. Japan, 97, 931–965, doi:10.2151/jmsj.2019-051.</p>
<p>[12] Seland, Ø., Bentsen, M., Olivié, D., Toniazzo, T., Gjermundsen, A., Graff, L. S., Debernard, J. B., Gupta, A. K., He, Y.-C., Kirkevåg, A., Schwinger, J., Tjiputra, J., Aas, K. S., Bethke, I., Fan, Y., Griesfeller, J., Grini, A., Guo, C., Ilicak, M., Karset, I. H. H., Landgren, O., Liakka, J., Moseid, K. O., Nummelin, A., Spensberger, C., Tang, H., Zhang, Z., Heinze, C., Iversen, T., and Schulz, M.: Overview of the Norwegian Earth System Model (NorESM2) and key climate response of CMIP6 DECK, historical, and scenario simulations, Geosci. Model Dev., 13, 6165–6200, <a class="reference external" href="https://doi.org/10.5194/gmd-13-6165-2020">https://doi.org/10.5194/gmd-13-6165-2020</a>, 2020.</p>
<p>[13] Held, I. M., Guo, H., Adcroft, A., Dunne, J. P., Horowitz, L. W., Krasting, J., et al. (2019). Structure and performance of GFDL’s CM4.0 climate model. Journal of Advances in Modeling Earth Systems, 11, 3691– 3727. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS001829">https://doi-org.ezproxy.uio.no/10.1029/2019MS001829</a></p>
<p>[14] Dunne, J. P., Horowitz, L. W., Adcroft, A. J., Ginoux, P., Held, I. M., John, J. G., et al. (2020). The GFDL Earth System Model Version 4.1 (GFDL-ESM 4.1): Overall coupled model description and simulation characteristics. Journal of Advances in Modeling Earth Systems, 12, e2019MS002015. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS002015">https://doi-org.ezproxy.uio.no/10.1029/2019MS002015</a></p>
<p>[15] Park, S., Shin, J., Kim, S., Oh, E., &amp; Kim, Y. (2019). Global Climate Simulated by the Seoul National University Atmosphere Model Version 0 with a Unified Convection Scheme (SAM0-UNICON), Journal of Climate, 32(10), 2917-2949. Retrieved Jan 12, 2022, from <a class="reference external" href="https://journals-ametsoc-org.ezproxy.uio.no/view/journals/clim/32/10/jcli-d-18-0796.1.xml">https://journals-ametsoc-org.ezproxy.uio.no/view/journals/clim/32/10/jcli-d-18-0796.1.xml</a></p>
<p>[16] Lin, Y., Huang, X., Liang, Y., Qin, Y., Xu, S., &amp; Huang, W., et al. (2020). Community Integrated Earth System Model (CIESM): Description and evaluation. Journal of Advances in Modeling Earth Systems, 12, e2019MS002036. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019MS002036">https://doi-org.ezproxy.uio.no/10.1029/2019MS002036</a></p>
<img src="https://drive.google.com/uc?id=1zb0LHvipx8JOXLLrCxzYToJM7eNK4eaw"  height="100" />
<img src="https://reliance.rohub.org/static/media/Reliance-logo.433dc2e9.png"  height="100" />
<img src="https://www.uio.no/vrtx/decorating/resources/dist/src2/images/footer/uio-logo-en.svg"  height="100" />
<img src="https://erc.europa.eu/sites/default/files/logo_0.png"  height="100" />
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./cmip"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Analysis of CMIP6, ERA5, and CloudSat</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../cloudsat.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cloudsat</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Franziska Hellmuth<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>