
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Example with ERA5 high-resolution (~0.25deg) monthly means &#8212; globalsnow</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Analysis of CMIP6, ERA5, and CloudSat" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html" />
    <link rel="prev" title="Welcome to Global Snow project website" href="../intro.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">globalsnow</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to Global Snow project website
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Example with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html">
   Analysis of CMIP6, ERA5, and CloudSat
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../cmip/CMIP6_hr_1985-2014.html">
   Example with high-resolution CMIP6 models (~100 km) using Pangeo catalog
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../cloudsat.html">
   Cloudsat
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../CloudSat/get_pressure_grid.html">
     Example to get CloudSat mean pressure level profile
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/franzihe/CloudSat_ERA5_CMIP6_analysis/main?urlpath=tree/work/ERA5/ERA5_1985-2014.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/franzihe/CloudSat_ERA5_CMIP6_analysis/issues/new?title=Issue%20on%20page%20%2FERA5/ERA5_1985-2014.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/ERA5/ERA5_1985-2014.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-era5-variables">
     Open ERA5 variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-attributes-matching-cmip6-data">
     Change attributes matching CMIP6 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specific-ice-and-snow-water-content">
     Specific ice and snow water content
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid ERA5 data to common NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#open-cmip6-online-catalog-and-search-corresponding-data">
       Open CMIP6 online catalog and search corresponding data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mask-atmopsheric-temperature">
     Mask atmopsheric temperature
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-global-mean-and-seasonal-mean-spread-of-all-era5-data">
     Create global mean and seasonal mean/spread of all ERA5 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-seasonal-mean-of-each-variable">
     Plot the seasonal mean of each variable
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-latitude-band-mean-of-variables">
     Calculate latitude band mean of variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-a-id-references-a">
   References
   <a id="references">
   </a>
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Example with ERA5 high-resolution (~0.25deg) monthly means</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Example with ERA5 high-resolution (~0.25deg) monthly means
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction-a-id-introduction-a">
   1. Introduction
   <a id="introduction">
   </a>
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-wrangling-a-id-data-wrangling-a">
   2. Data Wrangling
   <a id="data_wrangling">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#organize-my-data">
     Organize my data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#import-python-packages">
     Import python packages
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#open-era5-variables">
     Open ERA5 variables
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#change-attributes-matching-cmip6-data">
     Change attributes matching CMIP6 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#specific-ice-and-snow-water-content">
     Specific ice and snow water content
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
     Regrid ERA5 data to common NorESM2-MM grid
     <a id="regrid_hz">
     </a>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#open-cmip6-online-catalog-and-search-corresponding-data">
       Open CMIP6 online catalog and search corresponding data
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mask-atmopsheric-temperature">
     Mask atmopsheric temperature
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploratory-data-analysis-a-id-exploratory-a">
   3. Exploratory Data Analysis
   <a id="exploratory">
   </a>
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-global-mean-and-seasonal-mean-spread-of-all-era5-data">
     Create global mean and seasonal mean/spread of all ERA5 data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#find-mixed-phase-clouds">
     Find mixed-phase clouds
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-the-seasonal-mean-of-each-variable">
     Plot the seasonal mean of each variable
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-latitude-band-mean-of-variables">
     Calculate latitude band mean of variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references-a-id-references-a">
   References
   <a id="references">
   </a>
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="example-with-era5-high-resolution-0-25deg-monthly-means">
<h1>Example with ERA5 high-resolution (~0.25deg) monthly means<a class="headerlink" href="#example-with-era5-high-resolution-0-25deg-monthly-means" title="Permalink to this headline">#</a></h1>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="table-of-contents">
<h1>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h1>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#data_wrangling">2. Data Wrangling</a></li>
<li><a href="#exploratory">3. Exploratory Data Analysis</a></li>
<li><a href="#conclusion">4. Conclusion</a></li>
<li><a href="#references">5. References</a></li>
</ul></section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction-a-id-introduction-a">
<h1>1. Introduction <a id='introduction'></a><a class="headerlink" href="#introduction-a-id-introduction-a" title="Permalink to this headline">#</a></h1>
<p>Cloud feedbacks are a major contributor to the spread of climate sensitivity in global climate models (GCMs) (<a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019GL085782">Zelinka et al. (2020)</a>]). Among the most poorly understood cloud feedbacks is the one associated with the cloud phase, which is expected to be modified with climate change (<a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1">Bjordal et al. (2020)</a>). Cloud phase bias, in addition, has significant implications for the simulation of radiative properties and glacier and ice sheet mass balances in climate models.</p>
<p>In this context, this work aims to expand our knowledge on how the representation of the cloud phase affects snow formation in GCMs. Better understanding this aspect is necessary to develop climate models further and improve future climate predictions.</p>
<ul class="simple">
<li><p>Load ERA5 data previously downloaded locally via <a class="reference external" href="https://github.com/franzihe/download_ERA5">Jupyter Notebook - download ERA5</a></p></li>
<li><p>find clouds: liquid-only, ice-only, mixed-phase</p></li>
<li><p>Regridd the ERA5 variables to the same horizontal resolution as high-resolution CMIP6 models with <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/"><code class="docutils literal notranslate"><span class="pre">xesmf</span></code></a></p></li>
<li><p>Calculate and plot the seasonal mean of the variable</p></li>
</ul>
<p><strong>Questions</strong></p>
<ul class="simple">
<li><p>How is the cloud phase and snowfall varying between 1985 and 2014?</p></li>
</ul>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> We answer questions related to the comparison of CMIP models to ERA5 in another <a class="reference internal" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html"><span class="doc std std-doc">Jupyter Notebook</span></a>.</p>
</div></blockquote>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-wrangling-a-id-data-wrangling-a">
<h1>2. Data Wrangling <a id='data_wrangling'></a><a class="headerlink" href="#data-wrangling-a-id-data-wrangling-a" title="Permalink to this headline">#</a></h1>
<p>This study will compare surface snowfall, ice, and liquid water content from the Coupled Model Intercomparison Project Phase 6 (<a class="reference external" href="https://esgf-node.llnl.gov/projects/cmip6/">CMIP6</a>) climate models (accessed through <a class="reference external" href="https://pangeo.io/">Pangeo</a>) to the European Centre for Medium-Range Weather Forecast Re-Analysis 5 (<a class="reference external" href="https://www.ecmwf.int/en/forecasts/datasets/reanalysis-datasets/era5">ERA5</a>) data from <strong>1985 to 2014</strong>. We conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) in the CMIP6 models and their potential connection between them. The CMIP6 data analysis can be found in the <a class="reference internal" href="../cmip/CMIP6_hr_1985-2014.html"><span class="doc std std-doc">Jupyter Notebook for CMIP6</span></a>.</p>
<ul class="simple">
<li><p>Time period: 1985 to 2014</p></li>
<li><p>horizonal resolution: ~0.25deg</p></li>
<li><p>time resolution: monthly atmospheric data</p></li>
<li><p>Variables:</p></li>
</ul>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>shortname</p></th>
<th class="text-align:center head"><p>Long name</p></th>
<th class="text-align:right head"><p>Units</p></th>
<th class="text-align:right head"><p>levels</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sf</p></td>
<td class="text-align:center"><p>snowfall</p></td>
<td class="text-align:right"><p>[m of water eq]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>msr</p></td>
<td class="text-align:center"><p>mean_snowfall_rate</p></td>
<td class="text-align:right"><p>[kg m-2 s-1]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-even"><td><p>cswc</p></td>
<td class="text-align:center"><p>specific_snow_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-odd"><td><p>clwc</p></td>
<td class="text-align:center"><p>specific_cloud_liquid_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-even"><td><p>clic</p></td>
<td class="text-align:center"><p>specific_cloud_ice_water_content</p></td>
<td class="text-align:right"><p>[kg kg-1]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-odd"><td><p>t</p></td>
<td class="text-align:center"><p>temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>pl</p></td>
</tr>
<tr class="row-even"><td><p>2t</p></td>
<td class="text-align:center"><p>2 metre temperature</p></td>
<td class="text-align:right"><p>[K]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
<tr class="row-odd"><td><p>tclw</p></td>
<td class="text-align:center"><p>Total column cloud liquid water</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p>single</p></td>
</tr>
<tr class="row-even"><td><p>tciw</p></td>
<td class="text-align:center"><p>Total column cloud ice water</p></td>
<td class="text-align:right"><p>[kg m-2]</p></td>
<td class="text-align:right"><p>single</p></td>
</tr>
<tr class="row-odd"><td><p>tp</p></td>
<td class="text-align:center"><p>Total precipitation</p></td>
<td class="text-align:right"><p>[m]</p></td>
<td class="text-align:right"><p>surface</p></td>
</tr>
</tbody>
</table>
<section id="organize-my-data">
<h2>Organize my data<a class="headerlink" href="#organize-my-data" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>Define a prefix for my project (you may need to adjust it for your own usage on your infrastructure).</p>
<ul>
<li><p>input folder where all the data used as input to my Jupyter Notebook is stored (and eventually shared)</p></li>
<li><p>output folder where all the results to keep are stored</p></li>
<li><p>tool folder where all the tools</p></li>
</ul>
</li>
</ul>
<p>The ERA5 0.25deg data is located in the folder <code class="docutils literal notranslate"><span class="pre">/input/ERA5/monthly_means/0.25deg</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pathlib</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="n">hostname</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostname</span><span class="p">()</span>

<span class="n">abs_path</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">absolute</span><span class="p">())</span>
<span class="n">WORKDIR</span> <span class="o">=</span> <span class="n">abs_path</span><span class="p">[:</span><span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">abs_path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>


<span class="k">if</span> <span class="s2">&quot;mimi&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">hostname</span><span class="p">)</span>
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/scratch/franzihe/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/uio/kant/geo-metos-u1/franzihe/Documents/Figures/ERA5/&quot;</span>
<span class="k">elif</span> <span class="s2">&quot;glefsekaldt&quot;</span> <span class="ow">in</span> <span class="n">hostname</span><span class="p">:</span> 
    <span class="n">DATA_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Data/&quot;</span>
    <span class="n">FIG_DIR</span> <span class="o">=</span> <span class="s2">&quot;/home/franzihe/Documents/Figures/ERA5/&quot;</span>

<span class="n">INPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;input&#39;</span><span class="p">)</span>
<span class="n">OUTPUT_DATA_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;output&#39;</span><span class="p">)</span>
<span class="n">UTILS_DIR</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">WORKDIR</span><span class="p">,</span> <span class="s1">&#39;utils&#39;</span><span class="p">)</span>

<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">UTILS_DIR</span><span class="p">)</span>
<span class="c1"># make figure directory</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">FIG_DIR</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>mimi.uio.no
</pre></div>
</div>
</div>
</div>
</section>
<section id="import-python-packages">
<h2>Import python packages<a class="headerlink" href="#import-python-packages" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Python</span></code> environment requirements: file <span class="xref myst">requirements_globalsnow.txt</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">python</span></code> packages from <span class="xref myst">imports.py</span></p></li>
<li><p>load <code class="docutils literal notranslate"><span class="pre">functions</span></code> from <span class="xref myst">functions.py</span></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># supress warnings</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span> <span class="c1"># don&#39;t output warnings</span>

<span class="c1"># import packages</span>
<span class="kn">from</span> <span class="nn">imports</span> <span class="kn">import</span><span class="p">(</span><span class="n">xr</span><span class="p">,</span> <span class="n">intake</span><span class="p">,</span> <span class="n">ccrs</span><span class="p">,</span> <span class="n">cy</span><span class="p">,</span> <span class="n">plt</span><span class="p">,</span> <span class="n">glob</span><span class="p">,</span> <span class="n">cm</span><span class="p">,</span> <span class="n">fct</span><span class="p">,</span> <span class="n">np</span><span class="p">,</span> <span class="n">da</span><span class="p">)</span>
<span class="n">xr</span><span class="o">.</span><span class="n">set_options</span><span class="p">(</span><span class="n">display_style</span><span class="o">=</span><span class="s1">&#39;html&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;xarray.core.options.set_options at 0x7ff6e26a2b20&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># reload imports</span>
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
</div>
</div>
</section>
<section id="open-era5-variables">
<h2>Open ERA5 variables<a class="headerlink" href="#open-era5-variables" title="Permalink to this headline">#</a></h2>
<p>Get the data requried for the analysis. Beforehand we downloaded the monthly averaged data on single levels and pressure levels via the Climate Data Store (CDS) infrastructure. The github repository <a class="reference external" href="https://github.com/franzihe/download_ERA5">Download ERA5</a> gives examples on how to download the data from the CDS. We use the Jupyter Notebooks <a class="reference external" href="https://github.com/franzihe/download_ERA5/blob/main/download_Amon_single_level.ipynb">download_Amon_single_level</a> and <a class="reference external" href="https://github.com/franzihe/download_ERA5/blob/main/download_Amon_pressure_level.ipynb">download_Amon_pressure_level</a>. Both, download the monthly means for the variables mentioned above between 1985 and 2014.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> To download from CDS a user has to have a CDS user account, please create the account <a class="reference external" href="https://cds.climate.copernicus.eu/user/register">here</a>.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">era_in</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">INPUT_DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;ERA5/monthly_means/0.25deg&#39;</span><span class="p">)</span>
<span class="n">era_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">OUTPUT_DATA_DIR</span><span class="p">,</span> <span class="s1">&#39;ERA5/monthly_means/1deg&#39;</span><span class="p">)</span>
<span class="c1"># make output data directory</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">era_out</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">variable_id</span><span class="o">=</span><span class="p">[</span>
            <span class="s1">&#39;2t&#39;</span><span class="p">,</span>
            <span class="s1">&#39;clic&#39;</span><span class="p">,</span>
            <span class="s1">&#39;clwc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;cswc&#39;</span><span class="p">,</span>
            <span class="s1">&#39;msr&#39;</span><span class="p">,</span>
            <span class="s1">&#39;sf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;t&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;tciw&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tclw&#39;</span><span class="p">,</span>
            <span class="s1">&#39;tp&#39;</span>
             <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>At the moment we have downloaded 30 years (1985-2014) for ERA5. We define start and end year to ensure to only extract the 30-year period between 1985 and 2014.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define a start and end year</p>
<p>We will load all available variables into one xarray dataset with <code class="docutils literal notranslate"><span class="pre">xarray.open_mfdataset(file)</span></code> and select the time range <a class="reference external" href="https://xarray.pydata.org/en/stable/user-guide/indexing.html">by name</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># rsync -av --progress login.nird.sigma2.no:/projects/NS9600K/data/ERA5/monthly_means/0.25deg /scratch/franzihe/input/ERA5/monthly_means</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">starty</span> <span class="o">=</span> <span class="mi">1985</span><span class="p">;</span> <span class="n">endy</span> <span class="o">=</span> <span class="mi">2014</span>
<span class="n">year_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>

<span class="n">ds_era</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">Dataset</span><span class="p">()</span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">variable_id</span><span class="p">:</span>
    <span class="c1"># Input data from ERA5 with a resolution of 0.25x0.25deg to be regridded</span>
    <span class="n">era_file_in</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/</span><span class="si">{}</span><span class="s1">_Amon_ERA5_*12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_in</span><span class="p">,</span> <span class="n">var_id</span><span class="p">))</span>       <span class="c1"># search for data in the local directory </span>
    <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_mfdataset</span><span class="p">(</span><span class="n">era_file_in</span><span class="p">,</span> <span class="p">)</span>

    
    <span class="c1"># rename variable name in dataset to match variable_id</span>
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;2t&#39;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;t2m&#39;</span><span class="p">:</span><span class="s1">&#39;2t&#39;</span><span class="p">})</span>
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clic&#39;</span><span class="p">:</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;ciwc&#39;</span><span class="p">:</span><span class="s1">&#39;clic&#39;</span><span class="p">})</span>
    <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">year_range</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span> 

<span class="n">ds_era</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">time</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">year_range</span><span class="p">))</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="c1"># ds_era = fct.rename_coords_lon_lat(ds_era)</span>
<span class="n">ds_era</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">longitude</span><span class="o">=</span><span class="p">(((</span><span class="n">ds_era</span><span class="o">.</span><span class="n">longitude</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;longitude&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create pressure array </span>
<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> 
<span class="p">),</span> 
                                                               <span class="n">dims</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">),</span> 
                                                               <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">level</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>

<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;level&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;hPa&#39;</span>
<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span> <span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Atmospheric pressure&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create occcurence array </span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_occurence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">da</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">),</span> 
                                                                <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dims</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">,</span> 
                                                                <span class="n">coords</span><span class="o">=</span><span class="p">[</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">]</span> <span class="p">)</span>

    <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_occurence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;units&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_occurence&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s2">&quot;long_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Occurence&#39;</span>

<span class="n">ds_era</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;time&quot;</span><span class="p">:</span><span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;level&quot;</span><span class="p">:</span><span class="mi">37</span><span class="p">,</span> <span class="s2">&quot;latitude&quot;</span><span class="p">:</span><span class="mi">721</span><span class="p">,</span> <span class="s2">&quot;longitude&quot;</span><span class="p">:</span><span class="mi">1440</span><span class="p">})</span> <span class="c1"># we have to chunk the data like this as the regridding showed to have some trouble because of chunking</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="change-attributes-matching-cmip6-data">
<h2>Change attributes matching CMIP6 data<a class="headerlink" href="#change-attributes-matching-cmip6-data" title="Permalink to this headline">#</a></h2>
<p>We will assign the attributes to the variables to make CMIP6 and ERA5 variables comperable.</p>
<p>The data <a class="reference external" href="https://confluence.ecmwf.int/pages/viewpage.action?pageId=82870405#ERA5:datadocumentation-Monthlymeans">documentation of monthly means</a> gives information about the accumulations in monthly means (of daily means, stream=moda/edmo). Hence, the precipitation variables have been scaled to have an “effective” processing period of one day, so for accumulations in these streams</p>
<ul class="simple">
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=144"><code class="docutils literal notranslate"><span class="pre">sf</span></code></a> is in <strong>m of water per day</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span>  multiply by <strong>1000</strong> to get <strong>kg m-2 day-1</strong> or <strong>mmday-1</strong>.</p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=228"><code class="docutils literal notranslate"><span class="pre">tp</span></code></a> is in <strong>m</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>mm</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=247"><code class="docutils literal notranslate"><span class="pre">ciwc</span></code></a>, <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=246"><code class="docutils literal notranslate"><span class="pre">clwc</span></code></a>, and <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=76"><code class="docutils literal notranslate"><span class="pre">cswc</span></code></a> is in <strong>kg kg-1</strong>    <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g kg-1</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=235031"><code class="docutils literal notranslate"><span class="pre">msr</span></code></a> is in <strong>kg m-2 s-1</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>86400</strong> to get <strong>mm day-1</strong></p></li>
<li><p><a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=79"><code class="docutils literal notranslate"><span class="pre">tciw</span></code></a> and <a class="reference external" href="https://apps.ecmwf.int/codes/grib/param-db?id=78"><code class="docutils literal notranslate"><span class="pre">tclw</span></code></a> is in <strong>kg m-2</strong> <span class="math notranslate nohighlight">\(\rightarrow\)</span> Multiply by <strong>1000</strong> to get <strong>g m-2</strong></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">variable_id</span><span class="p">:</span>
    
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clic&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clwc&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;cswc&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;sf&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tciw&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tclw&#39;</span> <span class="ow">or</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tp&#39;</span><span class="p">:</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">*</span><span class="mi">1000</span>
        
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clic&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific cloud ice water content&#39;</span><span class="p">}</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;clwc&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific cloud liquid water content&#39;</span><span class="p">}</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;cswc&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific snow water content&#39;</span><span class="p">}</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;cswc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;cswc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clwc&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;sf&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm day-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Snowfall&#39;</span><span class="p">,}</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">other</span><span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tciw&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g m-2&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total column cloud ice water&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tclw&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g m-2&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total column cloud liquid water&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;tp&#39;</span><span class="p">:</span>
            <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Total precipitation&#39;</span><span class="p">}</span>
        
    <span class="k">if</span> <span class="n">var_id</span> <span class="o">==</span> <span class="s1">&#39;msr&#39;</span><span class="p">:</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">*</span><span class="mi">86400</span>
        <span class="n">ds_era</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;mm day-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span> <span class="s1">&#39;Mean snowfall rate&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="specific-ice-and-snow-water-content">
<h2>Specific ice and snow water content<a class="headerlink" href="#specific-ice-and-snow-water-content" title="Permalink to this headline">#</a></h2>
<p>To get all all frozen particles in the column we have to add the variables <code class="docutils literal notranslate"><span class="pre">specific</span> <span class="pre">cloud</span> <span class="pre">ice</span> <span class="pre">content</span></code> and <code class="docutils literal notranslate"><span class="pre">specific</span> <span class="pre">snow</span> <span class="pre">water</span> <span class="pre">content</span></code>.</p>
<div class="math notranslate nohighlight">
\[\sum clic + cswc = cisc\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;cisc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;clic&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;cswc&#39;</span><span class="p">]</span>
<span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;cisc&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">attrs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;units&#39;</span><span class="p">:</span> <span class="s1">&#39;g kg-1&#39;</span><span class="p">,</span> <span class="s1">&#39;long_name&#39;</span><span class="p">:</span><span class="s1">&#39;Specific cloud ice and snow water content&#39;</span><span class="p">}</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a">
<h2>Regrid ERA5 data to common NorESM2-MM grid <a id='regrid_hz'></a><a class="headerlink" href="#regrid-era5-data-to-common-noresm2-mm-grid-a-id-regrid-hz-a" title="Permalink to this headline">#</a></h2>
<p>We want to conduct statistical analysis at the annual and seasonal timescales to determine the biases in cloud phase and precipitation (liquid and solid) for the CMIP6 models in comparison to ERA5.</p>
<p>The ERA5 data has a nominal resolution of 0.25 deg and has to be regridded to the same horizontal resolution as the NorESM2-MM. Hence we will make use of the python package <code class="docutils literal notranslate"><span class="pre">xesmf</span></code> and <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Compare_algorithms.html#Decreasing-resolution">decreasing resolution</a>, <a class="reference external" href="https://xesmf.readthedocs.io/en/latest/notebooks/Masking.html?highlight=conservative#Limitations-and-warnings">Limitations and warnings</a>.</p>
<p><span class="math notranslate nohighlight">\(\rightarrow\)</span> Define NorESM2-MM as the reference grid <code class="docutils literal notranslate"><span class="pre">ds_out</span></code>.</p>
<p>Save all variables in one file and each variable to a <code class="docutils literal notranslate"><span class="pre">netcdf</span></code> datasets between 1985 an 2014, locally.</p>
<blockquote>
<div><p><strong><em>NOTE:</em></strong> This can take a while, so be patient</p>
</div></blockquote>
<section id="open-cmip6-online-catalog-and-search-corresponding-data">
<h3>Open CMIP6 online catalog and search corresponding data<a class="headerlink" href="#open-cmip6-online-catalog-and-search-corresponding-data" title="Permalink to this headline">#</a></h3>
<p>… by using <code class="docutils literal notranslate"><span class="pre">intake</span></code> from <a class="reference external" href="https://gallery.pangeo.io/repos/pangeo-data/pangeo-tutorial-gallery/intake.html">pangeo.io</a>, specifically <code class="docutils literal notranslate"><span class="pre">intake-esm</span></code>.</p>
<p>An example on <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html#loading-an-esm-collection">Loading an ESM collection</a> and <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html#searching-for-datasets">searching for datasets</a> can also be found on the <a class="reference external" href="https://pangeo-data.github.io/pangeo-cmip6-cloud/accessing_data.html">Pangeo / ESGF Cloud Data Working Group documentation</a>.</p>
<ul class="simple">
<li><p>using intake-esm’s <code class="docutils literal notranslate"><span class="pre">search()</span></code> function:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">col.search(variable_id,</span> <span class="pre">source_id,</span> <span class="pre">experiment_id,</span> <span class="pre">table_id,</span> <span class="pre">member_id,</span> <span class="pre">institution_id,</span> <span class="pre">grid_label)</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the output grid from NorESM</span>

<span class="n">cat_url</span> <span class="o">=</span> <span class="s2">&quot;https://storage.googleapis.com/cmip6/pangeo-cmip6.json&quot;</span>
<span class="n">col</span> <span class="o">=</span> <span class="n">intake</span><span class="o">.</span><span class="n">open_esm_datastore</span><span class="p">(</span><span class="n">cat_url</span><span class="p">)</span>

<span class="n">cat</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">variable_id</span> <span class="o">=</span><span class="s1">&#39;areacella&#39;</span><span class="p">,</span> <span class="n">source_id</span> <span class="o">=</span> <span class="s1">&#39;NorESM2-MM&#39;</span><span class="p">,</span> <span class="n">experiment_id</span> <span class="o">=</span> <span class="s1">&#39;historical&#39;</span><span class="p">,</span> <span class="n">member_id</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;r1i1p1f1&#39;</span><span class="p">])</span>

<span class="n">cmip_in</span> <span class="o">=</span> <span class="n">cat</span><span class="o">.</span><span class="n">to_dataset_dict</span><span class="p">(</span><span class="n">zarr_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;use_cftime&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">})</span>
<span class="n">ds_out</span> <span class="o">=</span> <span class="n">cmip_in</span><span class="p">[</span><span class="s1">&#39;CMIP.NCC.NorESM2-MM.historical.fx.gn&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">member_id</span> <span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="s1">&#39;areacella&#39;</span><span class="p">)</span>
<span class="c1"># Shift the longitude from 0--&gt;360 to -180--&gt;180 and sort by longitude and time</span>
<span class="n">ds_out</span> <span class="o">=</span> <span class="n">ds_out</span><span class="o">.</span><span class="n">assign_coords</span><span class="p">(</span><span class="n">lon</span><span class="o">=</span><span class="p">(((</span><span class="n">ds_out</span><span class="o">.</span><span class="n">lon</span> <span class="o">+</span> <span class="mi">180</span><span class="p">)</span> <span class="o">%</span> <span class="mi">360</span><span class="p">)</span> <span class="o">-</span> <span class="mi">180</span><span class="p">))</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>--&gt; The keys in the returned dictionary of datasets are constructed as follows:
	&#39;activity_id.institution_id.source_id.experiment_id.table_id.grid_label&#39;
</pre></div>
</div>
<div class="output text_html">
<div>
    <style>
        /* Turns off some styling */
        progress {
            /* gets rid of default border in Firefox and Opera. */
            border: none;
            /* Needs to be in here for Safari polyfill so background images work as expected. */
            background-size: auto;
        }
        .progress-bar-interrupted, .progress-bar-interrupted::-webkit-progress-bar {
            background: #F44336;
        }
    </style>
  <progress value='1' class='' max='1' style='width:300px; height:20px; vertical-align: middle;'></progress>
  100.00% [1/1 00:00<00:00]
</div>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">keys</span> <span class="o">=</span> <span class="s1">&#39;ERA5&#39;</span>

<span class="c1"># Regrid data</span>
<span class="n">era_in_1deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">regrid_data</span><span class="p">(</span><span class="n">ds_era</span><span class="p">,</span> <span class="n">ds_out</span><span class="p">)</span>


<span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_Amon_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
<span class="n">era_file_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">era_out</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
<span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>
<span class="k">if</span> <span class="n">era_file_out</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is downloaded&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">))</span>
    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Have regridded in total: </span><span class="si">{:}</span><span class="s1"> files&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)))</span> 
<span class="k">else</span><span class="p">:</span> <span class="c1"># Save to netcdf file</span>
    <span class="n">era_in_1deg</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file written: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2t True
clic True
clwc True
cswc True
msr True
sf True
t True
tciw True
tclw True
tp True
pressure True
2t_occurence True
clic_occurence True
clwc_occurence True
cswc_occurence True
msr_occurence True
sf_occurence True
t_occurence True
tciw_occurence True
tclw_occurence True
tp_occurence True
pressure_occurence True
cisc True
/scratch/franzihe/output/ERA5/monthly_means/1deg/ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 1 files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">era_in_1deg</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">var_id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;occurence&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="c1"># select where data should be saved</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_Amon_1deg_</span><span class="si">{}</span><span class="s1">01_</span><span class="si">{}</span><span class="s1">12.nc&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_id</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span><span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
        <span class="n">era_file_out</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">era_out</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">era_file_out</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> is downloaded&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">))</span>
            <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Have regridded in total: </span><span class="si">{:}</span><span class="s1"> files&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">counter</span><span class="p">)))</span> 
        <span class="k">else</span><span class="p">:</span> <span class="c1"># Save to netcdf file</span>
            <span class="n">era_in_1deg</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">to_netcdf</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;file written: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">era_file_out</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/scratch/franzihe/output/ERA5/monthly_means/1deg/2t_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 2 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/clic_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 3 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/clwc_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 4 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/cswc_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 5 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/msr_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 6 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/sf_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 7 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/t_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 8 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/tciw_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 9 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/tclw_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 10 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/tp_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 11 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/pressure_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 12 files
/scratch/franzihe/output/ERA5/monthly_means/1deg/cisc_ERA5_Amon_1deg_198501_201412.nc is downloaded
Have regridded in total: 13 files
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ERA5 data</span>
<span class="c1"># rsync -av --progress /scratch/franzihe/output/ERA5/monthly_means/1deg/ login.nird.sigma2.no:/projects/NS9600K/data/ERA5/monthly_means/1deg/</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="mask-atmopsheric-temperature">
<h2>Mask atmopsheric temperature<a class="headerlink" href="#mask-atmopsheric-temperature" title="Permalink to this headline">#</a></h2>
<p>During the process of finding the SLF50, SLF30, SLF70 we encountered the problem, that the atmospheric temperature is too cold with <span class="math notranslate nohighlight">\(T&lt;175K\)</span>. To avoid cold temperatures we will mask the atmospheric temperature values. For this we will try a few thresholds and see how it looks on a spatial map, if we are masking too many temperatures then we know that our threshold is too warm.</p>
<p>Test for:</p>
<ul class="simple">
<li><p>150K = -123.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
<li><p>175K = -98.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
<li><p>200K = -73.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
<li><p>210K = -63.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
<li><p>220K = -53.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
<li><p>230K = -43.15 <span class="math notranslate nohighlight">\(^oC\)</span></p></li>
</ul>
<p>We have different possibilities to mask the temperature:</p>
<ol class="simple">
<li><p>Mask t, but the all other vertical variables still keep their values where t&lt;threshold</p></li>
<li><p>Mask t, and all other vertical variables where t&lt;threshold</p></li>
<li><p>Mask t, find the lowest pressure level and t, if t==NaN then take the atmospheric pressure, temperature from the layer above</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">210</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">230</span><span class="p">)</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
    <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;t_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span>      <span class="o">=</span> <span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">ds_era</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">)</span>
    <span class="n">era_in_1deg</span><span class="p">[</span><span class="s1">&#39;t_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span> <span class="o">=</span> <span class="n">era_in_1deg</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">era_in_1deg</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="exploratory-data-analysis-a-id-exploratory-a">
<h1>3. Exploratory Data Analysis <a id='exploratory'></a><a class="headerlink" href="#exploratory-data-analysis-a-id-exploratory-a" title="Permalink to this headline">#</a></h1>
<section id="create-global-mean-and-seasonal-mean-spread-of-all-era5-data">
<h2>Create global mean and seasonal mean/spread of all ERA5 data<a class="headerlink" href="#create-global-mean-and-seasonal-mean-spread-of-all-era5-data" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 0.25 deg resolution data</span>
<span class="n">season_mean_025deg</span> <span class="o">=</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">var_id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;occurence&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">season_mean_025deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">seasonal_mean_std</span><span class="p">(</span><span class="n">season_mean_025deg</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
<span class="n">season_mean_025deg</span> <span class="o">=</span> <span class="n">season_mean_025deg</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>

<span class="c1"># 1 deg resolution data</span>
<span class="n">season_mean_1deg</span> <span class="o">=</span> <span class="n">era_in_1deg</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">era_in_1deg</span><span class="o">.</span><span class="n">data_vars</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">var_id</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;occurence&#39;</span><span class="p">)</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
        <span class="n">season_mean_1deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">seasonal_mean_std</span><span class="p">(</span><span class="n">season_mean_1deg</span><span class="p">,</span> <span class="n">var_id</span><span class="p">)</span>
<span class="n">season_mean_1deg</span> <span class="o">=</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">drop_dims</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="find-mixed-phase-clouds">
<h2>Find mixed-phase clouds<a class="headerlink" href="#find-mixed-phase-clouds" title="Permalink to this headline">#</a></h2>
<p>Calculate the IWC/LWC statistics given by the values. Setting the value to 0.5 will find the level in the atmosphere where IWC and LWC are 50/50. Setting it to a value of 0.7 will find the level where IWC is 70% while LWC is 30%.</p>
<ol class="simple">
<li><p>find the fraction of IWC to LWC
$<span class="math notranslate nohighlight">\(SLF = \frac{IWC}{IWC + LWC}\)</span><span class="math notranslate nohighlight">\( 
\)</span><span class="math notranslate nohighlight">\(SLF: \text{Super-cooled liquid water fraction}\)</span>$</p></li>
<li><p>find the nearest value to given IWC-fraction</p></li>
<li><p>find atmospheric pressure levels where IWC/LWC fraction occurs</p></li>
<li><p>find the index of the first atmospheric pressure level</p></li>
<li><p>use the index to select variables</p></li>
</ol>
<p>Create dictionary from the list of datasets we want to use for the IWC/LWC statistics</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">SLF</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SLF50&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">,</span> <span class="s1">&#39;SLF70&#39;</span><span class="p">:</span><span class="mf">0.7</span><span class="p">,</span> <span class="s1">&#39;SLF30&#39;</span><span class="p">:</span><span class="mf">0.5</span><span class="p">}</span>


<span class="c1"># find IWC/LWC levels</span>
<span class="n">ds_era_025deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">dataset_IWC_LWC_level</span><span class="p">(</span><span class="n">ds_era</span><span class="p">,</span> <span class="n">SLF</span><span class="p">,</span> <span class="s1">&#39;clwc&#39;</span><span class="p">,</span> <span class="s1">&#39;cisc&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

<span class="n">ds_era_1deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">dataset_IWC_LWC_level</span><span class="p">(</span><span class="n">era_in_1deg</span><span class="p">,</span> <span class="n">SLF</span><span class="p">,</span> <span class="s1">&#39;clwc&#39;</span><span class="p">,</span> <span class="s1">&#39;cisc&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

<span class="n">season_mean_025deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">dataset_IWC_LWC_level</span><span class="p">(</span><span class="n">season_mean_025deg</span><span class="p">,</span> <span class="n">SLF</span><span class="p">,</span> <span class="s1">&#39;clwc_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;cisc_mean&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>

<span class="n">season_mean_1deg</span> <span class="o">=</span> <span class="n">fct</span><span class="o">.</span><span class="n">dataset_IWC_LWC_level</span><span class="p">(</span><span class="n">season_mean_1deg</span><span class="p">,</span> <span class="n">SLF</span><span class="p">,</span> <span class="s1">&#39;clwc_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;cisc_mean&#39;</span><span class="p">,</span> <span class="n">keys</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-the-seasonal-mean-of-each-variable">
<h2>Plot the seasonal mean of each variable<a class="headerlink" href="#plot-the-seasonal-mean-of-each-variable" title="Permalink to this headline">#</a></h2>
<ul class="simple">
<li><p>for the original dataset</p></li>
<li><p>and where the IWC/LWC level were found</p>
<ul>
<li><p>for IWC/LWC 50/50</p></li>
<li><p>for IWC/LWC 70/30</p></li>
<li><p>for IWC/LWC 30/70</p></li>
</ul>
</li>
</ul>
<p>All plots are for ERA resolution at 1 deg.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stat</span> <span class="o">=</span> <span class="s1">&#39;ERA5_SLF50&#39;</span>
<span class="n">var_id</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="n">extend</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>

<span class="n">variable</span> <span class="o">=</span> <span class="n">season_mean_025deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            
<span class="n">global_mean</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">),</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.season&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


<span class="n">fg</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
        <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
        <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>  <span class="c1"># remember to provide this!</span>
        <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
        <span class="p">},</span>
        <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
        <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">devon_r</span><span class="p">,</span> 
        <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
        <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
        <span class="c1"># add_colorbar=False,</span>
        <span class="c1"># vmin=fct.plt_dict[var_id][fct.plt_dict[&#39;header&#39;].index(&#39;vmin&#39;)],</span>
        <span class="c1"># vmax=fct.plt_dict[var_id][fct.plt_dict[&#39;header&#39;].index(&#39;vmax&#39;)],</span>
        <span class="c1"># levels=fct.plt_dict[var_id][fct.plt_dict[&#39;header&#39;].index(&#39;levels&#39;)],</span>
    <span class="p">)</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">variable</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;season: </span><span class="si">{}</span><span class="s1">, global mean: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">global_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    

<span class="n">fg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">coastlines</span><span class="p">())</span>
<span class="n">fg</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
<span class="c1"># fg.add_colorbar(fraction=0.05, pad=0.04)</span>

<span class="c1"># fg.cbar.set_label(label=&#39;{}&#39;.format(fct.plt_dict[var_id][fct.plt_dict[&#39;header&#39;].index(&#39;label&#39;)], weight=&#39;bold&#39;))</span>
    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ERA5_1985-2014_32_0.png" src="../_images/ERA5_1985-2014_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
    <span class="n">var_id</span> <span class="o">=</span> <span class="s1">&#39;t_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>

    <span class="n">variable</span> <span class="o">=</span> <span class="n">season_mean_025deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
    <span class="n">global_mean</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;latitude&#39;</span><span class="p">,</span> <span class="s1">&#39;longitude&#39;</span><span class="p">),</span><span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;time.season&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>


    <span class="n">fg</span> <span class="o">=</span> <span class="n">variable</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
            <span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
            <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>  <span class="c1"># remember to provide this!</span>
            <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span>
                <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
            <span class="p">},</span>
            <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
            <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">devon_r</span><span class="p">,</span> 
            <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
            <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
            <span class="c1"># add_colorbar=False,</span>
            <span class="c1"># vmin=fct.plt_dict[&#39;t&#39;][fct.plt_dict[&#39;header&#39;].index(&#39;vmin&#39;)],</span>
            <span class="c1"># vmax=fct.plt_dict[&#39;t&#39;][fct.plt_dict[&#39;header&#39;].index(&#39;vmax&#39;)],</span>
            <span class="c1"># levels=fct.plt_dict[&#39;t&#39;][fct.plt_dict[&#39;header&#39;].index(&#39;levels&#39;)],</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span> <span class="n">variable</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;season: </span><span class="si">{}</span><span class="s1">, global mean: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">global_mean</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
    

    <span class="n">fg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">coastlines</span><span class="p">())</span>
    <span class="n">fg</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
    <span class="c1"># fg.add_colorbar(fraction=0.05, pad=0.04)</span>

    <span class="c1"># fg.cbar.set_label(label=&#39;{}&#39;.format(fct.plt_dict[&#39;t&#39;][fct.plt_dict[&#39;header&#39;].index(&#39;label&#39;)], weight=&#39;bold&#39;))</span>
        
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ERA5_1985-2014_33_0.png" src="../_images/ERA5_1985-2014_33_0.png" />
<img alt="../_images/ERA5_1985-2014_33_1.png" src="../_images/ERA5_1985-2014_33_1.png" />
<img alt="../_images/ERA5_1985-2014_33_2.png" src="../_images/ERA5_1985-2014_33_2.png" />
<img alt="../_images/ERA5_1985-2014_33_3.png" src="../_images/ERA5_1985-2014_33_3.png" />
<img alt="../_images/ERA5_1985-2014_33_4.png" src="../_images/ERA5_1985-2014_33_4.png" />
<img alt="../_images/ERA5_1985-2014_33_5.png" src="../_images/ERA5_1985-2014_33_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">var_id</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">temp</span><span class="p">:</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">-</span><span class="si">{}</span><span class="s1"> (</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">,</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">var_id</span><span class="p">,</span> <span class="n">starty</span><span class="p">,</span> <span class="n">endy</span><span class="p">)</span>
    <span class="n">_diff</span> <span class="o">=</span> <span class="n">season_mean_025deg</span><span class="p">[</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">_mean&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_id</span><span class="p">,</span><span class="n">t</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">-</span> <span class="n">season_mean_025deg</span><span class="p">[</span><span class="n">var_id</span><span class="o">+</span><span class="s1">&#39;_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">fg</span> <span class="o">=</span> <span class="n">_diff</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">col</span><span class="o">=</span><span class="s2">&quot;season&quot;</span><span class="p">,</span>
                <span class="n">col_wrap</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">transform</span><span class="o">=</span><span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">(),</span>  <span class="c1"># remember to provide this!</span>
                <span class="n">subplot_kws</span><span class="o">=</span><span class="p">{</span>
                    <span class="s2">&quot;projection&quot;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()</span>
                <span class="p">},</span>
                <span class="n">cbar_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;orientation&quot;</span><span class="p">:</span> <span class="s2">&quot;vertical&quot;</span><span class="p">,</span> <span class="s2">&quot;shrink&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;aspect&quot;</span><span class="p">:</span> <span class="mi">40</span><span class="p">},</span>
                <span class="n">cmap</span><span class="o">=</span><span class="n">cm</span><span class="o">.</span><span class="n">bam</span><span class="p">,</span> 
                <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span>
                <span class="n">robust</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">extend</span><span class="o">=</span><span class="n">extend</span><span class="p">,</span>
                <span class="p">)</span>

    <span class="n">fg</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">coastlines</span><span class="p">())</span>
    <span class="n">fg</span><span class="o">.</span><span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/ERA5_1985-2014_34_0.png" src="../_images/ERA5_1985-2014_34_0.png" />
<img alt="../_images/ERA5_1985-2014_34_1.png" src="../_images/ERA5_1985-2014_34_1.png" />
<img alt="../_images/ERA5_1985-2014_34_2.png" src="../_images/ERA5_1985-2014_34_2.png" />
<img alt="../_images/ERA5_1985-2014_34_3.png" src="../_images/ERA5_1985-2014_34_3.png" />
<img alt="../_images/ERA5_1985-2014_34_4.png" src="../_images/ERA5_1985-2014_34_4.png" />
<img alt="../_images/ERA5_1985-2014_34_5.png" src="../_images/ERA5_1985-2014_34_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for stat in season_mean_1deg.statistic.values:</span>
<span class="c1">#     for var_id in ds_era.data_vars:</span>
<span class="c1">#         if var_id == &#39;2t&#39; or var_id==&#39;t&#39; or var_id==&#39;pressure&#39;:</span>
<span class="c1">#             extend=&#39;both&#39;</span>
<span class="c1">#         else:</span>
<span class="c1">#             extend=&#39;max&#39;</span>
<span class="c1">#         if stat == &#39;ERA5&#39; and var_id.find(&#39;occurence&#39;)==-1 and (len(ds_era[var_id].dims))==3:</span>
<span class="c1">#             # print(stat, var_id)</span>
            
<span class="c1">#             variable = season_mean_1deg[var_id+&#39;_mean&#39;].sel(statistic=stat, level=1000)#.sum(&#39;level&#39;, skipna=True, keep_attrs=True)</span>
            
<span class="c1">#             global_mean = ds_era_1deg[var_id].sel(statistic=stat, level=1000).mean((&#39;lat&#39;, &#39;lon&#39;),skipna=True, keep_attrs=True).groupby(&quot;time.season&quot;).mean(&quot;time&quot;, skipna=True, keep_attrs=True)</span>
            


<span class="c1">#             title = &#39;{} MEAN ({} - {})&#39;.format(stat, starty, endy)</span>
<span class="c1">#             fct.plt_spatial_seasonal_mean(variable, global_mean, title, var_id,extend)</span>
            
<span class="c1">#             # save seasonal mean + std figure to png</span>
<span class="c1">#             figname = &#39;{}_{}_season_mean_1deg_{}_{}.png&#39;.format(var_id,stat, starty, endy)</span>
<span class="c1">#             plt.savefig(FIG_DIR + figname, format = &#39;png&#39;, bbox_inches = &#39;tight&#39;, transparent = False)</span>


<span class="c1">#         elif stat!= &#39;ERA5&#39; and var_id.find(&#39;occurence&#39;)==-1:</span>
<span class="c1">#             # print(stat, var_id)</span>
<span class="c1">#             variable = season_mean_1deg[var_id+&#39;_mean&#39;].sel(statistic=stat).sum(&#39;level&#39;, skipna=True, keep_attrs=True)</span>
            
<span class="c1">#             global_mean = ds_era_1deg[var_id].sel(statistic=stat).sum(&#39;level&#39;, skipna=True, keep_attrs=True).mean((&#39;lat&#39;, &#39;lon&#39;),skipna=True, keep_attrs=True).groupby(&quot;time.season&quot;).mean(&quot;time&quot;, skipna=True, keep_attrs=True)</span>
            


<span class="c1">#             title = &#39;{} MEAN ({} - {})&#39;.format(stat, starty, endy)</span>
<span class="c1">#             fct.plt_spatial_seasonal_mean(variable, global_mean, title, var_id, extend)</span>

<span class="c1">#             # save seasonal mean + std figure to png</span>
<span class="c1">#             figname = &#39;{}_{}_season_mean_1deg_{}_{}.png&#39;.format(var_id,stat, starty, endy)</span>
<span class="c1">#             plt.savefig(FIG_DIR + figname, format = &#39;png&#39;, bbox_inches = &#39;tight&#39;, transparent = False)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_SH</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">);</span> <span class="n">lat_NH</span> <span class="o">=</span> <span class="p">(</span><span class="mi">40</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">iteration_SH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="n">iteration_NH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">markers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="s1">&#39;v&#39;</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_SH</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-45 -40 [-44.76439791 -43.82198953 -42.87958115 -41.93717277 -40.9947644
 -40.05235602]
-50 -45 [-49.47643979 -48.53403141 -47.59162304 -46.64921466 -45.70680628]
-55 -50 [-54.18848168 -53.2460733  -52.30366492 -51.36125654 -50.41884817]
-60 -55 [-59.84293194 -58.90052356 -57.95811518 -57.01570681 -56.07329843
 -55.13089005]
-65 -60 [-64.55497382 -63.61256545 -62.67015707 -61.72774869 -60.78534031]
-70 -65 [-69.26701571 -68.32460733 -67.38219895 -66.43979058 -65.4973822 ]
-75 -70 [-74.92146597 -73.97905759 -73.03664921 -72.09424084 -71.15183246
 -70.20942408]
-80 -75 [-79.63350785 -78.69109948 -77.7486911  -76.80628272 -75.86387435]
-85 -80 [-84.34554974 -83.40314136 -82.46073298 -81.51832461 -80.57591623]
-90 -85 [-90.         -89.05759162 -88.11518325 -87.17277487 -86.23036649
 -85.28795812]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend at 0x7f2663b533a0&gt;
</pre></div>
</div>
<img alt="../_images/ERA5_1985-2014_39_1.png" src="../_images/ERA5_1985-2014_39_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_NH</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">lat</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>40 45 [40.05235602 40.9947644  41.93717277 42.87958115 43.82198953 44.76439791]
45 50 [45.70680628 46.64921466 47.59162304 48.53403141 49.47643979]
50 55 [50.41884817 51.36125654 52.30366492 53.2460733  54.18848168]
55 60 [55.13089005 56.07329843 57.01570681 57.95811518 58.90052356 59.84293194]
60 65 [60.78534031 61.72774869 62.67015707 63.61256545 64.55497382]
65 70 [65.4973822  66.43979058 67.38219895 68.32460733 69.26701571]
70 75 [70.20942408 71.15183246 72.09424084 73.03664921 73.97905759 74.92146597]
75 80 [75.86387435 76.80628272 77.7486911  78.69109948 79.63350785]
80 85 [80.57591623 81.51832461 82.46073298 83.40314136 84.34554974]
85 90 [85.28795812 86.23036649 87.17277487 88.11518325 89.05759162 90.        ]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;clic&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;sf&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span><span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">season</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">season_mean_1deg</span><span class="o">.</span><span class="n">season</span><span class="o">.</span><span class="n">values</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">hawaii</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">))))):</span>

        <span class="n">_season</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.season&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">_month</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span><span class="p">),</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;time.month&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="s1">&#39;time&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
       
        <span class="n">_season</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">season</span><span class="o">=</span><span class="n">season</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">season</span> <span class="o">==</span><span class="s1">&#39;DJF&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">11</span><span class="p">:],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[:</span><span class="mi">2</span><span class="p">],</span> <span class="n">markers</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;MAM&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">5</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;JJA&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">8</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                          <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                          <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                          <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">season</span><span class="o">==</span><span class="s1">&#39;SON&#39;</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">month</span><span class="p">,</span> <span class="n">marker</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">month</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">8</span><span class="p">:</span><span class="mi">11</span><span class="p">],</span> <span class="n">markers</span><span class="p">):</span>
                <span class="n">_month</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="s1">&#39;ERA5_50&#39;</span><span class="p">,</span> <span class="n">month</span><span class="o">=</span><span class="n">month</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> 
                                                                         <span class="n">x</span><span class="o">=</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;t&#39;</span><span class="p">,</span>
                                                                         <span class="n">label</span><span class="o">=</span><span class="s1">&#39;[</span><span class="si">{}</span><span class="s1"> : </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">),</span>
                                                                         <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">)</span>


<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span> <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="calculate-latitude-band-mean-of-variables">
<h2>Calculate latitude band mean of variables<a class="headerlink" href="#calculate-latitude-band-mean-of-variables" title="Permalink to this headline">#</a></h2>
<p>We will only use high latitudes and the extratropics the latitude bands are as follow:</p>
<ol class="simple">
<li><p>Southern Hemispher:</p>
<ul class="simple">
<li><p>[-30, -45)</p></li>
<li><p>[-45, -60)</p></li>
<li><p>[-60, -75)</p></li>
<li><p>[-75, -90)</p></li>
</ul>
</li>
<li><p>Northern Hemisphere:</p>
<ul class="simple">
<li><p>[30, 45)</p></li>
<li><p>[45, 60)</p></li>
<li><p>[60, 75)</p></li>
<li><p>[75, 90)</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lat_SH</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">);</span> <span class="n">lat_NH</span> <span class="o">=</span> <span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">90</span><span class="p">);</span> <span class="n">step</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">iteration_SH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_SH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">lat_SH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">step</span><span class="p">)</span>
<span class="n">iteration_NH</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="n">lat_NH</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">lat_NH</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">step</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">var_id</span> <span class="ow">in</span> <span class="n">ds_era</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_SH</span><span class="p">:</span>

        <span class="c1"># ERA5 original resolution</span>
        <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># ERA5 regridded resolution</span>
        <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_lat</span> <span class="ow">in</span> <span class="n">iteration_NH</span><span class="p">:</span>
        <span class="c1"># ERA5 original resolution</span>
        <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_025deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">,</span> <span class="n">_lat</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># ERA5 regridded resolution</span>
        <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span> <span class="o">=</span> <span class="n">ds_era_1deg</span><span class="p">[</span><span class="n">var_id</span> <span class="o">+</span> <span class="s1">&#39;_season_mean&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">lat</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="s1">&#39;lat&#39;</span><span class="p">,),</span> <span class="n">keep_attrs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">stat</span> <span class="ow">in</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">statistic</span><span class="o">.</span><span class="n">values</span><span class="p">:</span>
    <span class="c1"># Southern Hemisphere</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_SH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;t_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;sf_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">-</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span> <span class="o">-</span> <span class="n">step</span><span class="p">),</span> 
                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
            <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">);</span>

    <span class="c1"># Northern Hemisphere</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axsm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">],</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">stat</span><span class="p">),</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

    <span class="n">axs</span> <span class="o">=</span> <span class="n">axsm</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">ds_era_1deg</span><span class="o">.</span><span class="n">season</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">_lat</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">iteration_NH</span><span class="p">,</span> <span class="n">cm</span><span class="o">.</span><span class="n">romaO</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mi">256</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span> <span class="n">x</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;t_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="s1">&#39;level&#39;</span><span class="p">,</span> <span class="n">skipna</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">y</span><span class="o">=</span><span class="n">ds_era_1deg</span><span class="p">[</span><span class="s1">&#39;sf_season_</span><span class="si">{}</span><span class="s1">_</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span><span class="o">+</span><span class="n">step</span><span class="p">)]</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">statistic</span><span class="o">=</span><span class="n">stat</span><span class="p">)</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">season</span><span class="o">=</span><span class="n">i</span><span class="p">),</span> 
                        <span class="n">label</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">_lat</span><span class="p">,</span> <span class="n">_lat</span> <span class="o">+</span> <span class="n">step</span><span class="p">),</span> 
                        <span class="n">color</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> 
                        <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
            <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
            <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
            <span class="n">fontsize</span><span class="o">=</span><span class="s2">&quot;small&quot;</span><span class="p">,</span>
            <span class="n">fancybox</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="references-a-id-references-a">
<h1>References <a id='references'></a><a class="headerlink" href="#references-a-id-references-a" title="Permalink to this headline">#</a></h1>
<p>[1] Zelinka, M. D., Myers, T. A., McCoy, D. T., Po-Chedley, S., Caldwell, P. M., Ceppi, P., et al. (2020). Causes of higher climate sensitivity in CMIP6 models. Geophysical Research Letters, 47, e2019GL085782. <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1029/2019GL085782">https://doi-org.ezproxy.uio.no/10.1029/2019GL085782</a></p>
<p>[2] Bjordal, J., Storelvmo, T., Alterskjær, K. et al. Equilibrium climate sensitivity above 5 °C plausible due to state-dependent cloud feedback. Nat. Geosci. 13, 718–721 (2020). <a class="reference external" href="https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1">https://doi-org.ezproxy.uio.no/10.1038/s41561-020-00649-1</a></p>
<img src="https://drive.google.com/uc?id=1zb0LHvipx8JOXLLrCxzYToJM7eNK4eaw"  height="100" />
<img src="https://reliance.rohub.org/static/media/Reliance-logo.433dc2e9.png"  height="100" />
<img src="https://www.uio.no/vrtx/decorating/resources/dist/src2/images/footer/uio-logo-en.svg"  height="100" />
<img src="https://erc.europa.eu/sites/default/files/logo_0.png"  height="100" />
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ERA5"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../intro.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Welcome to Global Snow project website</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../CMIP6_ERA5_CloudSat/plt_seasonal_mean.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Analysis of CMIP6, ERA5, and CloudSat</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Franziska Hellmuth<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>